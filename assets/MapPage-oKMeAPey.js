const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/leaflet-fbicKXUd.js","assets/vendor-Cja35lIC.js","assets/vendor-BDNOyzxu.css","assets/leaflet-CIGW-MKW.css"])))=>i.map(i=>d[i]);
import{b2 as Le,r as l,j as e,b4 as pa,aB as $e,k as It,bv as da}from"./vendor-Cja35lIC.js";import{s as qe,E as st,z as Qe,_ as ua,P as fa,B as gn}from"./system-admin-ex6_k_qZ.js";import{f as ha,a as Na,b as jn,c as Mn}from"./locationsApi-DsDxNHu0.js";import{s as Ke,a as xn,b as Ze,c as dt,f as va,d as Va,e as ba,g as ga,h as ut,i as xa,j as Ta,k as Ea,l as kt,m as Pt,n as Nt,o as vt,p as At,q as Bt,r as Ha,t as Vt,u as Je,v as Re,w as Da,x as _a,y as Ye}from"./index-CND0uvDe.js";import{e as We,h as ye,c as ya,u as La,i as wa,j as ja,k as Ma}from"./plans-D8Etc1yb.js";import{X as ge,aa as Qa,C as Ca,k as we,al as et,aN as tt,aM as bt,aC as Sa,ak as Oe,bQ as Qn,S as rt,Q as Ue,n as Pe,a5 as ke,o as De,ac as nt,bw as Ia,aJ as ft,bR as ka,bS as Pa,bC as Ot,aA as Aa,O as Ba,j as Ra,ag as gt,bd as St,bk as Oa,af as za,bs as zt,x as Ft,w as lt,N as xt,bT as Fa,bU as $a,bV as qa,av as Ua,bW as Wa,m as Ga,a2 as Ka,b2 as Tn,an as Za,T as Cn,b3 as at,bM as $t,$ as Ya,bX as qt,f as Xa,bY as Ut,b9 as Ja,U as En,aw as es,e as ts}from"./icons-BAlVBlw-.js";import{S as ns,a as as,b as ss,c as is,d as os}from"./evidence-DaHuJ-yO.js";import{C as ls}from"./ConfirmDialog-BbBWOneB.js";import{d as rs,w as cs,p as ms,h as Hn,g as ps}from"./vietnamLocations-B74FGGy7.js";import"./leaflet-fbicKXUd.js";import"./admin-legacy-jWMCv_Ye.js";import"./docs-B0haN8rX.js";import"./todolist-BU1fHqyV.js";import"./kpi-CWG9dtA2.js";import"./alert-dialog-B66IMAU8.js";import"./lead-risk-BFz7WLqJ.js";const ds="_map_ws2rq_3",us="_fullscreenButton_ws2rq_533",Dn={map:ds,fullscreenButton:us},_n={"Ho√†n Ki·∫øm":{name:"Ho√†n Ki·∫øm",polygon:[[21.0345,105.8456],[21.0345,105.8625],[21.0195,105.8625],[21.0195,105.8456],[21.0345,105.8456]],bounds:[[21.0195,105.8456],[21.0345,105.8625]],center:[21.027,105.854]},"Ba ƒê√¨nh":{name:"Ba ƒê√¨nh",polygon:[[21.045,105.81],[21.045,105.84],[21.02,105.84],[21.02,105.81],[21.045,105.81]],bounds:[[21.02,105.81],[21.045,105.84]],center:[21.0325,105.825]},"ƒê·ªëng ƒêa":{name:"ƒê·ªëng ƒêa",polygon:[[21.035,105.82],[21.035,105.85],[21.01,105.85],[21.01,105.82],[21.035,105.82]],bounds:[[21.01,105.82],[21.035,105.85]],center:[21.0225,105.835]},"Hai B√† Tr∆∞ng":{name:"Hai B√† Tr∆∞ng",polygon:[[21.02,105.84],[21.02,105.87],[20.995,105.87],[20.995,105.84],[21.02,105.84]],bounds:[[20.995,105.84],[21.02,105.87]],center:[21.0075,105.855]},"Ho√†ng Mai":{name:"Ho√†ng Mai",polygon:[[21,105.85],[21,105.89],[20.97,105.89],[20.97,105.85],[21,105.85]],bounds:[[20.97,105.85],[21,105.89]],center:[20.985,105.87]},"Thanh Xu√¢n":{name:"Thanh Xu√¢n",polygon:[[21.01,105.79],[21.01,105.82],[20.98,105.82],[20.98,105.79],[21.01,105.79]],bounds:[[20.98,105.79],[21.01,105.82]],center:[20.995,105.805]},"Long Bi√™n":{name:"Long Bi√™n",polygon:[[21.06,105.88],[21.06,105.92],[21.03,105.92],[21.03,105.88],[21.06,105.88]],bounds:[[21.03,105.88],[21.06,105.92]],center:[21.045,105.9]},"C·∫ßu Gi·∫•y":{name:"C·∫ßu Gi·∫•y",polygon:[[21.05,105.78],[21.05,105.81],[21.02,105.81],[21.02,105.78],[21.05,105.78]],bounds:[[21.02,105.78],[21.05,105.81]],center:[21.035,105.795]},"T√¢y H·ªì":{name:"T√¢y H·ªì",polygon:[[21.08,105.8],[21.08,105.84],[21.05,105.84],[21.05,105.8],[21.08,105.8]],bounds:[[21.05,105.8],[21.08,105.84]],center:[21.065,105.82]},"Nam T·ª´ Li√™m":{name:"Nam T·ª´ Li√™m",polygon:[[21.04,105.74],[21.04,105.78],[21.005,105.78],[21.005,105.74],[21.04,105.74]],bounds:[[21.005,105.74],[21.04,105.78]],center:[21.0225,105.76]},"B·∫Øc T·ª´ Li√™m":{name:"B·∫Øc T·ª´ Li√™m",polygon:[[21.08,105.74],[21.08,105.78],[21.045,105.78],[21.045,105.74],[21.08,105.74]],bounds:[[21.045,105.74],[21.08,105.78]],center:[21.0625,105.76]},"H√† ƒê√¥ng":{name:"H√† ƒê√¥ng",polygon:[[20.99,105.75],[20.99,105.79],[20.96,105.79],[20.96,105.75],[20.99,105.75]],bounds:[[20.96,105.75],[20.99,105.79]],center:[20.975,105.77]}},fs=[{name:"Ph∆∞·ªùng H√†ng ƒê√†o",district:"Ho√†n Ki·∫øm",polygon:[[21.036,105.848],[21.038,105.85],[21.036,105.852],[21.034,105.85],[21.036,105.848]],bounds:[[21.034,105.848],[21.038,105.852]],center:[21.036,105.85]},{name:"Ph∆∞·ªùng Tr√†ng Ti·ªÅn",district:"Ho√†n Ki·∫øm",polygon:[[21.026,105.848],[21.028,105.85],[21.026,105.852],[21.024,105.85],[21.026,105.848]],bounds:[[21.024,105.848],[21.028,105.852]],center:[21.026,105.85]},{name:"Ph∆∞·ªùng Phan Chu Trinh",district:"Ho√†n Ki·∫øm",polygon:[[21.02,105.852],[21.022,105.854],[21.02,105.856],[21.018,105.854],[21.02,105.852]],bounds:[[21.018,105.852],[21.022,105.856]],center:[21.02,105.854]},{name:"Ph∆∞·ªùng ƒê·ªìng Xu√¢n",district:"Ho√†n Ki·∫øm",polygon:[[21.036,105.853],[21.038,105.855],[21.036,105.857],[21.034,105.855],[21.036,105.853]],bounds:[[21.034,105.853],[21.038,105.857]],center:[21.036,105.855]},{name:"Ph∆∞·ªùng L√Ω Th√°i T·ªï",district:"Ho√†n Ki·∫øm",polygon:[[21.03,105.854],[21.032,105.856],[21.03,105.858],[21.028,105.856],[21.03,105.854]],bounds:[[21.028,105.854],[21.032,105.858]],center:[21.03,105.856]},{name:"Ph∆∞·ªùng H√†ng B·∫°c",district:"Ho√†n Ki·∫øm",polygon:[[21.03,105.85],[21.032,105.852],[21.03,105.854],[21.028,105.852],[21.03,105.85]],bounds:[[21.028,105.85],[21.032,105.854]],center:[21.03,105.852]},{name:"Ph∆∞·ªùng ƒêi·ªán Bi√™n",district:"Ba ƒê√¨nh",polygon:[[21.028,105.82],[21.032,105.822],[21.032,105.826],[21.028,105.824],[21.028,105.82]],bounds:[[21.028,105.82],[21.032,105.826]],center:[21.03,105.823]},{name:"Ph∆∞·ªùng Qu√°n Th√°nh",district:"Ba ƒê√¨nh",polygon:[[21.038,105.82],[21.042,105.822],[21.042,105.826],[21.038,105.824],[21.038,105.82]],bounds:[[21.038,105.82],[21.042,105.826]],center:[21.04,105.823]},{name:"Ph∆∞·ªùng Kim M√£",district:"Ba ƒê√¨nh",polygon:[[21.033,105.827],[21.037,105.829],[21.037,105.833],[21.033,105.831],[21.033,105.827]],bounds:[[21.033,105.827],[21.037,105.833]],center:[21.035,105.83]},{name:"Ph∆∞·ªùng VƒÉn Mi·∫øu",district:"ƒê·ªëng ƒêa",polygon:[[21.015,105.81],[21.019,105.812],[21.019,105.816],[21.015,105.814],[21.015,105.81]],bounds:[[21.015,105.81],[21.019,105.816]],center:[21.017,105.813]},{name:"Ph∆∞·ªùng L√°ng H·∫°",district:"ƒê·ªëng ƒêa",polygon:[[21.015,105.817],[21.019,105.819],[21.019,105.823],[21.015,105.821],[21.015,105.817]],bounds:[[21.015,105.817],[21.019,105.823]],center:[21.017,105.82]},{name:"Ph∆∞·ªùng L√™ ƒê·∫°i H√†nh",district:"Hai B√† Tr∆∞ng",polygon:[[21.008,105.842],[21.012,105.844],[21.012,105.848],[21.008,105.846],[21.008,105.842]],bounds:[[21.008,105.842],[21.012,105.848]],center:[21.01,105.845]},{name:"Ph∆∞·ªùng Nguy·ªÖn Du",district:"Hai B√† Tr∆∞ng",polygon:[[21.013,105.849],[21.017,105.851],[21.017,105.855],[21.013,105.853],[21.013,105.849]],bounds:[[21.013,105.849],[21.017,105.855]],center:[21.015,105.852]},{name:"Ph∆∞·ªùng Qu·∫£ng An",district:"T√¢y H·ªì",polygon:[[21.055,105.812],[21.06,105.815],[21.062,105.82],[21.058,105.822],[21.053,105.818],[21.055,105.812]],bounds:[[21.053,105.812],[21.062,105.822]],center:[21.058,105.817]},{name:"Ph∆∞·ªùng Nh·∫≠t T√¢n",district:"T√¢y H·ªì",polygon:[[21.075,105.808],[21.08,105.811],[21.082,105.816],[21.078,105.818],[21.073,105.814],[21.075,105.808]],bounds:[[21.073,105.808],[21.082,105.818]],center:[21.078,105.813]},{name:"Ph∆∞·ªùng D·ªãch V·ªçng H·∫≠u",district:"C·∫ßu Gi·∫•y",polygon:[[21.03,105.778],[21.034,105.78],[21.036,105.785],[21.032,105.787],[21.028,105.783],[21.03,105.778]],bounds:[[21.028,105.778],[21.036,105.787]],center:[21.032,105.783]},{name:"Ph∆∞·ªùng Trung H√≤a",district:"C·∫ßu Gi·∫•y",polygon:[[21.005,105.79],[21.009,105.792],[21.011,105.797],[21.007,105.799],[21.003,105.795],[21.005,105.79]],bounds:[[21.003,105.79],[21.011,105.799]],center:[21.007,105.795]},{name:"Ph∆∞·ªùng Mai D·ªãch",district:"C·∫ßu Gi·∫•y",polygon:[[21.038,105.772],[21.042,105.774],[21.044,105.779],[21.04,105.781],[21.036,105.777],[21.038,105.772]],bounds:[[21.036,105.772],[21.044,105.781]],center:[21.04,105.777]},{name:"Ph∆∞·ªùng Y√™n H√≤a",district:"C·∫ßu Gi·∫•y",polygon:[[21.015,105.79],[21.019,105.792],[21.021,105.797],[21.017,105.799],[21.013,105.795],[21.015,105.79]],bounds:[[21.013,105.79],[21.021,105.799]],center:[21.017,105.795]},{name:"Ph∆∞·ªùng M·ªπ ƒê√¨nh 1",district:"Nam T·ª´ Li√™m",polygon:[[21.012,105.762],[21.016,105.765],[21.018,105.77],[21.014,105.772],[21.01,105.768],[21.012,105.762]],bounds:[[21.01,105.762],[21.018,105.772]],center:[21.014,105.767]},{name:"Ph∆∞·ªùng Ng·ªçc Th·ª•y",district:"Long Bi√™n",polygon:[[21.055,105.862],[21.059,105.865],[21.061,105.87],[21.057,105.872],[21.053,105.868],[21.055,105.862]],bounds:[[21.053,105.862],[21.061,105.872]],center:[21.057,105.867]},{name:"Ph∆∞·ªùng B·ªì ƒê·ªÅ",district:"Long Bi√™n",polygon:[[21.03,105.862],[21.034,105.865],[21.036,105.87],[21.032,105.872],[21.028,105.868],[21.03,105.862]],bounds:[[21.028,105.862],[21.036,105.872]],center:[21.032,105.867]},{name:"Ph∆∞·ªùng Ho√†ng Li·ªát",district:"Ho√†ng Mai",polygon:[[20.96,105.825],[20.964,105.828],[20.966,105.833],[20.962,105.835],[20.958,105.831],[20.96,105.825]],bounds:[[20.958,105.825],[20.966,105.835]],center:[20.962,105.83]},{name:"Ph∆∞·ªùng Nh√¢n Ch√≠nh",district:"Thanh Xu√¢n",polygon:[[20.995,105.798],[20.999,105.801],[21.001,105.806],[20.997,105.808],[20.993,105.804],[20.995,105.798]],bounds:[[20.993,105.798],[21.001,105.808]],center:[20.997,105.803]},{name:"Ph∆∞·ªùng Kh∆∞∆°ng Trung",district:"Thanh Xu√¢n",polygon:[[20.985,105.812],[20.989,105.815],[20.991,105.82],[20.987,105.822],[20.983,105.818],[20.985,105.812]],bounds:[[20.983,105.812],[20.991,105.822]],center:[20.987,105.817]},{name:"Ph∆∞·ªùng M·ªô Lao",district:"H√† ƒê√¥ng",polygon:[[20.975,105.77],[20.979,105.773],[20.981,105.778],[20.977,105.78],[20.973,105.776],[20.975,105.77]],bounds:[[20.973,105.77],[20.981,105.78]],center:[20.977,105.775]},{name:"Ph∆∞·ªùng VƒÉn Qu√°n",district:"H√† ƒê√¥ng",polygon:[[20.965,105.782],[20.969,105.785],[20.971,105.79],[20.967,105.792],[20.963,105.788],[20.965,105.782]],bounds:[[20.963,105.782],[20.971,105.792]],center:[20.967,105.787]},{name:"Ph∆∞·ªùng La Kh√™",district:"H√† ƒê√¥ng",polygon:[[20.96,105.752],[20.964,105.755],[20.966,105.76],[20.962,105.762],[20.958,105.758],[20.96,105.752]],bounds:[[20.958,105.752],[20.966,105.762]],center:[20.962,105.757]},{name:"Ph∆∞·ªùng Ph√∫ L∆∞∆°ng",district:"H√† ƒê√¥ng",polygon:[[20.925,105.765],[20.929,105.768],[20.931,105.773],[20.927,105.775],[20.923,105.771],[20.925,105.765]],bounds:[[20.923,105.765],[20.931,105.775]],center:[20.927,105.77]},{name:"Ph∆∞·ªùng Xu√¢n ƒê·ªânh",district:"B·∫Øc T·ª´ Li√™m",polygon:[[21.068,105.782],[21.072,105.785],[21.074,105.79],[21.07,105.792],[21.066,105.788],[21.068,105.782]],bounds:[[21.066,105.782],[21.074,105.792]],center:[21.07,105.787]},{name:"Ph∆∞·ªùng C·ªï Nhu·∫ø 1",district:"B·∫Øc T·ª´ Li√™m",polygon:[[21.048,105.772],[21.052,105.775],[21.054,105.78],[21.05,105.782],[21.046,105.778],[21.048,105.772]],bounds:[[21.046,105.772],[21.054,105.782]],center:[21.05,105.777]}];function hs(t){return fs.find(s=>s.name===t)}const yn={"Nh√† h√†ng":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></svg>',"Qu√°n c√† ph√™":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 2v2"/><path d="M14 2v2"/><path d="M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1"/><path d="M6 2v2"/></svg>',"Qu√°n ƒÉn nhanh":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 11h.01"/><path d="M11 15h.01"/><path d="M16 16h.01"/><path d="m2 16 20 6-6-20A20 20 0 0 0 2 16"/><path d="M5.71 17.11a17.04 17.04 0 0 1 11.4-11.4"/></svg>',"Qu√°n ph·ªü":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21a9 9 0 0 0 9-9H3a9 9 0 0 0 9 9Z"/><path d="M7 21h10"/><path d="M19.5 12 22 6"/><path d="M16.25 3c.27.1.8.53.75 1.36-.06.83-.93 1.2-1 2.02-.05.78.34 1.24.73 1.62"/><path d="M11.25 3c.27.1.8.53.74 1.36-.05.83-.93 1.2-.98 2.02-.06.78.33 1.24.72 1.62"/><path d="M6.25 3c.27.1.8.53.75 1.36-.06.83-.93 1.2-1 2.02-.05.78.34 1.24.74 1.62"/></svg>',"Qu√°n b√∫n":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21a9 9 0 0 0 9-9H3a9 9 0 0 0 9 9Z"/><path d="M7 21h10"/><path d="M19.5 12 22 6"/><path d="M16.25 3c.27.1.8.53.75 1.36-.06.83-.93 1.2-1 2.02-.05.78.34 1.24.73 1.62"/><path d="M11.25 3c.27.1.8.53.74 1.36-.05.83-.93 1.2-.98 2.02-.06.78.33 1.24.72 1.62"/><path d="M6.25 3c.27.1.8.53.75 1.36-.06.83-.93 1.2-1 2.02-.05.78.34 1.24.74 1.62"/></svg>',Buffet:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8"/><path d="M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7"/><path d="m2.1 21.8 6.4-6.3"/><path d="m19 5-7 7"/></svg>',"Qu√°n l·∫©u":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21a9 9 0 0 0 9-9H3a9 9 0 0 0 9 9Z"/><path d="M7 21h10"/><path d="M19.5 12 22 6"/><path d="M16.25 3c.27.1.8.53.75 1.36-.06.83-.93 1.2-1 2.02-.05.78.34 1.24.73 1.62"/><path d="M11.25 3c.27.1.8.53.74 1.36-.05.83-.93 1.2-.98 2.02-.06.78.33 1.24.72 1.62"/><path d="M6.25 3c.27.1.8.53.75 1.36-.06.83-.93 1.2-1 2.02-.05.78.34 1.24.74 1.62"/></svg>',"B√°nh m√¨":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8H4Z"/><path d="m4 11-.88-2.87a2 2 0 0 1 1.33-2.5l11.48-3.5a2 2 0 0 1 2.5 1.32l.87 2.87L4 11.01Z"/><path d="m6.6 13.4 3.4 3.4"/><path d="m10.6 13.4-3.4 3.4"/></svg>',"B·ªánh vi·ªán":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 6v12"/><path d="M6 12h12"/></svg>',"Ph√≤ng kh√°m":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3"/><path d="M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4"/><circle cx="20" cy="10" r="2"/></svg>',"Nh√† thu·ªëc":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z"/><path d="m8.5 8.5 7 7"/></svg>',"Ph√≤ng x√©t nghi·ªám":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 17v5"/><path d="M17 17v5"/><path d="M17 7 7 17"/><path d="M5 17h14"/></svg>',"Tr∆∞·ªùng h·ªçc":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></svg>',"Trung t√¢m ƒë√†o t·∫°o":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z"/><path d="M22 10v6"/><path d="M6 12.5V16a6 3 0 0 0 12 0v-3.5"/></svg>',"Th∆∞ vi·ªán":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>',"Nh√† tr·∫ª":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="5"/><path d="M3 21v-2a7 7 0 0 1 7-7v0a7 7 0 0 1 7 7v2"/></svg>',"Si√™u th·ªã":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>',"C·ª≠a h√†ng ti·ªán l·ª£i":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9Z"/><path d="M3 9V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v4"/><path d="M9 22V12h6v10"/></svg>',"Shop th·ªùi trang":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>',"C·ª≠a h√†ng ƒëi·ªán t·ª≠":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 21h8"/><path d="M12 17v4"/></svg>',Ch·ª£:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7"/><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><path d="M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4"/><path d="M2 7h20"/><path d="M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7"/></svg>',"Salon t√≥c":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3h12l4 6-10 13L2 9Z"/><path d="M11 3 8 9l4 13 4-13-3-6"/></svg>',"Spa & Massage":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 10h.01"/><path d="M15 10h.01"/><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"/></svg>',"Gi·∫∑t ·ªßi":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h3"/><path d="M17 6h.01"/><rect width="18" height="20" x="3" y="2" rx="2"/><circle cx="12" cy="13" r="5"/><path d="M12 18a2.5 2.5 0 0 0 0-5 2.5 2.5 0 0 1 0-5"/></svg>',"Th·∫©m m·ªπ vi·ªán":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>',"R·∫°p phim":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M7 3v18"/><path d="M3 7.5h4"/><path d="M3 12h18"/><path d="M3 16.5h4"/><path d="M17 3v18"/><path d="M17 7.5h4"/><path d="M17 16.5h4"/></svg>',Karaoke:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="22"/></svg>',"Ph√≤ng gym":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14.4 14.4 9.6 9.6"/><path d="M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z"/><path d="m21.5 21.5-1.4-1.4"/><path d="M3.9 3.9 2.5 2.5"/><path d="M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z"/></svg>',Billiards:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="4"/></svg>',"Game center":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="6" x2="10" y1="12" y2="12"/><line x1="8" x2="8" y1="10" y2="14"/><line x1="15" x2="15.01" y1="13" y2="13"/><line x1="18" x2="18.01" y1="11" y2="11"/><rect width="20" height="12" x="2" y="6" rx="2"/></svg>',"Ng√¢n h√†ng":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="3" x2="21" y1="22" y2="22"/><line x1="6" x2="6" y1="18" y2="11"/><line x1="10" x2="10" y1="18" y2="11"/><line x1="14" x2="14" y1="18" y2="11"/><line x1="18" x2="18" y1="18" y2="11"/><polygon points="12 2 20 7 4 7"/></svg>',ATM:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="12" x="2" y="6" rx="2"/><circle cx="12" cy="12" r="2"/><path d="M6 12h.01M18 12h.01"/></svg>',"C·ª≠a h√†ng v√†ng":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="6"/><path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"/></svg>',"B·∫£o hi·ªÉm":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>',"C·ª≠a h√†ng ƒëi·ªán tho·∫°i":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></svg>',"S·ª≠a ch·ªØa m√°y t√≠nh":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect width="16" height="10" x="4" y="3" rx="2"/><path d="M8 21h8"/><path d="M12 17v4"/></svg>',"C·ª≠a h√†ng m√°y ·∫£nh":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>',"Tr·∫°m xƒÉng":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 22h12"/><path d="M4 9h10"/><path d="M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18"/><path d="M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2h0a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5"/></svg>',"Garage s·ª≠a xe":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10 2h4"/><path d="M4.6 11a8 8 0 0 0 1.7 8.7 8 8 0 0 0 8.7 1.7"/><path d="M7.4 7.4a8 8 0 0 1 10.3 1 8 8 0 0 1 .9 10.2"/><path d="m2 2 20 20"/><path d="M12 12v-2"/></svg>',"R·ª≠a xe":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z"/><path d="M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97"/></svg>',"Kh√°ch s·∫°n":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2Z"/><path d="m9 16 .348-.24c1.465-1.013 3.84-1.013 5.304 0L15 16"/><path d="M8 7h.01"/><path d="M16 7h.01"/><path d="M12 7h.01"/><path d="M12 11h.01"/><path d="M16 11h.01"/><path d="M8 11h.01"/><path d="M10 22v-6.5m4 0V22"/></svg>',"VƒÉn ph√≤ng cho thu√™":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect width="16" height="20" x="4" y="2" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M12 6h.01"/><path d="M12 10h.01"/><path d="M12 14h.01"/><path d="M16 10h.01"/><path d="M16 14h.01"/><path d="M8 10h.01"/><path d="M8 14h.01"/></svg>',"Kho b√£i":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>',"B∆∞u ƒëi·ªán":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>',"In ·∫•n":'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect width="12" height="8" x="6" y="14"/></svg>'};function Ns(t){return yn[t]||yn["Nh√† h√†ng"]}function vs(t,s){return Ns(t).replace(/width="\d+"/,`width="${s}"`).replace(/height="\d+"/,`height="${s}"`)}function Sn(t){return 15}function Vs(t){const s=Sn();return Math.round(s*.55)}function In(t){switch(t){case"certified":return"#22c55e";case"hotspot":return"#ef4444";case"scheduled":return"#eab308";case"inspected":return"#005cb6";default:return"#005cb6"}}function bs(t){switch(t){case"certified":return"Ch·ª©ng nh·∫≠n ATTP";case"hotspot":return"ƒêi·ªÉm n√≥ng";case"scheduled":return"K·∫ø ho·∫°ch ki·ªÉm tra";case"inspected":return"ƒê√£ ki·ªÉm tra";default:return t}}function gs(t){const s=In(t.category),n=bs(t.category);return`
    <div class="leaflet-popup-custom" style="font-family: 'Inter', sans-serif; min-width: 260px;">
      <!-- Category Badge -->
      <div style="
        position: relative;
        margin: -12px -12px 0 -12px;
        padding: 12px 16px;
        background: linear-gradient(135deg, ${s} 0%, ${s}ee 100%);
        color: white;
        border-radius: 8px 8px 0 0;
      ">
        <div style="
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.8px;
          opacity: 0.9;
          margin-bottom: 4px;
        ">${n}</div>
        <div style="
          font-size: 15px;
          font-weight: 700;
          line-height: 1.3;
          color: white;
        ">${t.name}</div>
      </div>
      
      <!-- Content -->
      <div style="padding: 16px 0 12px 0;">
        <!-- ID Badge -->
        <div style="
          display: inline-flex;
          align-items: center;
          gap: 6px;
          padding: 4px 10px;
          background: #f3f4f6;
          border-radius: 6px;
          margin-bottom: 14px;
        ">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <line x1="16" y1="2" x2="16" y2="6"/>
            <line x1="8" y1="2" x2="8" y2="6"/>
            <line x1="3" y1="10" x2="21" y2="10"/>
          </svg>
          <span style="
            font-size: 11px;
            font-weight: 600;
            color: #374151;
            letter-spacing: 0.3px;
          ">MST: ${t.taxCode||"N/A"}</span>
        </div>
        
        <!-- Info Items -->
        <div style="display: flex; flex-direction: column; gap: 10px;">
          <div style="display: flex; gap: 10px;">
            <div style="
              width: 28px;
              height: 28px;
              flex-shrink: 0;
              background: #eff6ff;
              border-radius: 6px;
              display: flex;
              align-items: center;
              justify-content: center;
            ">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#005cb6" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/>
                <path d="M7 2v20"/>
                <path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/>
              </svg>
            </div>
            <div style="flex: 1; min-width: 0;">
              <div style="
                font-size: 10px;
                font-weight: 600;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 0.4px;
                margin-bottom: 3px;
              ">Lo·∫°i h√¨nh</div>
              <div style="
                font-size: 13px;
                font-weight: 500;
                color: #111827;
                line-height: 1.3;
              ">${t.type}</div>
            </div>
          </div>
          
          <div style="display: flex; gap: 10px;">
            <div style="
              width: 28px;
              height: 28px;
              flex-shrink: 0;
              background: #fef3f2;
              border-radius: 6px;
              display: flex;
              align-items: center;
              justify-content: center;
            ">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/>
                <circle cx="12" cy="10" r="3"/>
              </svg>
            </div>
            <div style="flex: 1; min-width: 0;">
              <div style="
                font-size: 10px;
                font-weight: 600;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 0.4px;
                margin-bottom: 3px;
              ">ƒê·ªãa ch·ªâ</div>
              <div style="
                font-size: 13px;
                font-weight: 400;
                color: #374151;
                line-height: 1.4;
              ">${t.address}</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Action Button -->
      <div style="
        padding: 12px 0 0 0;
        border-top: 1px solid #e5e7eb;
      ">
        <div style="
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 8px;
        ">
          <button 
            onclick="window.openPointReview('${t.id}')"
            style="
              padding: 10px 14px;
              background: white;
              color: ${s};
              border: 1px solid ${s};
              border-radius: 8px;
              font-family: 'Inter', sans-serif;
              font-size: 13px;
              font-weight: 600;
              cursor: pointer;
              transition: all 0.2s;
              display: flex;
              align-items: center;
              justify-content: center;
              gap: 6px;
            "
            onmouseover="this.style.background='${s}'; this.style.color='white'"
            onmouseout="this.style.background='white'; this.style.color='${s}'"
          >
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
            </svg>
            ƒê√°nh gi√°
          </button>
          
          <button 
            onclick="event.stopPropagation(); event.preventDefault(); window.openPointDetail('${t.id}', event);"
            style="
              padding: 10px 14px;
              background: ${s};
              color: white;
              border: none;
              border-radius: 8px;
              font-family: 'Inter', sans-serif;
              font-size: 13px;
              font-weight: 600;
              cursor: pointer;
              transition: all 0.2s;
              display: flex;
              align-items: center;
              justify-content: center;
              gap: 6px;
            "
            onmouseover="this.style.opacity='0.9'; this.style.transform='translateY(-1px)'"
            onmouseout="this.style.opacity='1'; this.style.transform='translateY(0)'"
          >
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 16v-4"/>
              <path d="M12 8h.01"/>
            </svg>
            Chi ti·∫øt
          </button>
        </div>
      </div>
    </div>
  `}function xs(t,s,n){const o=In(t.category),a=t.citizenReports&&t.citizenReports.length>0,m=t.category==="hotspot",i=o==="#22c55e"?"#16a34a":o==="#ef4444"?"#dc2626":o==="#eab308"?"#ca8a04":o==="#005cb6"?"#004a94":o,r=Math.round(s*.3),d=Math.round(s*.08);return`
    <div class="marker-wrapper" style="
      width: ${s}px;
      height: ${s}px;
      background: linear-gradient(135deg, ${o} 0%, ${i} 100%);
      border-radius: 50% 50% 50% 0;
      transform: rotate(-45deg);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 
        0 2px 8px rgba(0, 0, 0, 0.15),
        0 4px 16px rgba(0, 0, 0, 0.1),
        inset 0 -1px 2px rgba(0, 0, 0, 0.1);
      position: relative;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    ">
      ${a||m?'<div class="alert-pulse-ring"></div>':""}
      <div style="
        position: absolute;
        top: ${d}px;
        left: ${d}px;
        right: ${d}px;
        height: ${r}px;
        background: linear-gradient(180deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0) 100%);
        border-radius: 50% 50% 0 0;
        pointer-events: none;
      "></div>
      <div style="
        transform: rotate(45deg);
        position: relative;
        z-index: 1;
      ">
        ${vs(t.type,n)}
      </div>
    </div>
  `}function Ts(t){const s=t.citizenReports&&t.citizenReports.length>0,n=t.category==="hotspot";return s||n}async function Es(t){try{if(!t||typeof t!="string"||t.trim()==="")return console.warn("‚ö†Ô∏è DepartmentAreasAPI: Invalid departmentId for RPC call"),[];const s=m=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(m);let n=t;if(!s(t)){console.log("‚ö†Ô∏è DepartmentAreasAPI: departmentId is not a UUID, searching by name:",t);const{data:m,error:i}=await qe.from("departments").select("_id").eq("name",t).is("deleted_at",null).single();if(i||!m)return console.error(`‚ùå DepartmentAreasAPI: Department not found by name "${t}":`,i),[];n=m._id,console.log("‚úÖ DepartmentAreasAPI: Found department UUID:",n)}console.log("üîÑ DepartmentAreasAPI: Calling RPC get_ward_coordinates_by_department via axios"),console.log("üìã DepartmentAreasAPI: Parameters:",{originalDepartmentId:t,actualDepartmentId:n,type:typeof n});const o=`${We}/rpc/get_ward_coordinates_by_department`,a={department_id:n};try{console.log("üì§ DepartmentAreasAPI: Sending POST request to:",o),console.log("üì§ DepartmentAreasAPI: Request body:",a);const m=await Le.post(o,a,{headers:ye()}),i=m.data;if(console.log("üì¶ DepartmentAreasAPI: RPC response:",{status:m.status,statusText:m.statusText,hasData:!!i,dataType:Array.isArray(i)?"array":typeof i,dataLength:Array.isArray(i)?i.length:"N/A",dataSample:Array.isArray(i)&&i.length>0?i[0]:i}),!i||!Array.isArray(i)){console.warn("‚ö†Ô∏è DepartmentAreasAPI: RPC returned invalid data:",i),console.log("üîÑ DepartmentAreasAPI: Retrying with departmentId parameter name...");const u=(await Le.post(o,{departmentId:n},{headers:ye()})).data;return!u||!Array.isArray(u)?(console.warn("‚ö†Ô∏è DepartmentAreasAPI: Retry returned invalid data:",u),[]):(console.log("‚úÖ DepartmentAreasAPI: Retry successful, returned",u.length,"ward coordinates"),u.filter(h=>h.ward_id&&h.center_lat!==null&&h.center_lng!==null&&typeof h.center_lat=="number"&&typeof h.center_lng=="number"&&!isNaN(h.center_lat)&&!isNaN(h.center_lng)))}console.log("‚úÖ DepartmentAreasAPI: RPC returned",i.length,"ward coordinates"),console.log("üìä DepartmentAreasAPI: First item sample:",i[0]);const r=i.filter(d=>d.ward_id&&d.center_lat!==null&&d.center_lng!==null&&typeof d.center_lat=="number"&&typeof d.center_lng=="number"&&!isNaN(d.center_lat)&&!isNaN(d.center_lng));return console.log("‚úÖ DepartmentAreasAPI: Filtered to",r.length,"valid ward coordinates"),r}catch(m){if(console.error("‚ùå DepartmentAreasAPI: RPC call failed:",m),m.response){if(console.error("‚ùå DepartmentAreasAPI: Response error:",{status:m.response.status,statusText:m.response.statusText,data:m.response.data}),m.response.status===403){const i=m.response.data;if((i==null?void 0:i.error_code)==="session_not_found")return console.warn("‚ö†Ô∏è DepartmentAreasAPI: Session not found (403), returning empty array"),[]}if(m.response.status===400||m.response.status===404){console.log("üîÑ DepartmentAreasAPI: Retrying with departmentId parameter name...");try{const r=(await Le.post(o,{departmentId:n},{headers:ye()})).data;return!r||!Array.isArray(r)?(console.warn("‚ö†Ô∏è DepartmentAreasAPI: Retry returned invalid data:",r),[]):(console.log("‚úÖ DepartmentAreasAPI: Retry successful, returned",r.length,"ward coordinates"),r.filter(d=>d.ward_id&&d.center_lat!==null&&d.center_lng!==null&&typeof d.center_lat=="number"&&typeof d.center_lng=="number"&&!isNaN(d.center_lat)&&!isNaN(d.center_lng)))}catch(i){return console.error("‚ùå DepartmentAreasAPI: Retry also failed:",i),[]}}}return console.warn("‚ö†Ô∏è DepartmentAreasAPI: Returning empty array due to error"),[]}}catch(s){throw console.error("‚ùå DepartmentAreasAPI: Failed to call RPC get_ward_coordinates_by_department:",s),s}}async function Hs(t){try{if(!t||typeof t!="string"||t.trim()==="")return console.warn("DepartmentAreasAPI: Invalid wardId for RPC call"),[];console.log("DepartmentAreasAPI: Calling RPC get_departments_by_ward via axios"),console.log("DepartmentAreasAPI: Parameters:",{wardId:t,type:typeof t});const s=`${We}/rpc/get_departments_by_ward`,n={ward_id:t};try{console.log("üì§ DepartmentAreasAPI: Sending POST request to:",s),console.log("üì§ DepartmentAreasAPI: Request body:",n);const o=await Le.post(s,n,{headers:ye()}),a=o.data;if(console.log("DepartmentAreasAPI: RPC response:",{status:o.status,statusText:o.statusText,hasData:!!a,dataType:Array.isArray(a)?"array":typeof a,dataLength:Array.isArray(a)?a.length:"N/A",dataSample:Array.isArray(a)&&a.length>0?a[0]:a}),!a||!Array.isArray(a)){console.warn("DepartmentAreasAPI: RPC returned invalid data:",a),console.log("DepartmentAreasAPI: Retrying with wardId parameter name...");const i=(await Le.post(s,{wardId:t},{headers:ye()})).data;return!i||!Array.isArray(i)?(console.warn("DepartmentAreasAPI: Retry returned invalid data:",i),[]):(console.log("DepartmentAreasAPI: Retry successful, returned",i.length,"departments"),i)}return console.log("DepartmentAreasAPI: RPC returned",a.length,"departments"),console.log("DepartmentAreasAPI: First department sample:",a[0]),a}catch(o){if(console.error("DepartmentAreasAPI: RPC call failed:",o),o.response){if(console.error("DepartmentAreasAPI: Response error:",{status:o.response.status,statusText:o.response.statusText,data:o.response.data}),o.response.status===403){const a=o.response.data;if((a==null?void 0:a.error_code)==="session_not_found")return console.warn("DepartmentAreasAPI: Session not found (403), returning empty array"),[]}if(o.response.status===400||o.response.status===404){console.log("üîÑ DepartmentAreasAPI: Retrying with wardId parameter name...");try{const m=(await Le.post(s,{wardId:t},{headers:ye()})).data;return!m||!Array.isArray(m)?(console.warn("‚ö†Ô∏è DepartmentAreasAPI: Retry returned invalid data:",m),[]):(console.log("‚úÖ DepartmentAreasAPI: Retry successful, returned",m.length,"departments"),m)}catch(a){return console.error("‚ùå DepartmentAreasAPI: Retry also failed:",a),[]}}}return console.warn("‚ö†Ô∏è DepartmentAreasAPI: Returning empty array due to error"),[]}}catch(s){throw console.error("‚ùå DepartmentAreasAPI: Failed to call RPC get_departments_by_ward:",s),s}}async function Ln(t){try{if(!t||typeof t!="string"||t.trim()==="")return console.warn("‚ö†Ô∏è DepartmentAreasAPI: Invalid departmentId for RPC call"),[];console.log("üîÑ DepartmentAreasAPI: Calling RPC get_users_by_department via axios"),console.log("üìã DepartmentAreasAPI: Parameters:",{departmentId:t,type:typeof t});const s=`${We}/rpc/get_users_by_department`,n={department_id:t};try{console.log("üì§ DepartmentAreasAPI: Sending POST request to:",s),console.log("üì§ DepartmentAreasAPI: Request body:",n);const o=await Le.post(s,n,{headers:ye()}),a=o.data;if(console.log("üì¶ DepartmentAreasAPI: RPC response:",{status:o.status,statusText:o.statusText,hasData:!!a,dataType:Array.isArray(a)?"array":typeof a,dataLength:Array.isArray(a)?a.length:"N/A",dataSample:Array.isArray(a)&&a.length>0?a[0]:a}),!a||!Array.isArray(a)){console.warn("‚ö†Ô∏è DepartmentAreasAPI: RPC returned invalid data:",a),console.log("üîÑ DepartmentAreasAPI: Retrying with departmentId parameter name...");const i=(await Le.post(s,{departmentId:t},{headers:ye()})).data;return!i||!Array.isArray(i)?(console.warn("‚ö†Ô∏è DepartmentAreasAPI: Retry returned invalid data:",i),[]):(console.log("‚úÖ DepartmentAreasAPI: Retry successful, returned",i.length,"users"),i)}return console.log("‚úÖ DepartmentAreasAPI: RPC returned",a.length,"users"),console.log("üìä DepartmentAreasAPI: First user sample:",a[0]),a}catch(o){if(console.error("‚ùå DepartmentAreasAPI: RPC call failed:",o),o.response){if(console.error("‚ùå DepartmentAreasAPI: Response error:",{status:o.response.status,statusText:o.response.statusText,data:o.response.data}),o.response.status===403){const a=o.response.data;if((a==null?void 0:a.error_code)==="session_not_found")return console.warn("‚ö†Ô∏è DepartmentAreasAPI: Session not found (403), returning empty array"),[]}if(o.response.status===400||o.response.status===404){console.log("üîÑ DepartmentAreasAPI: Retrying with departmentId parameter name...");try{const m=(await Le.post(s,{departmentId:actualDepartmentId},{headers:ye()})).data;return!m||!Array.isArray(m)?(console.warn("‚ö†Ô∏è DepartmentAreasAPI: Retry returned invalid data:",m),[]):(console.log("‚úÖ DepartmentAreasAPI: Retry successful, returned",m.length,"users"),m)}catch(a){return console.error("‚ùå DepartmentAreasAPI: Retry also failed:",a),[]}}}return console.warn("‚ö†Ô∏è DepartmentAreasAPI: Returning empty array due to error"),[]}}catch(s){return console.error("‚ùå DepartmentAreasAPI: Failed to call RPC get_users_by_department:",s),[]}}async function Ds(t,s=!1){try{const n=Array.isArray(t)?t:[t];if(n.length===0)return null;const o=n.filter(d=>d&&typeof d=="string"&&d.trim()!=="");if(o.length===0)return null;const a=o.join(","),m=`${We}/department_areas?select=department_id,areas(province_id,ward_id,wards_with_coordinates(center_lat,center_lng,bounds,area,officer))&department_id=in.(${a})`;console.log("üîç DepartmentAreasAPI: Fetching from URL:",m);const r=(await Le.get(m,{headers:ye()})).data||[];if(console.log("üì¶ DepartmentAreasAPI: Raw response:",{dataType:Array.isArray(r)?"array":typeof r,dataLength:Array.isArray(r)?r.length:"N/A",sample:Array.isArray(r)&&r.length>0?JSON.stringify(r[0],null,2):JSON.stringify(r,null,2)}),Array.isArray(r)&&r.length>0){const d=[];for(const u of r)if(u&&typeof u=="object"&&"areas"in u){const h=u.areas,v=u.department_id||u.departmentId||null;if(h&&typeof h=="object"&&!Array.isArray(h)&&("ward_id"in h||"province_id"in h)){const H={...h,department_id:v};d.push(H)}}if(d.length>0){if(s){const u=new Map;for(const v of d){const H=v.ward_id||v.province_id||"";H&&(u.has(H)?!u.get(H).wards_with_coordinates&&v.wards_with_coordinates&&u.set(H,v):u.set(H,v))}const h=Array.from(u.values());return console.log(`üìã DepartmentAreasAPI: Grouped areas by wardId: ${d.length} ‚Üí ${h.length} unique areas`),{areas:h}}return{areas:d}}}else if(r&&typeof r=="object"&&!Array.isArray(r)&&"areas"in r){const d=r.areas;if(d&&typeof d=="object"&&!Array.isArray(d))return{areas:[d]};if(Array.isArray(d))return{areas:d}}return console.warn("‚ö†Ô∏è DepartmentAreasAPI: Unexpected response structure:",r),null}catch(n){throw console.error("‚ùå DepartmentAreasAPI: Failed to fetch department areas:",n),n}}function _s(t,s=!0){var u,h;const n=st(),o=Qe(v=>v.officerFilter.selectedDepartmentId),a=Qe(v=>v.departmentAreas),m=Qe(v=>v.qlttScope),i=(u=m==null?void 0:m.scope)==null?void 0:u.divisionId,r=(h=m==null?void 0:m.scope)==null?void 0:h.teamId,d=o&&o!==""?o:t||null;return l.useEffect(()=>{if(!s)return;const v=!d&&!i;if(!d&&!v){n(Ke(null)),n(xn(null));return}if(a.isLoading)return;const H=v?"all":d;if(!(a.currentDepartmentId!==H))return;async function f(){n(xn(H||null)),n(Ze(!0));try{if(v){console.log("üìã useDepartmentAreas: Fetching all departments - need to handle differently"),n(Ke(null)),n(dt("Fetching all departments not supported with RPC")),n(Ze(!1));return}if(!d){n(Ke(null)),n(dt("No department ID provided")),n(Ze(!1));return}console.log("üîÑ useDepartmentAreas: Calling RPC get_ward_coordinates_by_department with departmentId:",d);const g=await Es(d);if(g.length===0){console.warn("‚ö†Ô∏è useDepartmentAreas: No ward coordinates found for department"),n(Ke(null)),n(dt("No ward coordinates found for department")),n(Ze(!1));return}console.log("‚úÖ useDepartmentAreas: RPC returned",g.length,"ward coordinates");const E=new Map;g.forEach(C=>{C.ward_id&&!E.has(C.ward_id)&&E.set(C.ward_id,C)}),console.log("‚úÖ useDepartmentAreas: Unique ward coordinates:",{total:g.length,unique:E.size,sample:Array.from(E.values()).slice(0,3).map(C=>({ward_id:C.ward_id,center:[C.center_lat,C.center_lng]}))});const V=Array.from(E.values()).map(C=>({province_id:C.province_id||"",ward_id:C.ward_id,wards_with_coordinates:{center_lat:C.center_lat,center_lng:C.center_lng,bounds:C.bounds||null,area:C.area||null,officer:C.officer||null}}));console.log("‚úÖ useDepartmentAreas: Transformed to areas format:",V.length,"areas"),n(Ke({areas:V})),n(Ze(!1))}catch(g){console.error("‚ùå useDepartmentAreas: Failed to fetch department areas:",g);const E=g!=null&&g.message?String(g.message):"Failed to fetch department areas";n(dt(E)),n(Ke(null)),n(Ze(!1))}}f()},[s,d,o,t,i,r,n]),{departmentAreas:a.data,isLoading:a.isLoading,error:a.error,currentDepartmentId:a.currentDepartmentId}}function ys(t,s,n){if(!t)return null;let o=[];if(t.areas){if(Array.isArray(t.areas))o=t.areas;else if(typeof t.areas=="object"&&t.areas!==null){const i=Object.keys(t.areas),r=Object.values(t.areas),d=r.filter(h=>h!=null);if(d.length>0&&d.every(h=>typeof h=="object"&&(h.province_id||h.ward_id)))o=d;else if(("province_id"in t.areas||"ward_id"in t.areas)&&i.length<=5)o=[t.areas];else for(const h of r)Array.isArray(h)?o=[...o,...h.filter(v=>v&&typeof v=="object"&&("province_id"in v||"ward_id"in v))]:h&&typeof h=="object"&&("province_id"in h||"ward_id"in h)&&o.push(h)}}if(!Array.isArray(o)||o.length===0)return null;const a=o.map(i=>{if(!i||!i.wards_with_coordinates||typeof i.wards_with_coordinates!="object")return null;const r=i.wards_with_coordinates,u=r.center_lat!==null&&r.center_lat!==void 0&&typeof r.center_lat=="number"&&!isNaN(r.center_lat)&&r.center_lng!==null&&r.center_lng!==void 0&&typeof r.center_lng=="number"&&!isNaN(r.center_lng)?[r.center_lat,r.center_lng]:null;return{provinceId:i.province_id||"",wardId:i.ward_id||"",departmentId:i.department_id||i.departmentId||void 0,coordinates:{center:u,bounds:(r==null?void 0:r.bounds)||null,area:(r==null?void 0:r.area)||null,officer:(r==null?void 0:r.officer)||null}}}).filter(i=>i!==null&&i.coordinates.center!==null);if(a.length===0)return null;const m=n?n.filter(i=>i.latitude!==null&&i.longitude!==null&&!isNaN(i.latitude)&&!isNaN(i.longitude)).map(i=>({id:i.id,name:i.name,latitude:i.latitude,longitude:i.longitude})):void 0;return{departmentId:s,departments:m,areas:a}}function Ls(t){if(t.length===0)return null;const s=t.reduce((o,[a])=>o+a,0)/t.length,n=t.reduce((o,[,a])=>o+a,0)/t.length;return[s,n]}function ws(t){return t?t.areas.map(s=>s.coordinates.center).filter(s=>s!==null):[]}const js=({mapInstance:t,leafletRef:s,departmentMapData:n,isLoading:o,error:a,markersRef:m,wardBoundariesLayerRef:i})=>{const r=l.useCallback(()=>{var H,b;if(!t||!s)return;const d=s;if(i.current.forEach(f=>f.remove()),i.current=[],o||a||!n)return;if(console.log("üó∫Ô∏è DepartmentMarkersLayer: Rendering department markers",{hasMapData:!!n,areasCount:((H=n.areas)==null?void 0:H.length)||0,areasSample:((b=n.areas)==null?void 0:b.slice(0,2).map(f=>({wardId:f.wardId,provinceId:f.provinceId,hasCenter:!!f.coordinates.center,center:f.coordinates.center})))||[]}),!n.areas||n.areas.length===0){console.warn("‚ö†Ô∏è DepartmentMarkersLayer: No areas in departmentMapData");return}const h=d.divIcon({html:`
        <div style="
          background: white;
          border-radius: 50%;
          width: 28px;
          height: 28px;
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 2px 6px rgba(0,0,0,0.25);
          border: 2px solid #005cb6;
        ">
          
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#005cb6" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
        <circle cx="9" cy="7" r="4"/>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
      </svg>
    
        </div>
      `,className:"department-marker",iconSize:[28,28],iconAnchor:[14,14]}),v=new Map;n.areas.forEach((f,g)=>{if(f.coordinates.center){const E=f.wardId||f.provinceId||"";if(E&&!v.has(E)){const V=f.departmentId?[f.departmentId]:[];v.set(E,{center:f.coordinates.center,wardId:f.wardId,provinceId:f.provinceId,departmentIds:V,areas:[f]})}else if(E&&v.has(E)){const V=v.get(E);V.areas.push(f),f.departmentId&&!V.departmentIds.includes(f.departmentId)&&V.departmentIds.push(f.departmentId)}}else g<3&&console.warn("‚ö†Ô∏è DepartmentMarkersLayer: Area missing center coordinates:",{wardId:f.wardId,provinceId:f.provinceId,coordinates:f.coordinates})}),console.log("üó∫Ô∏è DepartmentMarkersLayer: Ward markers map created:",{totalAreas:n.areas.length,uniqueWards:v.size,sampleWards:Array.from(v.entries()).slice(0,3).map(([f,g])=>({key:f,center:g.center,areasCount:g.areas.length}))}),v.forEach(f=>{const g=d.marker(f.center,{icon:h}),E=f.areas.length,V=f.areas.map(w=>w.coordinates.officer).filter(w=>w!==null&&w!==""),Q=Array.from(new Set(V)),C=`
        <div style="
          font-family: 'Inter', sans-serif;
          max-width: 300px;
          padding: 8px;
        ">
          <div style="
            font-weight: 600;
            font-size: 14px;
            color: #005cb6;
            margin-bottom: 8px;
            border-bottom: 2px solid #005cb6;
            padding-bottom: 4px;
          ">
            ƒê·ªãa b√†n ph·ª• tr√°ch
          </div>
          <div style="font-size: 12px; margin-bottom: 6px;">
            <strong>S·ªë khu v·ª±c:</strong> ${E}
          </div>
          ${Q.length>0?`
            <div style="font-size: 12px; margin-bottom: 6px;">
              <strong>C√°n b·ªô ph·ª• tr√°ch:</strong> ${Q.length} ng∆∞·ªùi
            </div>
            <div style="font-size: 11px; color: #666; margin-top: 8px; max-height: 120px; overflow-y: auto;">
              <strong>Danh s√°ch c√°n b·ªô:</strong><br/>
              ${Q.map(w=>`‚Ä¢ ${w}`).join("<br/>")}
            </div>
          `:""}
        </div>
      `;g.bindTooltip(C,{permanent:!1,direction:"top",className:"department-tooltip",offset:[0,-10]}),g.on("click",()=>{if(typeof window.openDepartmentDetail=="function"){const w=f.departmentIds.length>0?f.departmentIds[0]:n.departmentId;console.log("üîç DepartmentMarkersLayer: Clicked marker",{wardId:f.wardId,departmentIds:f.departmentIds,selectedDepartmentId:w}),window.openDepartmentDetail(w,{...n,departmentId:w,wardId:f.wardId,areas:f.areas,departmentIds:f.departmentIds})}}),g.addTo(t),m.current.push(g)}),console.log("‚úÖ DepartmentMarkersLayer: Rendered",v.size,"ward markers from",n.areas.length,"areas")},[t,s,n,o,a,m,i]);return l.useEffect(()=>{!t||!s||r()},[r,t,s]),null};function Ms({filters:t,businessTypeFilters:s,searchQuery:n,selectedRestaurant:o,selectedProvince:a,selectedDistrict:m,selectedWard:i,restaurants:r=[],showWardBoundaries:d=!1,showMerchants:u=!1,selectedTeamId:h,onPointClick:v,onWardClick:H,onFullscreenClick:b}){var y,W;const f=l.useRef(null),g=l.useRef(null),E=l.useRef(null),V=l.useRef([]),Q=l.useRef([]),C=l.useRef(null);l.useRef(null);const w=l.useRef(null),z=l.useRef([]),U=l.useRef(""),J=l.useRef(""),fe=l.useRef(""),ae=l.useRef(12),q=l.useRef(!1),X=l.useRef(null),re=l.useRef(null),de=l.useRef(!1),ne=l.useRef(void 0),se=l.useRef(void 0),pe=Qe(R=>R.qlttScope),xe=(y=pe==null?void 0:pe.scope)==null?void 0:y.divisionId,S=(W=pe==null?void 0:pe.scope)==null?void 0:W.teamId,G=h||S||xe,{departmentAreas:Y,isLoading:Te,error:A,currentDepartmentId:ie}=_s(G||null,!0),te=l.useMemo(()=>{if(Te&&!Y||Te||A||!Y)return null;const R=(Y==null?void 0:Y.departments)||null;return ys(Y,G||"all",R)},[Y,G,ie,Te,A]),Z=l.useMemo(()=>!r||r.length===0?[]:r,[r]),Ne=l.useCallback(()=>{if(!g.current||!E.current)return;const R=E.current;ae.current;const c=Sn(),N=Vs();if(d&&!u){V.current.forEach(x=>x.remove()),V.current=[],C.current=null;return}if(V.current.forEach(x=>x.remove()),V.current=[],C.current=null,console.log("üó∫Ô∏è LeafletMap updateMarkers:",{showWardBoundaries:d,showMerchants:u,restaurantsCount:Z.length,restaurants:Z.slice(0,3).map(x=>({id:x.id,name:x.name,lat:x.lat,lng:x.lng}))}),!(d&&!u)){if(!u){d||(Q.current.forEach(x=>x.remove()),Q.current=[]);return}u&&!d&&(Q.current.forEach(x=>x.remove()),Q.current=[]),Z.forEach(x=>{const _=x.lat!==null&&x.lat!==void 0&&!isNaN(x.lat),D=x.lng!==null&&x.lng!==void 0&&!isNaN(x.lng);if(!_||!D)return;const k=xs(x,c,N),K=R.divIcon({html:k,className:Ts(x)?"custom-marker-icon has-citizen-reports":"custom-marker-icon",iconSize:[c,c],iconAnchor:[c/2,c],popupAnchor:[0,-c]}),F=R.marker([x.lat,x.lng],{icon:K}).addTo(g.current).bindPopup(gs(x),{maxWidth:320,className:"custom-leaflet-popup"});V.current.push(F),o&&x.id===o.id&&(C.current=F)})}},[Z,o,d,te,Te,A]);l.useEffect(()=>{re.current=Ne},[Ne]);const j=l.useCallback(()=>{if(!g.current||!E.current||q.current)return;const R=E.current,c=U.current!==n,N=(o==null?void 0:o.id)||null;if(X.current!==N&&o&&C.current){g.current.setView([o.lat,o.lng],16,{animate:!0,duration:.6}),setTimeout(()=>{C.current&&C.current.openPopup()},700),X.current=N,q.current=!1;return}if(c){if(n.trim()&&Z.length>0)if(Z.length===1)g.current.setView([Z[0].lat,Z[0].lng],15,{animate:!0,duration:.5});else{const _=R.latLngBounds(Z.map(D=>[D.lat,D.lng]));g.current.fitBounds(_,{padding:[50,50],animate:!0,duration:.5})}else U.current&&!n.trim()&&g.current.setView([21.0285,105.8542],12,{animate:!0,duration:.5});U.current=n,q.current=!1}},[n,o,Z]);return l.useEffect(()=>{if(!f.current||g.current||f.current._leaflet_id)return;const R=document.createElement("link");return R.rel="stylesheet",R.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(R),ua(()=>import("./leaflet-fbicKXUd.js").then(c=>c.l),__vite__mapDeps([0,1,2,3])).then(c=>{var x;if(g.current||(x=f.current)!=null&&x._leaflet_id||!f.current)return;E.current=c,delete c.Icon.Default.prototype._getIconUrl,c.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});const N=c.map(f.current).setView([21.0285,105.8542],15);c.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(N),g.current=N,N.on("zoomstart",_=>{_.sourceTarget._animatingZoom||(q.current=!0)}),N.on("movestart",_=>{_.sourceTarget._animatingZoom||(q.current=!0)}),N.on("dragstart",()=>{q.current=!0}),N.on("zoomend",()=>{const _=N.getZoom();_!==ae.current&&(ae.current=_,re.current&&re.current())}),N.whenReady(()=>{setTimeout(()=>{re.current&&re.current()},200)})}),()=>{g.current&&(g.current.remove(),g.current=null),E.current=null,f.current&&delete f.current._leaflet_id}},[]),l.useEffect(()=>{!g.current||!E.current||Ne()},[Ne]),l.useEffect(()=>{!g.current||!E.current||j()},[j]),l.useEffect(()=>{if(!g.current||!E.current||!d||!te||te.areas.length===0)return;const R=ws(te);if(R.length===0)return;const c=Ls(R);c&&setTimeout(()=>{g.current&&g.current.setView(c,14,{animate:!0,duration:.8})},300)},[te,d]),l.useEffect(()=>{if(!g.current||!E.current)return;const R=E.current;if(q.current=!1,w.current&&(g.current.removeLayer(w.current),w.current=null),i&&i.trim()){const c=hs(i);if(c){const N=R.polygon(c.polygon,{color:"#dc2626",weight:0,opacity:0,fillColor:"#dc2626",fillOpacity:.3,smoothFactor:1,interactive:!1}).addTo(g.current);if(w.current=N,fe.current!==i&&!q.current){const _=R.latLngBounds(c.bounds);g.current.fitBounds(_,{padding:[50,50],animate:!0,duration:.8,maxZoom:16}),fe.current=i,J.current=m||""}return}}if(m&&_n[m]){const c=_n[m],N=R.polygon(c.polygon,{color:"#005cb6",weight:0,opacity:0,fillColor:"#005cb6",fillOpacity:.3,smoothFactor:1,interactive:!1}).addTo(g.current);w.current=N;const x=J.current!==m,_=fe.current!==i;if(!q.current){if(i){if(_||x){const k=R.latLngBounds(c.bounds);g.current.fitBounds(k,{padding:[50,50],animate:!0,duration:.8})}}else if(x){const k=R.latLngBounds(c.bounds);g.current.fitBounds(k,{padding:[50,50],animate:!0,duration:.8})}}J.current=m,fe.current=i||""}},[a,m,i]),l.useEffect(()=>{!g.current||!E.current||(u&&!de.current&&(g.current.setView([21.0285,105.8542],15,{animate:!0,duration:.8}),q.current=!1),de.current=u)},[u]),l.useEffect(()=>{const R=setTimeout(()=>{if(!g.current||!E.current)return;const c=a!==ne.current,N=i!==se.current;if(!(!c&&!N)){if(i&&N){const _=(r.length>0?r:Z).filter(D=>D.lat&&D.lng&&D.lat!==0&&D.lng!==0);if(_.length>0){const D=_.reduce((F,$)=>F+($.lat||0),0)/_.length,k=_.reduce((F,$)=>F+($.lng||0),0)/_.length,K=[D,k];g.current&&g.current.setView(K,15,{animate:!0,duration:.8});return}ha(i).then(D=>{let k=null,K=null;if(D&&D.center_lat&&D.center_lng){if(k=[D.center_lat,D.center_lng],D.bounds&&Array.isArray(D.bounds)&&D.bounds.length===2){const[[F,$],[ce,Ee]]=D.bounds;K=E.current.latLngBounds([F,$],[ce,Ee])}}else{const F=r.length>0?r:Z;if(F.length>0){const $=F.filter(ce=>ce.lat&&ce.lng&&ce.lat!==0&&ce.lng!==0);if($.length>0){const ce=$.reduce((je,Ce)=>je+(Ce.lat||0),0)/$.length,Ee=$.reduce((je,Ce)=>je+(Ce.lng||0),0)/$.length;k=[ce,Ee]}}}k&&g.current&&(K?g.current.fitBounds(K,{padding:[50,50],animate:!0,duration:.8}):g.current.setView(k,15,{animate:!0,duration:.8}))}).catch(D=>{const k=r.length>0?r:Z;if(k.length>0&&g.current){const K=k.filter(F=>F.lat&&F.lng&&F.lat!==0&&F.lng!==0);if(K.length>0){const F=K.reduce((ce,Ee)=>ce+(Ee.lat||0),0)/K.length,$=K.reduce((ce,Ee)=>ce+(Ee.lng||0),0)/K.length;g.current.setView([F,$],15,{animate:!0,duration:.8})}}})}else if(a&&c&&!i){const _=(r.length>0?r:Z).filter(D=>D.lat&&D.lng&&D.lat!==0&&D.lng!==0);if(_.length>0){const D=_.reduce((F,$)=>F+($.lat||0),0)/_.length,k=_.reduce((F,$)=>F+($.lng||0),0)/_.length,K=[D,k];g.current&&g.current.setView(K,12,{animate:!0,duration:.8});return}Na(a).then(D=>{let k=null,K=null;if(D&&D.center_lat&&D.center_lng){if(k=[D.center_lat,D.center_lng],D.bounds&&Array.isArray(D.bounds)&&D.bounds.length===2){const[[F,$],[ce,Ee]]=D.bounds;K=E.current.latLngBounds([F,$],[ce,Ee])}}else{const F=r.length>0?r:Z;if(F.length>0){const $=F.filter(ce=>ce.lat&&ce.lng&&ce.lat!==0&&ce.lng!==0);if($.length>0){const ce=$.reduce((je,Ce)=>je+(Ce.lat||0),0)/$.length,Ee=$.reduce((je,Ce)=>je+(Ce.lng||0),0)/$.length;k=[ce,Ee]}}}k&&g.current&&(K?g.current.fitBounds(K,{padding:[50,50],animate:!0,duration:.8}):g.current.setView(k,11,{animate:!0,duration:.8}))}).catch(D=>{const k=r.length>0?r:Z;if(k.length>0&&g.current){const K=k.filter(F=>F.lat&&F.lng&&F.lat!==0&&F.lng!==0);if(K.length>0){const F=K.reduce((ce,Ee)=>ce+(Ee.lat||0),0)/K.length,$=K.reduce((ce,Ee)=>ce+(Ee.lng||0),0)/K.length;g.current.setView([F,$],11,{animate:!0,duration:.8})}}})}ne.current=a,se.current=i}},300);return()=>clearTimeout(R)},[a,i,r.length,Z.length]),e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{ref:f,className:Dn.map},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LeafletMap.tsx",lineNumber:773,columnNumber:7},this),d&&!u&&e.jsxDEV(js,{mapInstance:g.current,leafletRef:E.current,departmentMapData:te,isLoading:Te,error:A,markersRef:Q,wardBoundariesLayerRef:z},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LeafletMap.tsx",lineNumber:776,columnNumber:9},this),b&&e.jsxDEV("button",{onClick:b,className:Dn.fullscreenButton,"aria-label":"Fullscreen",children:e.jsxDEV("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsxDEV("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LeafletMap.tsx",lineNumber:793,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LeafletMap.tsx",lineNumber:792,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LeafletMap.tsx",lineNumber:787,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LeafletMap.tsx",lineNumber:772,columnNumber:5},this)}const Wt=l.memo(Ms),Qs="_overlay_18orh_11",Cs="_overlayDisabled_18orh_37",Ss="_modal_18orh_57",Is="_closeBtn_18orh_109",ks="_header_18orh_169",Ps="_headerBadge_18orh_183",As="_headerTitleRow_18orh_207",Bs="_headerTitle_18orh_207",Rs="_headerMeta_18orh_243",Os="_metaId_18orh_261",zs="_metaDivider_18orh_273",Fs="_metaCategory_18orh_281",$s="_metaRating_18orh_289",qs="_content_18orh_299",Us="_twoColumnGrid_18orh_465",Ws="_leftColumn_18orh_477",Gs="_rightColumn_18orh_479",Ks="_card_18orh_493",Zs="_cardHeader_18orh_511",Ys="_chevron_18orh_543",Xs="_cardTitle_18orh_555",Js="_cardBody_18orh_571",ei="_infoGrid_18orh_609",ti="_infoItem_18orh_621",ni="_infoLabel_18orh_633",ai="_infoValue_18orh_651",si="_ratingBadge_18orh_667",ii="_addressFull_18orh_685",oi="_contactLabel_18orh_779",li="_contactValue_18orh_797",ri="_timeline_18orh_813",ci="_timelineItem_18orh_825",mi="_timelineDot_18orh_857",pi="_timelineContent_18orh_875",di="_timelineTitle_18orh_885",ui="_timelineDate_18orh_901",fi="_timelineMeta_18orh_917",hi="_timelineResult_18orh_945",Ni="_alertCard_18orh_1057",vi="_alertIcon_18orh_1077",Vi="_alertContent_18orh_1101",bi="_alertTitle_18orh_1109",gi="_alertText_18orh_1125",xi="_reportCount_18orh_1521",Ti="_citizenReportsContainer_18orh_1555",Ei="_reportItem_18orh_1567",Hi="_reportHeader_18orh_1593",Di="_reportMeta_18orh_1609",_i="_reporterName_18orh_1629",yi="_reportDivider_18orh_1639",Li="_reportDate_18orh_1647",wi="_violationBadge_18orh_1655",ji="_reportContent_18orh_1685",Mi="_reportMedia_18orh_1701",Qi="_reportMediaHeader_18orh_1713",Ci="_reportImageGrid_18orh_1735",Si="_reportImageWrapper_18orh_1747",Ii="_reportImage_18orh_1735",ki="_compactStats_18orh_2045",Pi="_compactStatItem_18orh_2059",Ai="_clickableStatItem_18orh_2091",Bi="_staffModalOverlay_18orh_2113",Ri="_staffModalHeader_18orh_2143",Oi="_staffModalTitle_18orh_2161",zi="_staffModalClose_18orh_2181",Fi="_staffModalBody_18orh_2219",$i="_staffGrid_18orh_2231",qi="_staffCard_18orh_2243",Ui="_staffAvatar_18orh_2271",Wi="_staffInfo_18orh_2295",Gi="_staffName_18orh_2303",Ki="_staffRole_18orh_2319",Zi="_staffDetailItem_18orh_2339",Yi="_noStaffMessage_18orh_2365",Xi="_addressCompact_18orh_2387",Ji="_addressSep_18orh_2413",eo="_gpsCoords_18orh_2421",to="_contactCompact_18orh_2437",no="_contactRow_18orh_2449",ao="_resultCompact_18orh_2503",so="_resultRow_18orh_2515",io="_selectTrigger_18orh_2549",oo="_selectContent_18orh_2559",lo="_certCompact_18orh_2611",ro="_certItem_18orh_2623",co="_certItemHeader_18orh_2637",mo="_certIconSmall_18orh_2651",po="_certTitleSmall_18orh_2671",uo="_certNumber_18orh_2687",fo="_certStatusBadge_18orh_2701",ho="_certMeta_18orh_2719",No="_legalCompact_18orh_2735",vo="_legalItemCompact_18orh_2747",Vo="_legalTitleCompact_18orh_2765",bo="_legalMetaCompact_18orh_2781",go="_noDataCompact_18orh_2795",p={overlay:Qs,overlayDisabled:Cs,modal:Ss,closeBtn:Is,header:ks,headerBadge:Ps,headerTitleRow:As,headerTitle:Bs,headerMeta:Rs,metaId:Os,metaDivider:zs,metaCategory:Fs,metaRating:$s,content:qs,twoColumnGrid:Us,leftColumn:Ws,rightColumn:Gs,card:Ks,cardHeader:Zs,chevron:Ys,cardTitle:Xs,cardBody:Js,infoGrid:ei,infoItem:ti,infoLabel:ni,infoValue:ai,ratingBadge:si,addressFull:ii,contactLabel:oi,contactValue:li,timeline:ri,timelineItem:ci,timelineDot:mi,timelineContent:pi,timelineTitle:di,timelineDate:ui,timelineMeta:fi,timelineResult:hi,alertCard:Ni,alertIcon:vi,alertContent:Vi,alertTitle:bi,alertText:gi,reportCount:xi,citizenReportsContainer:Ti,reportItem:Ei,reportHeader:Hi,reportMeta:Di,reporterName:_i,reportDivider:yi,reportDate:Li,violationBadge:wi,reportContent:ji,reportMedia:Mi,reportMediaHeader:Qi,reportImageGrid:Ci,reportImageWrapper:Si,reportImage:Ii,compactStats:ki,compactStatItem:Pi,clickableStatItem:Ai,staffModalOverlay:Bi,staffModalHeader:Ri,staffModalTitle:Oi,staffModalClose:zi,staffModalBody:Fi,staffGrid:$i,staffCard:qi,staffAvatar:Ui,staffInfo:Wi,staffName:Gi,staffRole:Ki,staffDetailItem:Zi,noStaffMessage:Yi,addressCompact:Xi,addressSep:Ji,gpsCoords:eo,contactCompact:to,contactRow:no,resultCompact:ao,resultRow:so,selectTrigger:io,selectContent:oo,certCompact:lo,certItem:ro,certItemHeader:co,certIconSmall:mo,certTitleSmall:po,certNumber:uo,certStatusBadge:fo,certMeta:ho,legalCompact:No,legalItemCompact:vo,legalTitleCompact:Vo,legalMetaCompact:bo,noDataCompact:go},xo="_overlay_1sdy5_6",To="_container_1sdy5_23",Eo="_closeBtn_1sdy5_40",Ho="_imageWrapper_1sdy5_65",Do="_image_1sdy5_65",_o="_navBtn_1sdy5_82",yo="_navBtnPrev_1sdy5_105",Lo="_navBtnNext_1sdy5_109",wo="_counter_1sdy5_129",jo="_thumbnails_1sdy5_146",Mo="_thumbnail_1sdy5_146",Qo="_thumbnailActive_1sdy5_198",_e={overlay:xo,container:To,closeBtn:Eo,imageWrapper:Ho,image:Do,navBtn:_o,navBtnPrev:yo,navBtnNext:Lo,counter:wo,thumbnails:jo,thumbnail:Mo,thumbnailActive:Qo};function kn({images:t,currentIndex:s,isOpen:n,onClose:o,onNext:a,onPrev:m}){if(l.useEffect(()=>{const d=u=>{u.key==="Escape"&&n&&o()};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[n,o]),l.useEffect(()=>{const d=u=>{n&&(u.key==="ArrowLeft"?m():u.key==="ArrowRight"&&a())};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[n,a,m]),l.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]),!n||!t||t.length===0)return null;const i=t[s],r=t.length>1;return pa.createPortal(e.jsxDEV("div",{className:_e.overlay,onClick:o,children:e.jsxDEV("div",{className:_e.container,onClick:d=>d.stopPropagation(),children:[e.jsxDEV("button",{className:_e.closeBtn,onClick:o,"aria-label":"ƒê√≥ng",children:e.jsxDEV(ge,{size:24},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:73,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:72,columnNumber:9},this),r&&e.jsxDEV("button",{className:`${_e.navBtn} ${_e.navBtnPrev}`,onClick:m,"aria-label":"·∫¢nh tr∆∞·ªõc",children:e.jsxDEV(Qa,{size:32},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:83,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:78,columnNumber:11},this),e.jsxDEV("div",{className:_e.imageWrapper,children:e.jsxDEV("img",{src:i,alt:`·∫¢nh ƒë√°nh gi√° ${s+1}`,className:_e.image},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:89,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:88,columnNumber:9},this),r&&e.jsxDEV("button",{className:`${_e.navBtn} ${_e.navBtnNext}`,onClick:a,"aria-label":"·∫¢nh ti·∫øp theo",children:e.jsxDEV(Ca,{size:32},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:103,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:98,columnNumber:11},this),r&&e.jsxDEV("div",{className:_e.counter,children:[s+1," / ",t.length]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:109,columnNumber:11},this),r&&t.length<=10&&e.jsxDEV("div",{className:_e.thumbnails,children:t.map((d,u)=>e.jsxDEV("button",{className:`${_e.thumbnail} ${u===s?_e.thumbnailActive:""}`,onClick:()=>{const h=u-s;if(h>0)for(let v=0;v<h;v++)a();else if(h<0)for(let v=0;v<Math.abs(h);v++)m()},children:e.jsxDEV("img",{src:d,alt:`Thumbnail ${u+1}`},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:130,columnNumber:17},this)},u,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:118,columnNumber:15},this))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:116,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:70,columnNumber:7},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ImageLightbox.tsx",lineNumber:69,columnNumber:5},this),document.body)}const Co=[{id:"ve-sinh",label:"V·ªá sinh c∆° s·ªü",defaultStatus:"pending",options:[{value:"passed",label:"ƒê·∫°t"},{value:"failed",label:"Ch∆∞a ƒë·∫°t"},{value:"pending",label:"Ch∆∞a ki·ªÉm tra"}]},{id:"giay-phep-kd",label:"Gi·∫•y ph√©p KD",defaultStatus:"passed",options:[{value:"passed",label:"H·ª£p l·ªá"},{value:"failed",label:"Kh√¥ng h·ª£p l·ªá"},{value:"pending",label:"Ch∆∞a ki·ªÉm tra"}]},{id:"an-toan-thuc-pham",label:"An to√†n th·ª±c ph·∫©m",defaultStatus:"passed",options:[{value:"passed",label:"T·ªët"},{value:"failed",label:"C·∫£nh b√°o"},{value:"pending",label:"Ch∆∞a ki·ªÉm tra"}]},{id:"dao-tao-nv",label:"ƒê√†o t·∫°o NV",defaultStatus:"passed",options:[{value:"passed",label:"ƒê·∫ßy ƒë·ªß"},{value:"failed",label:"Thi·∫øu"},{value:"pending",label:"Ch∆∞a ki·ªÉm tra"}]}];function So(t){switch(t){case"certified":return"#22c55e";case"hotspot":return"#ef4444";case"scheduled":return"#eab308";case"inspected":return"#005cb6";default:return"#005cb6"}}function Io(t){switch(t){case"certified":return"Ch·ª©ng nh·∫≠n ATTP";case"hotspot":return"ƒêi·ªÉm n√≥ng";case"scheduled":return"K·∫ø ho·∫°ch ki·ªÉm tra";case"inspected":return"ƒê√£ ki·ªÉm tra";default:return t}}function ko(t){switch(t){case"certified":return{text:"ƒê·∫°t chu·∫©n ATTP",bg:"#dcfce7",color:"#166534",icon:e.jsxDEV(gt,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:104,columnNumber:79},this)};case"hotspot":return{text:"C·∫£nh b√°o ƒëi·ªÉm n√≥ng",bg:"#fee2e2",color:"#991b1b",icon:e.jsxDEV(Ue,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:106,columnNumber:83},this)};case"scheduled":return{text:"Theo d√µi ƒë·ªãnh k·ª≥",bg:"#fef3c7",color:"#92400e",icon:e.jsxDEV(Ra,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:108,columnNumber:81},this)};case"inspected":return{text:"ƒê√£ ki·ªÉm tra g·∫ßn ƒë√¢y",bg:"#dbeafe",color:"#1e40af",icon:e.jsxDEV(rt,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:110,columnNumber:84},this)};default:return{text:"ƒêang ho·∫°t ƒë·ªông",bg:"#f3f4f6",color:"#374151",icon:e.jsxDEV(Ba,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:112,columnNumber:79},this)}}}function Po({point:t,isOpen:s,onClose:n}){var Ne,j,y,W,R;const o=st(),{currentMerchant:a,inspectionHistory:m,licenses:i,isLoading:r,isHistoryLoading:d,isLicensesLoading:u}=Qe(c=>c.merchant);l.useEffect(()=>(s&&(t!=null&&t.id)&&(o(va({merchantId:t.id})),o(Va(t.id)),o(ba(t.id))),()=>{s||o(ga())}),[s,t==null?void 0:t.id,o]);const h=l.useRef(!1),v=l.useRef(0);l.useEffect(()=>{if(s){h.current=!0,v.current=Date.now();const c=setTimeout(()=>{h.current=!1},500);return()=>clearTimeout(c)}else h.current=!1,v.current=0},[s]);const[H,b]=l.useState({business:!1,address:!1,contact:!1,results:!1,timeline:!1,certificates:!1,legal:!1,citizenReports:!1}),[f,g]=l.useState([]),[E,V]=l.useState(0),[Q,C]=l.useState(!1),[w,z]=l.useState(!1);l.useEffect(()=>{s||z(!1)},[s]);const[U,J]=l.useState({}),[fe,ae]=l.useState(!1),[q,X]=l.useState({open:!1,documentTypeId:null,newStatus:null,docTypeLabel:""});l.useEffect(()=>{if(!s||!(t!=null&&t.id)){J({});return}(async()=>{ae(!0),console.log("üîÑ Loading inspection results for merchant:",t.id);try{const N=await ya(t.id);if(console.log("üì• Received results from API:",{count:N.length,results:N}),N&&N.length>0){console.log("üì• PointDetailModal: Received results from API",{count:N.length,results:N});const x={};N.forEach((_,D)=>{console.log(`üîç Processing result ${D+1}/${N.length}:`,{result:_,document_type_id:_.document_type_id,document_type_name:_.document_type_name,_id:_._id,status:_.status,hasDocumentTypeId:!!_.document_type_id,hasId:!!_._id,hasStatus:!!_.status}),_.document_type_id&&_._id&&_.status?(x[_.document_type_id]={_id:_._id,document_type_id:_.document_type_id,document_type_name:_.document_type_name||_.document_type_id,status:_.status},console.log("‚úÖ Loaded result into state",{document_type_id:_.document_type_id,_id:_._id,document_type_name:_.document_type_name,status:_.status})):console.warn("‚ö†Ô∏è Result missing required fields - SKIPPED",{result:_,missing:{document_type_id:!_.document_type_id,_id:!_._id,status:!_.status}})}),console.log("üìã Final document results state:",{count:Object.keys(x).length,keys:Object.keys(x),results:x}),J(x)}else console.warn("‚ö†Ô∏è No results returned from API",{results:N}),J({})}catch(N){console.error("‚ùå Failed to load inspection results:",N),J({})}finally{ae(!1)}})()},[s,t==null?void 0:t.id]);const re=c=>{switch(c){case"passed":return 1;case"failed":return 0;case"pending":return 2;default:return 2}},de=(c,N)=>{const x=U[c];(x==null?void 0:x.status)!==N&&X({open:!0,documentTypeId:c,newStatus:N,docTypeLabel:(x==null?void 0:x.document_type_name)||"Gi·∫•y t·ªù"})},ne=async()=>{if(console.log("üîµ handleConfirmStatusUpdate called",{confirmDialog:q,documentResults:U}),!q.documentTypeId||!q.newStatus){console.warn("‚ö†Ô∏è Missing documentTypeId or newStatus",{documentTypeId:q.documentTypeId,newStatus:q.newStatus});return}const{documentTypeId:c,newStatus:N}=q,x=U[c];if(console.log("üîµ Preparing to update",{documentTypeId:c,newStatus:N,currentResult:x,allResults:U}),!x||!x._id){console.warn("‚ö†Ô∏è No result found for documentTypeId:",c),$e.error("Kh√¥ng t√¨m th·∫•y b·∫£n ghi ƒë·ªÉ c·∫≠p nh·∫≠t. Vui l√≤ng th·ª≠ l·∫°i."),X({open:!1,documentTypeId:null,newStatus:null,docTypeLabel:""});return}try{const _=re(N);console.log("üîµ Status mapping (text to int)",{newStatus:N,statusNumber:_,statusType:typeof _,resultId:x._id,url:`${We}/map_inspection_checklist_results?_id=eq.${x._id}`});const D=await La(x._id,_);console.log("üîµ API response",D),D.success?(J(k=>({...k,[c]:{...k[c],status:N}})),$e.success(`ƒê√£ c·∫≠p nh·∫≠t tr·∫°ng th√°i ${q.docTypeLabel} th√†nh c√¥ng`)):$e.error(D.error||"C·∫≠p nh·∫≠t th·∫•t b·∫°i")}catch(_){console.error("‚ùå Failed to update status:",_),$e.error("C√≥ l·ªói x·∫£y ra khi c·∫≠p nh·∫≠t tr·∫°ng th√°i")}finally{X({open:!1,documentTypeId:null,newStatus:null,docTypeLabel:""})}},se=(c,N)=>{switch(c){case"passed":return e.jsxDEV(gt,{size:14,style:{color:"#16a34a"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:448,columnNumber:16},this);case"failed":return e.jsxDEV(ge,{size:14,style:{color:"#dc2626"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:450,columnNumber:16},this);case"pending":return e.jsxDEV(Ue,{size:14,style:{color:"#eab308"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:452,columnNumber:16},this);default:return e.jsxDEV(gt,{size:14,style:{color:"#16a34a"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:454,columnNumber:16},this)}},pe=(c,N)=>{g(c),V(N),C(!0)},xe=()=>{C(!1)},S=()=>{V(c=>(c+1)%f.length)},G=()=>{V(c=>(c-1+f.length)%f.length)},Y=c=>{b(N=>({...N,[c]:!N[c]}))};if(l.useEffect(()=>{const c=N=>{N.key==="Escape"&&s&&n()};return document.addEventListener("keydown",c),()=>document.removeEventListener("keydown",c)},[s,n]),l.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[s]),!s||!t)return null;So(t.category);const Te=ko(t.category),A={name:(a==null?void 0:a.business_name)||t.name,taxCode:(a==null?void 0:a.tax_code)||t.taxCode||"N/A",businessType:(a==null?void 0:a.business_type)||t.type||"N/A",license:((j=(Ne=a==null?void 0:a.merchant_licenses)==null?void 0:Ne[0])==null?void 0:j.license_number)||t.taxCode||"N/A",owner:(a==null?void 0:a.owner_name)||"N/A",phone:(a==null?void 0:a.owner_phone)||t.hotline||"N/A",email:(a==null?void 0:a.email)||"N/A",address:(a==null?void 0:a.address)||t.address,ward:(a==null?void 0:a.ward)||t.ward,district:(a==null?void 0:a.district)||t.district,province:(a==null?void 0:a.province)||t.province,establishedDate:a!=null&&a.created_at?new Date(a.created_at):null,employees:((y=a==null?void 0:a.merchant_staff)==null?void 0:y.length)||(a==null?void 0:a.employee_count)||0,capacity:(a==null?void 0:a.capacity)||0,inspectionCount:(a==null?void 0:a.inspection_count)||0,violationCount:(a==null?void 0:a.violation_count)||0,rating:(a==null?void 0:a.rating)||(t.category==="certified"?"A":t.category==="hotspot"?"C":"B"),lastInspectionDate:a!=null&&a.last_inspection_date?new Date(a.last_inspection_date):null,nextInspectionDate:a!=null&&a.next_inspection_date?new Date(a.next_inspection_date):null,attpCertificateNumber:(a==null?void 0:a.attp_certificate_number)||`CN-ATTP ${Math.floor(1e3+(((W=t==null?void 0:t.id)==null?void 0:W.charCodeAt(0))||0)%9e3)}/${new Date().getFullYear()}`},ie=(c,N)=>{const x=(c==null?void 0:c.toLowerCase())||"";if(x==="c√≤n hi·ªáu l·ª±c")return{text:"C√≤n hi·ªáu l·ª±c",bg:N?"#dcfce7":"#dbeafe",color:N?"#166534":"#1e40af"};switch(x){case"valid":case"active":return{text:"C√≤n hi·ªáu l·ª±c",bg:N?"#dcfce7":"#dbeafe",color:N?"#166534":"#1e40af"};case"expiring":return{text:"S·∫Øp h·∫øt h·∫°n",bg:"#fef3c7",color:"#92400e"};case"expired":return{text:"H·∫øt hi·ªáu l·ª±c",bg:"#fee2e2",color:"#991b1b"};case"revoked":return{text:"B·ªã thu h·ªìi",bg:"#f3f4f6",color:"#374151"};default:return{text:c||"N/A",bg:"#f3f4f6",color:"#374151"}}},te=c=>{const N=Date.now()-v.current;if(h.current||N<500)return;const x=c.target;x.tagName==="BUTTON"||x.closest("button")||x.closest("a")||x.closest('[role="button"]')||c.target===c.currentTarget&&n()},Z=h.current?`${p.overlay} ${p.overlayDisabled}`:p.overlay;return e.jsxDEV("div",{className:Z,onClick:te,style:h.current?{pointerEvents:"auto"}:void 0,children:[e.jsxDEV("div",{className:p.modal,onClick:c=>c.stopPropagation(),children:[e.jsxDEV("button",{className:p.closeBtn,onClick:n,"aria-label":"ƒê√≥ng",children:e.jsxDEV(ge,{size:18},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:623,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:622,columnNumber:9},this),w&&e.jsxDEV("div",{className:p.staffModalOverlay,children:[e.jsxDEV("div",{className:p.staffModalHeader,children:[e.jsxDEV("div",{className:p.staffModalTitle,children:[e.jsxDEV(we,{size:20},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:631,columnNumber:17},this),e.jsxDEV("span",{children:["Danh s√°ch nh√¢n vi√™n (",((R=a==null?void 0:a.merchant_staff)==null?void 0:R.length)||0,")"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:632,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:630,columnNumber:15},this),e.jsxDEV("button",{className:p.staffModalClose,onClick:()=>z(!1),title:"Quay l·∫°i",children:e.jsxDEV(ge,{size:18},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:639,columnNumber:17},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:634,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:629,columnNumber:13},this),e.jsxDEV("div",{className:p.staffModalBody,children:a!=null&&a.merchant_staff&&a.merchant_staff.length>0?e.jsxDEV("div",{className:p.staffGrid,children:a.merchant_staff.map((c,N)=>e.jsxDEV("div",{className:p.staffCard,children:[e.jsxDEV("div",{className:p.staffAvatar,children:e.jsxDEV(et,{size:24},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:648,columnNumber:25},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:647,columnNumber:23},this),e.jsxDEV("div",{className:p.staffInfo,children:[e.jsxDEV("div",{className:p.staffName,children:c.full_name||c.name||"N/A"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:651,columnNumber:25},this),e.jsxDEV("div",{className:p.staffRole,children:c.position||c.role||"Nh√¢n vi√™n"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:652,columnNumber:25},this),e.jsxDEV("div",{className:p.staffDetailItem,children:[e.jsxDEV(tt,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:655,columnNumber:27},this),e.jsxDEV("span",{children:c.phone_number||c.phone||"N/A"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:656,columnNumber:27},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:654,columnNumber:25},this),e.jsxDEV("div",{className:p.staffDetailItem,children:[e.jsxDEV(bt,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:660,columnNumber:27},this),e.jsxDEV("span",{children:c.email||"N/A"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:661,columnNumber:27},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:659,columnNumber:25},this),c.staff_code&&e.jsxDEV("div",{className:p.staffDetailItem,children:[e.jsxDEV(Sa,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:666,columnNumber:29},this),e.jsxDEV("span",{children:["M√£ Nh√¢n vi√™n: ",c.staff_code]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:667,columnNumber:29},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:665,columnNumber:27},this),c.citizen_id&&e.jsxDEV("div",{className:p.staffDetailItem,children:[e.jsxDEV(Oe,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:673,columnNumber:29},this),e.jsxDEV("span",{children:["CCCD: ",c.citizen_id]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:674,columnNumber:29},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:672,columnNumber:27},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:650,columnNumber:23},this)]},c._id||N,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:646,columnNumber:21},this))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:644,columnNumber:17},this):e.jsxDEV("div",{className:p.noStaffMessage,children:[e.jsxDEV(we,{size:48,strokeWidth:1},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:683,columnNumber:19},this),e.jsxDEV("p",{children:"Kh√¥ng c√≥ d·ªØ li·ªáu nh√¢n vi√™n"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:684,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:682,columnNumber:17},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:642,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:628,columnNumber:11},this),e.jsxDEV("div",{className:p.header,children:[e.jsxDEV("div",{className:p.headerBadge,style:{background:Te.bg,color:Te.color},children:[Te.icon,e.jsxDEV("span",{children:Te.text},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:695,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:693,columnNumber:11},this),e.jsxDEV("div",{className:p.headerTitleRow,children:[e.jsxDEV("h1",{className:p.headerTitle,children:A.name},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:698,columnNumber:13},this),e.jsxDEV("div",{className:p.compactStats,children:[e.jsxDEV("div",{className:`${p.compactStatItem} ${p.clickableStatItem}`,onClick:()=>z(!0),title:"Xem danh s√°ch nh√¢n vi√™n",children:[e.jsxDEV(we,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:706,columnNumber:17},this),e.jsxDEV("span",{children:[A.employees," Nh√¢n vi√™n"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:707,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:701,columnNumber:15},this),e.jsxDEV("div",{className:p.compactStatItem,children:[e.jsxDEV(Qn,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:710,columnNumber:17},this),e.jsxDEV("span",{children:[A.capacity," ch·ªó"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:711,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:709,columnNumber:15},this),e.jsxDEV("div",{className:p.compactStatItem,children:[e.jsxDEV(rt,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:714,columnNumber:17},this),e.jsxDEV("span",{children:[A.inspectionCount," L·∫ßn ki·ªÉm tra"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:715,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:713,columnNumber:15},this),e.jsxDEV("div",{className:p.compactStatItem,style:{color:A.violationCount>2?"#dc2626":A.violationCount>0?"#eab308":"#16a34a"},children:[e.jsxDEV(Ue,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:720,columnNumber:17},this),e.jsxDEV("span",{children:[A.violationCount," Vi ph·∫°m"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:721,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:717,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:700,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:697,columnNumber:11},this),e.jsxDEV("div",{className:p.headerMeta,children:[e.jsxDEV("span",{className:p.metaId,children:["MST: ",A.taxCode]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:726,columnNumber:13},this),e.jsxDEV("span",{className:p.metaDivider,children:"‚Ä¢"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:727,columnNumber:13},this),e.jsxDEV("span",{className:p.metaCategory,children:Io(t.category)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:728,columnNumber:13},this),e.jsxDEV("span",{className:p.metaDivider,children:"‚Ä¢"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:729,columnNumber:13},this),e.jsxDEV("span",{className:p.metaRating,children:["X·∫øp lo·∫°i: ",A.rating]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:730,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:725,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:692,columnNumber:9},this),e.jsxDEV("div",{className:p.content,children:[r&&e.jsxDEV("div",{className:"flex items-center justify-center py-4 text-sm text-muted-foreground",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary mr-2"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:738,columnNumber:15},this),"ƒêang c·∫≠p nh·∫≠t d·ªØ li·ªáu m·ªõi nh·∫•t..."]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:737,columnNumber:13},this),t.category==="hotspot"&&e.jsxDEV("div",{className:p.alertCard,children:[e.jsxDEV("div",{className:p.alertIcon,children:e.jsxDEV(Ue,{size:20},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:746,columnNumber:17},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:745,columnNumber:15},this),e.jsxDEV("div",{className:p.alertContent,children:[e.jsxDEV("div",{className:p.alertTitle,children:"C·∫£nh b√°o ƒëi·ªÉm n√≥ng ATTP"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:749,columnNumber:17},this),e.jsxDEV("div",{className:p.alertText,children:["C∆° s·ªü n√†y ƒë√£ ƒë∆∞·ª£c x√°c ƒë·ªãnh l√† ƒëi·ªÉm n√≥ng v·ªÅ an to√†n th·ª±c ph·∫©m. Ph√°t hi·ªán ",A.violationCount," vi ph·∫°m trong l·∫ßn ki·ªÉm tra g·∫ßn nh·∫•t. C·∫ßn ti·∫øn h√†nh ki·ªÉm tra v√† gi√°m s√°t ch·∫∑t ch·∫Ω."]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:750,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:748,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:744,columnNumber:13},this),e.jsxDEV("div",{className:p.twoColumnGrid,children:[e.jsxDEV("div",{className:p.leftColumn,children:[e.jsxDEV("div",{className:p.card,children:[e.jsxDEV("div",{className:p.cardHeader,onClick:()=>Y("business"),style:{cursor:"pointer"},children:[e.jsxDEV(Pe,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:770,columnNumber:19},this),e.jsxDEV("h3",{className:p.cardTitle,children:"Th√¥ng tin c∆° s·ªü"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:771,columnNumber:19},this),e.jsxDEV(ke,{size:16,className:p.chevron,style:{transform:H.business?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.2s"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:772,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:765,columnNumber:17},this),!H.business&&e.jsxDEV("div",{className:p.cardBody,children:e.jsxDEV("div",{className:p.infoGrid,children:[e.jsxDEV("div",{className:p.infoItem,children:[e.jsxDEV("div",{className:p.infoLabel,children:"Lo·∫°i h√¨nh"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:785,columnNumber:25},this),e.jsxDEV("div",{className:p.infoValue,children:A.businessType},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:786,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:784,columnNumber:23},this),e.jsxDEV("div",{className:p.infoItem,children:[e.jsxDEV("div",{className:p.infoLabel,children:"Gi·∫•y ph√©p"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:790,columnNumber:25},this),e.jsxDEV("div",{className:p.infoValue,children:A.license},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:791,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:789,columnNumber:23},this),e.jsxDEV("div",{className:p.infoItem,children:[e.jsxDEV("div",{className:p.infoLabel,children:"Ng√†y th√†nh l·∫≠p"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:795,columnNumber:25},this),e.jsxDEV("div",{className:p.infoValue,children:A.establishedDate?A.establishedDate.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:796,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:794,columnNumber:23},this),e.jsxDEV("div",{className:p.infoItem,children:[e.jsxDEV("div",{className:p.infoLabel,children:"X·∫øp lo·∫°i ATTP"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:806,columnNumber:25},this),e.jsxDEV("div",{className:p.infoValue,children:e.jsxDEV("span",{className:p.ratingBadge,style:{background:A.rating==="A"?"#dcfce7":A.rating==="C"?"#fee2e2":"#fef3c7",color:A.rating==="A"?"#166534":A.rating==="C"?"#991b1b":"#92400e"},children:A.rating},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:808,columnNumber:27},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:807,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:805,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:783,columnNumber:21},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:782,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:764,columnNumber:15},this),e.jsxDEV("div",{className:p.card,children:[e.jsxDEV("div",{className:p.cardHeader,onClick:()=>Y("address"),style:{cursor:"pointer"},children:[e.jsxDEV(De,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:828,columnNumber:19},this),e.jsxDEV("h3",{className:p.cardTitle,children:"ƒê·ªãa ch·ªâ"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:829,columnNumber:19},this),e.jsxDEV(ke,{size:16,className:p.chevron,style:{transform:H.address?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.2s"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:830,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:823,columnNumber:17},this),!H.address&&e.jsxDEV("div",{className:p.cardBody,children:[e.jsxDEV("div",{className:p.addressFull,children:A.address},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:841,columnNumber:21},this),e.jsxDEV("div",{className:p.addressCompact,children:[A.ward&&e.jsxDEV("span",{children:A.ward},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:843,columnNumber:44},this),A.ward&&e.jsxDEV("span",{className:p.addressSep,children:"‚Ä¢"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:844,columnNumber:44},this),e.jsxDEV("span",{children:A.district},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:845,columnNumber:23},this),e.jsxDEV("span",{className:p.addressSep,children:"‚Ä¢"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:846,columnNumber:23},this),e.jsxDEV("span",{children:A.province},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:847,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:842,columnNumber:21},this),e.jsxDEV("div",{className:p.gpsCoords,children:["GPS: ",t.lat.toFixed(6),", ",t.lng.toFixed(6)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:849,columnNumber:21},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:840,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:822,columnNumber:15},this),e.jsxDEV("div",{className:p.card,children:[e.jsxDEV("div",{className:p.cardHeader,onClick:()=>Y("contact"),style:{cursor:"pointer"},children:[e.jsxDEV(tt,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:863,columnNumber:19},this),e.jsxDEV("h3",{className:p.cardTitle,children:"Li√™n h·ªá"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:864,columnNumber:19},this),e.jsxDEV(ke,{size:16,className:p.chevron,style:{transform:H.contact?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.2s"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:865,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:858,columnNumber:17},this),!H.contact&&e.jsxDEV("div",{className:p.cardBody,children:e.jsxDEV("div",{className:p.contactCompact,children:[e.jsxDEV("div",{className:p.contactRow,children:[e.jsxDEV(et,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:878,columnNumber:25},this),e.jsxDEV("span",{className:p.contactLabel,children:"ƒê·∫°i di·ªán:"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:879,columnNumber:25},this),e.jsxDEV("span",{className:p.contactValue,children:A.owner},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:880,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:877,columnNumber:23},this),e.jsxDEV("div",{className:p.contactRow,children:[e.jsxDEV(tt,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:883,columnNumber:25},this),e.jsxDEV("span",{className:p.contactLabel,children:"SƒêT:"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:884,columnNumber:25},this),e.jsxDEV("span",{className:p.contactValue,children:A.phone},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:885,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:882,columnNumber:23},this),e.jsxDEV("div",{className:p.contactRow,children:[e.jsxDEV(bt,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:888,columnNumber:25},this),e.jsxDEV("span",{className:p.contactLabel,children:"Email:"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:889,columnNumber:25},this),e.jsxDEV("span",{className:p.contactValue,children:A.email},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:890,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:887,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:876,columnNumber:21},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:875,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:857,columnNumber:15},this),e.jsxDEV("div",{className:p.card,children:[e.jsxDEV("div",{className:p.cardHeader,onClick:()=>Y("results"),style:{cursor:"pointer"},children:[e.jsxDEV(Oe,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:904,columnNumber:19},this),e.jsxDEV("h3",{className:p.cardTitle,children:"K·∫øt qu·∫£ ki·ªÉm tra"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:905,columnNumber:19},this),e.jsxDEV(ke,{size:16,className:p.chevron,style:{transform:H.results?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.2s"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:906,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:899,columnNumber:17},this),!H.results&&e.jsxDEV("div",{className:p.cardBody,children:e.jsxDEV("div",{className:p.resultCompact,children:fe?e.jsxDEV("div",{style:{padding:"20px",textAlign:"center",color:"var(--muted-foreground)"},children:"ƒêang t·∫£i d·ªØ li·ªáu..."},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:919,columnNumber:25},this):Object.keys(U).length===0?e.jsxDEV("div",{style:{padding:"20px",textAlign:"center",color:"var(--muted-foreground)"},children:"Ch∆∞a c√≥ d·ªØ li·ªáu k·∫øt qu·∫£ ki·ªÉm tra"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:923,columnNumber:25},this):Object.values(U).map(c=>{const N=c.status,x=Co.find(D=>D.label.toLowerCase().includes(c.document_type_name.toLowerCase())||c.document_type_name.toLowerCase().includes(D.label.toLowerCase())),_=(x==null?void 0:x.options)||[{value:"passed",label:"ƒê·∫°t"},{value:"failed",label:"Ch∆∞a ƒë·∫°t"},{value:"pending",label:"Ch∆∞a ki·ªÉm tra"}];return e.jsxDEV("div",{className:p.resultRow,children:[se(N,c.document_type_id),e.jsxDEV("span",{children:c.document_type_name},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:944,columnNumber:31},this),e.jsxDEV(ns,{value:N,onValueChange:D=>{de(c.document_type_id,D)},children:[e.jsxDEV(as,{className:p.selectTrigger,size:"sm",style:{width:120,marginLeft:"auto"},onClick:D=>D.stopPropagation(),children:e.jsxDEV(ss,{placeholder:"Ch·ªçn tr·∫°ng th√°i"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:957,columnNumber:35},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:951,columnNumber:33},this),e.jsxDEV(is,{className:p.selectContent,onPointerDownOutside:D=>D.preventDefault(),children:_.map(D=>e.jsxDEV(os,{value:D.value,children:D.label},D.value,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:964,columnNumber:37},this))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:959,columnNumber:33},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:945,columnNumber:31},this)]},c.document_type_id,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:942,columnNumber:29},this)})},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:917,columnNumber:21},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:916,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:898,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:762,columnNumber:13},this),e.jsxDEV("div",{className:p.rightColumn,children:[e.jsxDEV("div",{className:p.card,children:[e.jsxDEV("div",{className:p.cardHeader,onClick:()=>Y("timeline"),style:{cursor:"pointer"},children:[e.jsxDEV(nt,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:989,columnNumber:19},this),e.jsxDEV("h3",{className:p.cardTitle,children:"L·ªãch s·ª≠ ki·ªÉm tra"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:990,columnNumber:19},this),e.jsxDEV(ke,{size:16,className:p.chevron,style:{transform:H.timeline?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.2s"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:991,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:984,columnNumber:17},this),!H.timeline&&e.jsxDEV("div",{className:p.cardBody,children:e.jsxDEV("div",{className:p.timeline,children:[d?e.jsxDEV("div",{className:"flex items-center justify-center py-4 text-xs text-muted-foreground",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-primary mr-2"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1005,columnNumber:27},this),"ƒêang t·∫£i l·ªãch s·ª≠..."]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1004,columnNumber:25},this):m&&m.length>0?m.map((c,N)=>e.jsxDEV("div",{className:p.timelineItem,children:[e.jsxDEV("div",{className:p.timelineDot,style:{background:c.status==="passed"?"#22c55e":c.status==="failed"?"#ef4444":"#94a3b8"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1011,columnNumber:29},this),e.jsxDEV("div",{className:p.timelineContent,children:[e.jsxDEV("div",{className:p.timelineTitle,children:c.document_type_name||"Ki·ªÉm tra"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1018,columnNumber:31},this),e.jsxDEV("div",{className:p.timelineDate,children:c.inspection_date?new Date(c.inspection_date).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1019,columnNumber:31},this),c.notes&&e.jsxDEV("div",{className:p.timelineMeta,children:c.notes},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1026,columnNumber:46},this),e.jsxDEV("div",{className:p.timelineResult,children:["KQ: ",e.jsxDEV("strong",{style:{color:c.status==="passed"?"#16a34a":c.status==="failed"?"#dc2626":"inherit"},children:c.status==="passed"?"ƒê·∫°t":c.status==="failed"?"Kh√¥ng ƒë·∫°t":"Ch∆∞a c√≥ k·∫øt qu·∫£"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1028,columnNumber:37},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1027,columnNumber:31},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1017,columnNumber:29},this)]},c._id||N,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1010,columnNumber:27},this)):e.jsxDEV("div",{className:p.timelineItem,children:[e.jsxDEV("div",{className:p.timelineDot,style:{background:"#22c55e"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1037,columnNumber:27},this),e.jsxDEV("div",{className:p.timelineContent,children:[e.jsxDEV("div",{className:p.timelineTitle,children:"Ki·ªÉm tra g·∫ßn nh·∫•t"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1039,columnNumber:29},this),e.jsxDEV("div",{className:p.timelineDate,children:A.lastInspectionDate?A.lastInspectionDate.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1040,columnNumber:29},this),e.jsxDEV("div",{className:p.timelineMeta,children:["Chi c·ª•c QLTT ",t.district]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1047,columnNumber:29},this),e.jsxDEV("div",{className:p.timelineResult,children:["KQ: ",e.jsxDEV("strong",{children:t.category==="hotspot"?"Kh√¥ng ƒë·∫°t":"ƒê·∫°t y√™u c·∫ßu"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1051,columnNumber:35},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1050,columnNumber:29},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1038,columnNumber:27},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1036,columnNumber:25},this),A.nextInspectionDate&&e.jsxDEV("div",{className:p.timelineItem,children:[e.jsxDEV("div",{className:p.timelineDot,style:{background:"#eab308"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1059,columnNumber:27},this),e.jsxDEV("div",{className:p.timelineContent,children:[e.jsxDEV("div",{className:p.timelineTitle,children:"Ki·ªÉm tra ti·∫øp theo"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1061,columnNumber:29},this),e.jsxDEV("div",{className:p.timelineDate,children:A.nextInspectionDate.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1062,columnNumber:29},this),e.jsxDEV("div",{className:p.timelineMeta,children:"ƒê√£ l√™n l·ªãch"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1069,columnNumber:29},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1060,columnNumber:27},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1058,columnNumber:25},this),e.jsxDEV("div",{className:p.timelineItem,children:[e.jsxDEV("div",{className:p.timelineDot,style:{background:"#94a3b8"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1075,columnNumber:25},this),e.jsxDEV("div",{className:p.timelineContent,children:[e.jsxDEV("div",{className:p.timelineTitle,children:"C·∫•p gi·∫•y ph√©p"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1077,columnNumber:27},this),e.jsxDEV("div",{className:p.timelineDate,children:A.establishedDate?A.establishedDate.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1078,columnNumber:27},this),e.jsxDEV("div",{className:p.timelineMeta,children:["S·ªü Y t·∫ø ",t.province]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1085,columnNumber:27},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1076,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1074,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1002,columnNumber:21},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1001,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:983,columnNumber:15},this),e.jsxDEV("div",{className:p.card,children:[e.jsxDEV("div",{className:p.cardHeader,onClick:()=>Y("certificates"),style:{cursor:"pointer"},children:[e.jsxDEV(Ia,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1102,columnNumber:19},this),e.jsxDEV("h3",{className:p.cardTitle,children:"Gi·∫•y ch·ª©ng nh·∫≠n"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1103,columnNumber:19},this),e.jsxDEV(ke,{size:16,className:p.chevron,style:{transform:H.certificates?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.2s"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1104,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1097,columnNumber:17},this),!H.certificates&&e.jsxDEV("div",{className:p.cardBody,children:e.jsxDEV("div",{className:p.certCompact,children:u?e.jsxDEV("div",{className:"flex items-center justify-center py-4 text-xs text-muted-foreground",children:[e.jsxDEV("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-primary mr-2"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1118,columnNumber:27},this),"ƒêang t·∫£i gi·∫•y ch·ª©ng nh·∫≠n..."]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1117,columnNumber:25},this):i&&i.length>0?i.map((c,N)=>{var D,k;const x=((D=c.license_type)==null?void 0:D.toLowerCase().includes("an to√†n th·ª±c ph·∫©m"))||((k=c.license_type)==null?void 0:k.toLowerCase().includes("attp")),_=ie(c.status,x);return e.jsxDEV("div",{className:p.certItem,children:[e.jsxDEV("div",{className:p.certItemHeader,children:[e.jsxDEV("div",{className:p.certIconSmall,style:{background:x?"#dcfce7":"#dbeafe",color:x?"#16a34a":"#005cb6"},children:x?e.jsxDEV(ft,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1137,columnNumber:45},this):e.jsxDEV(ft,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1137,columnNumber:71},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1130,columnNumber:33},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:p.certTitleSmall,children:c.license_type||"Gi·∫•y ch·ª©ng nh·∫≠n"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1140,columnNumber:35},this),e.jsxDEV("div",{className:p.certNumber,children:c.license_number||"N/A"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1141,columnNumber:35},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1139,columnNumber:33},this),e.jsxDEV("span",{className:p.certStatusBadge,style:{background:_.bg,color:_.color},children:_.text},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1143,columnNumber:33},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1129,columnNumber:31},this),e.jsxDEV("div",{className:p.certMeta,children:[c.issued_by_name&&`C·∫•p b·ªüi: ${c.issued_by_name} ‚Ä¢ `,"C·∫•p: ",c.issued_date?new Date(c.issued_date).toLocaleDateString("vi-VN"):"N/A",c.expiry_date&&` ‚Ä¢ HH: ${new Date(c.expiry_date).toLocaleDateString("vi-VN")}`]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1153,columnNumber:31},this)]},c._id||N,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1128,columnNumber:29},this)}):e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:p.certItem,children:[e.jsxDEV("div",{className:p.certItemHeader,children:[e.jsxDEV("div",{className:p.certIconSmall,style:{background:"#dcfce7",color:"#16a34a"},children:e.jsxDEV(ft,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1167,columnNumber:33},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1166,columnNumber:31},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:p.certTitleSmall,children:"Ch·ª©ng nh·∫≠n ATTP"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1170,columnNumber:33},this),e.jsxDEV("div",{className:p.certNumber,children:A.attpCertificateNumber},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1171,columnNumber:33},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1169,columnNumber:31},this),e.jsxDEV("span",{className:p.certStatusBadge,style:{background:"#dcfce7",color:"#166534"},children:"C√≤n hi·ªáu l·ª±c"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1173,columnNumber:31},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1165,columnNumber:29},this),e.jsxDEV("div",{className:p.certMeta,children:["C·∫•p b·ªüi: S·ªü Y t·∫ø ",t.province," ‚Ä¢ C·∫•p: ",A.establishedDate?A.establishedDate.toLocaleDateString("vi-VN"):"N/A"," ‚Ä¢ HH: ",A.establishedDate?new Date(A.establishedDate.getTime()+3*365*24*60*60*1e3).toLocaleDateString("vi-VN"):"N/A"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1177,columnNumber:29},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1164,columnNumber:27},this),e.jsxDEV("div",{className:p.certItem,children:[e.jsxDEV("div",{className:p.certItemHeader,children:[e.jsxDEV("div",{className:p.certIconSmall,style:{background:"#dbeafe",color:"#005cb6"},children:e.jsxDEV(ft,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1186,columnNumber:33},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1185,columnNumber:31},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:p.certTitleSmall,children:"Gi·∫•y ph√©p KD"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1189,columnNumber:33},this),e.jsxDEV("div",{className:p.certNumber,children:A.license},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1190,columnNumber:33},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1188,columnNumber:31},this),e.jsxDEV("span",{className:p.certStatusBadge,style:{background:"#dbeafe",color:"#1e40af"},children:"C√≤n hi·ªáu l·ª±c"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1192,columnNumber:31},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1184,columnNumber:29},this),e.jsxDEV("div",{className:p.certMeta,children:["C·∫•p b·ªüi: Ph√≤ng ƒêKKD ",t.district," ‚Ä¢ Lo·∫°i h√¨nh: ",t.type]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1196,columnNumber:29},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1183,columnNumber:27},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1162,columnNumber:25},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1115,columnNumber:21},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1114,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1096,columnNumber:15},this),e.jsxDEV("div",{className:p.card,children:[e.jsxDEV("div",{className:p.cardHeader,onClick:()=>Y("legal"),style:{cursor:"pointer"},children:[e.jsxDEV(ka,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1214,columnNumber:19},this),e.jsxDEV("h3",{className:p.cardTitle,children:"VƒÉn b·∫£n ph√°p l√Ω"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1215,columnNumber:19},this),e.jsxDEV(ke,{size:16,className:p.chevron,style:{transform:H.legal?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.2s"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1216,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1209,columnNumber:17},this),!H.legal&&e.jsxDEV("div",{className:p.cardBody,children:e.jsxDEV("div",{className:p.legalCompact,children:a!=null&&a.merchant_law_docs&&a.merchant_law_docs.length>0?a.merchant_law_docs.map((c,N)=>e.jsxDEV("div",{className:p.legalItemCompact,children:[e.jsxDEV(Pa,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1231,columnNumber:29},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:p.legalTitleCompact,children:c.title||c.name||"N/A"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1233,columnNumber:31},this),e.jsxDEV("div",{className:p.legalMetaCompact,children:[c.document_number&&e.jsxDEV("span",{children:c.document_number},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1235,columnNumber:57},this),c.document_number&&(c.description||c.effective_date)&&e.jsxDEV("span",{children:" ‚Ä¢ "},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1236,columnNumber:100},this),c.description&&e.jsxDEV("span",{children:c.description},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1237,columnNumber:53},this),!c.description&&c.effective_date&&e.jsxDEV("span",{children:["Hi·ªáu l·ª±c: ",new Date(c.effective_date).toLocaleDateString("vi-VN")]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1238,columnNumber:76},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1234,columnNumber:31},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1232,columnNumber:29},this)]},c._id||N,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1230,columnNumber:27},this)):e.jsxDEV("div",{className:p.noDataCompact,children:"Kh√¥ng c√≥ d·ªØ li·ªáu vƒÉn b·∫£n ph√°p l√Ω"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1244,columnNumber:25},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1227,columnNumber:21},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1226,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1208,columnNumber:15},this),t.category==="hotspot"&&t.citizenReports&&t.citizenReports.length>0&&e.jsxDEV("div",{className:p.card,children:[e.jsxDEV("div",{className:p.cardHeader,onClick:()=>Y("citizenReports"),style:{cursor:"pointer"},children:[e.jsxDEV(Ot,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1259,columnNumber:21},this),e.jsxDEV("h3",{className:p.cardTitle,children:"Ph·∫£n √°nh c·ªßa ng∆∞·ªùi d√¢n"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1260,columnNumber:21},this),e.jsxDEV("span",{className:p.reportCount,children:t.citizenReports.length},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1261,columnNumber:21},this),e.jsxDEV(ke,{size:16,className:p.chevron,style:{transform:H.citizenReports?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.2s"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1262,columnNumber:21},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1254,columnNumber:19},this),!H.citizenReports&&e.jsxDEV("div",{className:p.cardBody,children:e.jsxDEV("div",{className:p.citizenReportsContainer,children:t.citizenReports.map(c=>{const N=new Date(c.reportDate),x=Math.floor((Date.now()-N.getTime())/(1e3*60*60*24));return e.jsxDEV("div",{className:p.reportItem,children:[e.jsxDEV("div",{className:p.reportHeader,children:[e.jsxDEV("div",{className:p.reportMeta,children:[e.jsxDEV(et,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1282,columnNumber:35},this),e.jsxDEV("span",{className:p.reporterName,children:c.reporterName},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1283,columnNumber:35},this),e.jsxDEV("span",{className:p.reportDivider,children:"‚Ä¢"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1284,columnNumber:35},this),e.jsxDEV("span",{className:p.reportDate,children:x===0?"H√¥m nay":x===1?"H√¥m qua":`${x} ng√†y tr∆∞·ªõc`},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1285,columnNumber:35},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1281,columnNumber:33},this),e.jsxDEV("div",{className:p.violationBadge,children:[e.jsxDEV(Ue,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1290,columnNumber:35},this),e.jsxDEV("span",{children:c.violationType},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1291,columnNumber:35},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1289,columnNumber:33},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1280,columnNumber:31},this),e.jsxDEV("div",{className:p.reportContent,children:c.content},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1295,columnNumber:31},this),c.images&&c.images.length>0&&e.jsxDEV("div",{className:p.reportMedia,children:[e.jsxDEV("div",{className:p.reportMediaHeader,children:[e.jsxDEV(Aa,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1302,columnNumber:37},this),e.jsxDEV("span",{children:[c.images.length," h√¨nh ·∫£nh ƒë√≠nh k√®m"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1303,columnNumber:37},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1301,columnNumber:35},this),e.jsxDEV("div",{className:p.reportImageGrid,children:c.images.map((_,D)=>e.jsxDEV("div",{className:p.reportImageWrapper,onClick:()=>{pe(c.images,D)},children:e.jsxDEV("img",{src:_,alt:`Ph·∫£n √°nh ${D+1}`,className:p.reportImage},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1314,columnNumber:41},this)},D,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1307,columnNumber:39},this))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1305,columnNumber:35},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1300,columnNumber:33},this)]},c.id,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1279,columnNumber:29},this)})},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1273,columnNumber:23},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1272,columnNumber:21},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1253,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:981,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:760,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:735,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:620,columnNumber:7},this),e.jsxDEV(ls,{open:q.open,onOpenChange:c=>{c||X({open:!1,documentTypeId:null,newStatus:null,docTypeLabel:""})},title:"X√°c nh·∫≠n thay ƒë·ªïi tr·∫°ng th√°i",description:`B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën thay ƒë·ªïi tr·∫°ng th√°i "${q.docTypeLabel}" th√†nh "${q.newStatus==="passed"?"ƒê·∫°t":q.newStatus==="failed"?"Ch∆∞a ƒë·∫°t":"Ch∆∞a ki·ªÉm tra"}"?`,confirmLabel:"X√°c nh·∫≠n",cancelLabel:"H·ªßy",variant:"default",onConfirm:ne},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1337,columnNumber:7},this),Q&&e.jsxDEV(kn,{images:f,currentIndex:E,isOpen:Q,onClose:xe,onNext:S,onPrev:G},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:1353,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/PointDetailModal.tsx",lineNumber:615,columnNumber:5},this)}const Ao="_overlay_16cjz_6",Bo="_modal_16cjz_24",Ro="_closeBtn_16cjz_49",Oo="_header_16cjz_77",zo="_headerTitle_16cjz_84",Fo="_headerSubtitle_16cjz_94",$o="_content_16cjz_102",qo="_summaryCard_16cjz_131",Uo="_summaryLeft_16cjz_141",Wo="_averageRating_16cjz_152",Go="_stars_16cjz_160",Ko="_reviewCount_16cjz_165",Zo="_summaryRight_16cjz_172",Yo="_ratingBar_16cjz_179",Xo="_ratingBarLabel_16cjz_186",Jo="_ratingBarTrack_16cjz_196",el="_ratingBarFill_16cjz_203",tl="_ratingBarCount_16cjz_209",nl="_reviewsList_16cjz_218",al="_reviewItem_16cjz_224",sl="_reviewHeader_16cjz_231",il="_reviewUser_16cjz_238",ol="_userAvatar_16cjz_244",ll="_userInfo_16cjz_257",rl="_userName_16cjz_263",cl="_reviewDate_16cjz_270",ml="_reviewRating_16cjz_280",pl="_reviewContent_16cjz_285",dl="_reviewComment_16cjz_289",ul="_reviewActions_16cjz_326",fl="_actionBtn_16cjz_333",hl="_footer_16cjz_360",Nl="_btnSecondary_16cjz_371",ee={overlay:Ao,modal:Bo,closeBtn:Ro,header:Oo,headerTitle:zo,headerSubtitle:Fo,content:$o,summaryCard:qo,summaryLeft:Uo,averageRating:Wo,stars:Go,reviewCount:Ko,summaryRight:Zo,ratingBar:Yo,ratingBarLabel:Xo,ratingBarTrack:Jo,ratingBarFill:el,ratingBarCount:tl,reviewsList:nl,reviewItem:al,reviewHeader:sl,reviewUser:il,userAvatar:ol,userInfo:ll,userName:rl,reviewDate:cl,reviewRating:ml,reviewContent:pl,reviewComment:dl,reviewActions:ul,actionBtn:fl,footer:hl,btnSecondary:Nl},vl="_gallery_wk6v7_5",Vl="_thumbnail_wk6v7_11",bl="_overlay_wk6v7_41",gl="_overlayText_wk6v7_51",ht={gallery:vl,thumbnail:Vl,overlay:bl,overlayText:gl};function xl({images:t}){const[s,n]=l.useState(!1),[o,a]=l.useState(0);if(!t||t.length===0)return null;const m=h=>{a(h),n(!0)},i=()=>{a(h=>(h+1)%t.length)},r=()=>{a(h=>(h-1+t.length)%t.length)},d=t.slice(0,3),u=t.length-3;return e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:ht.gallery,children:d.map((h,v)=>e.jsxDEV("div",{className:ht.thumbnail,onClick:()=>m(v),children:[e.jsxDEV("img",{src:h,alt:`Review image ${v+1}`},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewImageGallery.tsx",lineNumber:40,columnNumber:13},this),v===2&&u>0&&e.jsxDEV("div",{className:ht.overlay,children:e.jsxDEV("span",{className:ht.overlayText,children:["+",u]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewImageGallery.tsx",lineNumber:43,columnNumber:17},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewImageGallery.tsx",lineNumber:42,columnNumber:15},this)]},v,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewImageGallery.tsx",lineNumber:35,columnNumber:11},this))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewImageGallery.tsx",lineNumber:33,columnNumber:7},this),e.jsxDEV(kn,{images:t,currentIndex:o,isOpen:s,onClose:()=>n(!1),onNext:i,onPrev:r},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewImageGallery.tsx",lineNumber:50,columnNumber:7},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewImageGallery.tsx",lineNumber:32,columnNumber:5},this)}function Tl(t){if(!t)return[];try{const s={positive:["ƒê·ªì ƒÉn r·∫•t ngon, v·ªá sinh s·∫°ch s·∫Ω. Nh√¢n vi√™n ph·ª•c v·ª• nhi·ªát t√¨nh.","M√≥n ƒÉn ƒëa d·∫°ng, gi√° c·∫£ h·ª£p l√Ω. Kh√¥ng gian tho√°ng m√°t.","Ch·∫•t l∆∞·ª£ng ·ªïn ƒë·ªãnh, ki·ªÉm ƒë·ªãnh ATTP ƒë·∫ßy ƒë·ªß. S·∫Ω quay l·∫°i.","R·∫•t h√†i l√≤ng v·ªÅ v·ªá sinh th·ª±c ph·∫©m. Gi·∫•y ph√©p ƒë·∫ßy ƒë·ªß.","Kh√¥ng gian s·∫°ch s·∫Ω, tho√°ng m√°t. Ph·ª•c v·ª• nhanh."],neutral:["ƒê·ªì ƒÉn b√¨nh th∆∞·ªùng, kh√¥ng c√≥ g√¨ ƒë·∫∑c bi·ªát. Gi√° c·∫£ h∆°i cao.","M√≥n ƒÉn t·∫°m ƒë∆∞·ª£c. Ch·ªó ƒë·∫≠u xe h∆°i kh√≥.","Ph·ª•c v·ª• ch·∫≠m m·ªôt ch√∫t. Nh∆∞ng nh√¨n chung ·ªïn.","Kh√¥ng gian h∆°i ch·∫≠t v√†o gi·ªù cao ƒëi·ªÉm."],negative:["V·ªá sinh ch∆∞a ƒë∆∞·ª£c t·ªët l·∫Øm. C·∫ßn c·∫£i thi·ªán.","M√≥n ƒÉn kh√¥ng ƒë√∫ng kh·∫©u v·ªã. H∆°i m·∫∑n.","Th·ªùi gian ch·ªù l√¢u. Nh√¢n vi√™n √≠t.","Gi√° c·∫£ cao h∆°n m·∫∑t b·∫±ng chung."]},n=["Nguy·ªÖn VƒÉn A","Tr·∫ßn Th·ªã B","L√™ Ho√†ng C","Ph·∫°m Minh D","Ho√†ng Thu E","ƒê·∫∑ng Qu·ªëc F","V≈© Th·ªã G","B√πi VƒÉn H"],o=["https://images.unsplash.com/photo-1597345637412-9fd611e758f3?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800","https://images.unsplash.com/photo-1600891964599-f61ba0e24092?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800","https://images.unsplash.com/photo-1622643944007-450264a5f9a9?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800","https://images.unsplash.com/photo-1614597134736-a8e0616933d5?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800","https://images.unsplash.com/photo-1609590981063-d495e2914ce4?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800","https://images.unsplash.com/photo-1552912470-ee2e96439539?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800"],a=t.category==="certified"?8:t.category==="hotspot"?4:6,m=[];for(let i=0;i<a;i++){let r,d;t.category==="certified"?(r=Math.random()>.2?Math.random()>.5?5:4:3,d=r>=4?s.positive:s.neutral):t.category==="hotspot"?(r=Math.random()>.3?Math.random()>.5?2:1:3,d=r<=2?s.negative:s.neutral):(r=Math.floor(Math.random()*3)+3,d=r>=4?s.positive:s.neutral);const u=Math.floor(Math.random()*90),h=new Date(Date.now()-u*24*60*60*1e3),v=Math.random()>.4;let H;if(v){const b=Math.floor(Math.random()*3)+1;H=[];for(let f=0;f<b;f++){const g=(i*3+f)%o.length;H.push(o[g])}}m.push({id:`review-${t.id}-${i}`,userName:n[i%n.length],rating:r,date:h.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),comment:d[Math.floor(Math.random()*d.length)],images:H,helpful:Math.floor(Math.random()*20),replies:Math.random()>.7?Math.floor(Math.random()*3):0})}return m.sort((i,r)=>r.rating-i.rating)}catch(s){return console.error("Error generating reviews:",s),[]}}function El({point:t,isOpen:s,onClose:n}){l.useEffect(()=>{const r=d=>{d.key==="Escape"&&s&&n()};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[s,n]),l.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[s]);const o=l.useMemo(()=>Tl(t),[t==null?void 0:t.id,t==null?void 0:t.category]);if(!s||!t)return null;const a=Array.isArray(o)?o:[],m=a.length>0?a.reduce((r,d)=>r+((d==null?void 0:d.rating)||0),0)/a.length:0,i=[0,0,0,0,0];return a.forEach(r=>{r&&typeof r.rating=="number"&&r.rating>=1&&r.rating<=5&&i[r.rating-1]++}),e.jsxDEV("div",{className:ee.overlay,onClick:n,children:e.jsxDEV("div",{className:ee.modal,onClick:r=>r.stopPropagation(),children:[e.jsxDEV("button",{className:ee.closeBtn,onClick:n,"aria-label":"ƒê√≥ng",children:e.jsxDEV(ge,{size:18},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:173,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:172,columnNumber:9},this),e.jsxDEV("div",{className:ee.header,children:[e.jsxDEV("h1",{className:ee.headerTitle,children:"ƒê√°nh gi√° c·ªßa kh√°ch h√†ng"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:178,columnNumber:11},this),e.jsxDEV("div",{className:ee.headerSubtitle,children:(t==null?void 0:t.name)||"N/A"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:179,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:177,columnNumber:9},this),e.jsxDEV("div",{className:ee.content,children:[e.jsxDEV("div",{className:ee.summaryCard,children:[e.jsxDEV("div",{className:ee.summaryLeft,children:[e.jsxDEV("div",{className:ee.averageRating,children:m.toFixed(1)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:187,columnNumber:15},this),e.jsxDEV("div",{className:ee.stars,children:[1,2,3,4,5].map(r=>e.jsxDEV(St,{size:20,fill:r<=Math.round(m)?"#facc15":"none",stroke:r<=Math.round(m)?"#facc15":"#d1d5db",strokeWidth:2},r,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:190,columnNumber:19},this))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:188,columnNumber:15},this),e.jsxDEV("div",{className:ee.reviewCount,children:[a.length," ƒë√°nh gi√°"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:199,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:186,columnNumber:13},this),e.jsxDEV("div",{className:ee.summaryRight,children:[5,4,3,2,1].map(r=>e.jsxDEV("div",{className:ee.ratingBar,children:[e.jsxDEV("div",{className:ee.ratingBarLabel,children:[e.jsxDEV(St,{size:14,fill:"#facc15",stroke:"#facc15"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:206,columnNumber:21},this),e.jsxDEV("span",{children:r},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:207,columnNumber:21},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:205,columnNumber:19},this),e.jsxDEV("div",{className:ee.ratingBarTrack,children:e.jsxDEV("div",{className:ee.ratingBarFill,style:{width:`${a.length>0?(i[r-1]||0)/a.length*100:0}%`}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:210,columnNumber:21},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:209,columnNumber:19},this),e.jsxDEV("div",{className:ee.ratingBarCount,children:i[r-1]||0},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:217,columnNumber:19},this)]},r,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:204,columnNumber:17},this))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:202,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:185,columnNumber:11},this),e.jsxDEV("div",{className:ee.reviewsList,children:a.map(r=>!r||!r.id?null:e.jsxDEV("div",{className:ee.reviewItem,children:[e.jsxDEV("div",{className:ee.reviewHeader,children:[e.jsxDEV("div",{className:ee.reviewUser,children:[e.jsxDEV("div",{className:ee.userAvatar,children:e.jsxDEV(et,{size:18},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:233,columnNumber:25},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:232,columnNumber:23},this),e.jsxDEV("div",{className:ee.userInfo,children:[e.jsxDEV("div",{className:ee.userName,children:r.userName||"Anonymous"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:236,columnNumber:25},this),e.jsxDEV("div",{className:ee.reviewDate,children:[e.jsxDEV(nt,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:238,columnNumber:27},this),e.jsxDEV("span",{children:r.date||"N/A"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:239,columnNumber:27},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:237,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:235,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:231,columnNumber:21},this),e.jsxDEV("div",{className:ee.reviewRating,children:[1,2,3,4,5].map(d=>e.jsxDEV(St,{size:16,fill:d<=(r.rating||0)?"#facc15":"none",stroke:d<=(r.rating||0)?"#facc15":"#d1d5db",strokeWidth:2},d,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:245,columnNumber:25},this))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:243,columnNumber:21},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:230,columnNumber:19},this),e.jsxDEV("div",{className:ee.reviewContent,children:[e.jsxDEV("p",{className:ee.reviewComment,children:r.comment||""},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:257,columnNumber:21},this),r.images&&r.images.length>0&&e.jsxDEV(xl,{images:r.images},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:259,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:256,columnNumber:19},this),e.jsxDEV("div",{className:ee.reviewActions,children:[e.jsxDEV("button",{className:ee.actionBtn,children:[e.jsxDEV(Oa,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:265,columnNumber:23},this),e.jsxDEV("span",{children:["H·ªØu √≠ch (",r.helpful||0,")"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:266,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:264,columnNumber:21},this),(r.replies||0)>0&&e.jsxDEV("button",{className:ee.actionBtn,children:[e.jsxDEV(za,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:270,columnNumber:25},this),e.jsxDEV("span",{children:[r.replies," ph·∫£n h·ªìi"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:271,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:269,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:263,columnNumber:19},this)]},r.id,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:229,columnNumber:17},this))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:224,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:183,columnNumber:9},this),e.jsxDEV("div",{className:ee.footer,children:e.jsxDEV("button",{className:ee.btnSecondary,onClick:n,children:"ƒê√≥ng"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:283,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:282,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:170,columnNumber:7},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/ReviewModal.tsx",lineNumber:169,columnNumber:5},this)}const Hl="_overlay_10ywb_6",Dl="_container_10ywb_21",_l="_closeBtn_10ywb_43",yl="_mapWrapper_10ywb_75",Ll="_filterPanelWrapper_10ywb_94",wl="_filterToggleBtn_10ywb_104",jl="_statsToggleBtn_10ywb_135",Ml="_legendToggleBtn_10ywb_166",be={overlay:Hl,container:Dl,closeBtn:_l,mapWrapper:yl,filterPanelWrapper:Ll,filterToggleBtn:wl,statsToggleBtn:jl,legendToggleBtn:Ml},Ql="_panel_1s6cg_11",Cl="_header_1s6cg_67",Sl="_title_1s6cg_83",Il="_resultCount_1s6cg_101",kl="_closeButton_1s6cg_117",Pl="_scrollableContent_1s6cg_171",Al="_filterSection_1s6cg_237",Bl="_sectionHeader_1s6cg_245",Rl="_sectionTitle_1s6cg_273",Ol="_filterList_1s6cg_343",zl="_filterListExpanded_1s6cg_359",Fl="_filterListCollapsed_1s6cg_445",$l="_filterItem_1s6cg_463",ql="_checkboxWrapper_1s6cg_495",Ul="_checkbox_1s6cg_495",Wl="_customCheckbox_1s6cg_521",Gl="_checkmark_1s6cg_545",Kl="_filterLabel_1s6cg_581",Zl="_applyFiltersWrapper_1s6cg_1353",Yl="_applyFiltersButton_1s6cg_1367",Xl="_saveFiltersWrapper_1s6cg_1415",Jl="_saveFiltersButton_1s6cg_1429",er="_categoryAutocompleteWrapper_1s6cg_1493",tr="_categoryInputWrapper_1s6cg_1505",nr="_categorySearchInput_1s6cg_1541",ar="_categoryAutocompleteDropdown_1s6cg_1591",sr="_categoryAutocompleteItem_1s6cg_1621",ir="_categoryTagsContainer_1s6cg_1729",or="_categoryTag_1s6cg_1729",lr="_categoryTagRemove_1s6cg_1795",rr="_categoryTagsEmpty_1s6cg_1849",L={panel:Ql,header:Cl,title:Sl,resultCount:Il,closeButton:kl,scrollableContent:Pl,filterSection:Al,sectionHeader:Bl,sectionTitle:Rl,filterList:Ol,filterListExpanded:zl,filterListCollapsed:Fl,filterItem:$l,checkboxWrapper:ql,checkbox:Ul,customCheckbox:Wl,checkmark:Gl,filterLabel:Kl,applyFiltersWrapper:Zl,applyFiltersButton:Yl,saveFiltersWrapper:Xl,saveFiltersButton:Jl,categoryAutocompleteWrapper:er,categoryInputWrapper:tr,categorySearchInput:nr,categoryAutocompleteDropdown:ar,categoryAutocompleteItem:sr,categoryTagsContainer:ir,categoryTag:or,categoryTagRemove:lr,categoryTagsEmpty:rr},cr=({isExpanded:t,onToggle:s,filters:n,categoryData:o,onFilterChange:a})=>e.jsxDEV("div",{className:L.filterSection,children:[e.jsxDEV("button",{className:L.sectionHeader,onClick:s,children:[e.jsxDEV("div",{className:L.sectionTitle,children:"Ph√¢n lo·∫°i"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:30,columnNumber:9},void 0),t?e.jsxDEV(zt,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:31,columnNumber:23},void 0):e.jsxDEV(Ft,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:31,columnNumber:45},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:29,columnNumber:7},void 0),e.jsxDEV("div",{className:`${L.filterList} ${t?L.filterListExpanded:L.filterListCollapsed}`,children:o.map(({key:m,label:i,icon:r,color:d})=>e.jsxDEV("label",{className:L.filterItem,children:[e.jsxDEV("div",{className:L.checkboxWrapper,children:[e.jsxDEV("input",{type:"checkbox",checked:n[m],onChange:()=>a(m),className:L.checkbox},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:37,columnNumber:15},void 0),e.jsxDEV("div",{className:L.customCheckbox,style:{borderColor:n[m]?d:void 0},children:n[m]&&e.jsxDEV("div",{className:L.checkmark,style:{background:d},children:e.jsxDEV(lt,{size:10,color:"white"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:46,columnNumber:21},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:45,columnNumber:19},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:43,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:36,columnNumber:13},void 0),e.jsxDEV(r,{size:16,style:{color:d}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:51,columnNumber:13},void 0),e.jsxDEV("span",{className:L.filterLabel,children:i},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:52,columnNumber:13},void 0)]},m,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:35,columnNumber:11},void 0))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:33,columnNumber:7},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/CategoryFilterSection.tsx",lineNumber:28,columnNumber:5},void 0),mr=({isExpanded:t,onToggle:s,selectedProvince:n,selectedWard:o,onProvinceChange:a,onWardChange:m})=>{const[i,r]=l.useState(""),[d,u]=l.useState(!1),[h,v]=l.useState([]),[H,b]=l.useState(""),[f,g]=l.useState(!1),[E,V]=l.useState([]),[Q,C]=l.useState([]),[w,z]=l.useState(!1),[U,J]=l.useState(!1),[fe,ae]=l.useState([]);l.useEffect(()=>{(async()=>{z(!0);try{const G=await jn();C(G)}catch(G){console.error("Error loading provinces:",G)}finally{z(!1)}})()},[]),l.useEffect(()=>{(async()=>{if(n){J(!0);try{const G=await Mn(n);ae(G)}catch(G){console.error("Error loading wards:",G),ae([])}finally{J(!1)}}else ae([])})()},[n]),l.useEffect(()=>{v(n?[n]:[])},[n]),l.useEffect(()=>{V(o?[o]:[])},[o]);const q=i.trim()?Q.filter(S=>S.name.toLowerCase().includes(i.toLowerCase())&&!h.includes(S._id)):Q.filter(S=>!h.includes(S._id)),X=Q.filter(S=>h.includes(S._id)),re=S=>{v([S]),a==null||a(S),m==null||m(""),r(""),u(!1)},de=()=>{v([]),a==null||a(""),m==null||m("")},ne=H.trim()?fe.filter(S=>S.name.toLowerCase().includes(H.toLowerCase())&&!E.includes(S._id)):fe.filter(S=>!E.includes(S._id)),se=fe.filter(S=>E.includes(S._id)),pe=S=>{V([S]),m==null||m(S),b(""),g(!1)},xe=()=>{V([]),m==null||m("")};return e.jsxDEV("div",{className:L.filterSection,children:[e.jsxDEV("button",{className:L.sectionHeader,onClick:s,children:[e.jsxDEV("div",{className:L.sectionTitle,children:[e.jsxDEV(De,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:144,columnNumber:46},void 0)," V·ªã tr√≠"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:144,columnNumber:9},void 0),t?e.jsxDEV(zt,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:145,columnNumber:23},void 0):e.jsxDEV(Ft,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:145,columnNumber:45},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:143,columnNumber:7},void 0),e.jsxDEV("div",{className:`${L.filterList} ${t?L.filterListExpanded:L.filterListCollapsed}`,children:[e.jsxDEV("div",{className:L.categoryAutocompleteWrapper,children:[e.jsxDEV("div",{className:L.categoryInputWrapper,children:[e.jsxDEV(xt,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:151,columnNumber:13},void 0),e.jsxDEV("input",{type:"text",value:i,onChange:S=>{r(S.target.value),u(S.target.value.trim().length>0)},onFocus:()=>{i.trim().length>0&&u(!0)},onBlur:()=>{setTimeout(()=>u(!1),200)},placeholder:"T√¨m ki·∫øm t·ªânh th√†nh...",className:L.categorySearchInput,disabled:w||h.length>0},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:152,columnNumber:13},void 0),d&&!w&&q.length>0&&e.jsxDEV("div",{className:L.categoryAutocompleteDropdown,children:q.map(S=>e.jsxDEV("button",{type:"button",className:L.categoryAutocompleteItem,onClick:()=>re(S._id),onMouseDown:G=>G.preventDefault(),children:e.jsxDEV("span",{children:S.name},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:181,columnNumber:21},void 0)},S._id,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:174,columnNumber:19},void 0))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:172,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:150,columnNumber:11},void 0),X&&X.length>0?e.jsxDEV("div",{className:L.categoryTagsContainer,children:X.map(S=>e.jsxDEV("div",{className:L.categoryTag,style:{borderColor:"#005cb6"},children:[e.jsxDEV(De,{size:14,style:{color:"#005cb6"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:193,columnNumber:19},void 0),e.jsxDEV("span",{children:S.name},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:194,columnNumber:19},void 0),e.jsxDEV("button",{type:"button",className:L.categoryTagRemove,onClick:()=>de(),onMouseDown:G=>G.preventDefault(),children:e.jsxDEV(ge,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:201,columnNumber:21},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:195,columnNumber:19},void 0)]},S._id,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:192,columnNumber:17},void 0))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:190,columnNumber:13},void 0):e.jsxDEV("div",{className:L.categoryTagsEmpty,children:e.jsxDEV("span",{children:"Ch∆∞a ch·ªçn t·ªânh th√†nh n√†o"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:208,columnNumber:15},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:207,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:149,columnNumber:9},void 0),n&&e.jsxDEV("div",{className:L.categoryAutocompleteWrapper,style:{marginTop:"8px"},children:[e.jsxDEV("div",{className:L.categoryInputWrapper,children:[e.jsxDEV(xt,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:217,columnNumber:15},void 0),e.jsxDEV("input",{type:"text",value:H,onChange:S=>{b(S.target.value),g(S.target.value.trim().length>0)},onFocus:()=>{H.trim().length>0&&g(!0)},onBlur:()=>{setTimeout(()=>g(!1),200)},placeholder:"T√¨m ki·∫øm x√£...",className:L.categorySearchInput,disabled:U||E.length>0},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:218,columnNumber:15},void 0),f&&!U&&ne.length>0&&e.jsxDEV("div",{className:L.categoryAutocompleteDropdown,children:ne.map(S=>e.jsxDEV("button",{type:"button",className:L.categoryAutocompleteItem,onClick:()=>pe(S._id),onMouseDown:G=>G.preventDefault(),children:e.jsxDEV("span",{children:S.name},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:247,columnNumber:23},void 0)},S._id,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:240,columnNumber:21},void 0))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:238,columnNumber:17},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:216,columnNumber:13},void 0),se&&se.length>0?e.jsxDEV("div",{className:L.categoryTagsContainer,children:se.map(S=>e.jsxDEV("div",{className:L.categoryTag,style:{borderColor:"#005cb6"},children:[e.jsxDEV(De,{size:14,style:{color:"#005cb6"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:259,columnNumber:21},void 0),e.jsxDEV("span",{children:S.name},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:260,columnNumber:21},void 0),e.jsxDEV("button",{type:"button",className:L.categoryTagRemove,onClick:()=>xe(),onMouseDown:G=>G.preventDefault(),children:e.jsxDEV(ge,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:267,columnNumber:23},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:261,columnNumber:21},void 0)]},S._id,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:258,columnNumber:19},void 0))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:256,columnNumber:15},void 0):e.jsxDEV("div",{className:L.categoryTagsEmpty,children:e.jsxDEV("span",{children:"Ch∆∞a ch·ªçn x√£ n√†o"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:274,columnNumber:17},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:273,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:215,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:147,columnNumber:7},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationFilterSection.tsx",lineNumber:142,columnNumber:5},void 0)},pr=({isExpanded:t,onToggle:s,businessTypeFilters:n,categories:o,onBusinessTypeFilterChange:a})=>{const[m,i]=l.useState(""),[r,d]=l.useState(!1),[u,h]=l.useState([]),v={"Nh√† h√†ng":{icon:qa,color:"#6366f1"},"Qu√°n c√† ph√™":{icon:$a,color:"#ec4899"},"Qu√°n ƒÉn nhanh":{icon:Qn,color:"#f97316"},"Qu√°n ph·ªü":{icon:Fa,color:"#34d399"}},H=(o||[]).map(V=>{var C,w;return{key:V._id||V.id,label:V.name,icon:((C=v[V.name])==null?void 0:C.icon)||Ua,color:((w=v[V.name])==null?void 0:w.color)||"#9ca3af"}});l.useEffect(()=>{const V=Object.keys(n||{}).filter(Q=>n[Q]===!0);h(V)},[n]);const b=m.trim()?H.filter(V=>V.label.toLowerCase().includes(m.toLowerCase())&&!u.includes(V.key)):H.filter(V=>!u.includes(V.key)),f=H.filter(V=>u.includes(V.key)&&V.key&&V.label),g=V=>{u.includes(V)||(h([...u,V]),a(V)),i(""),d(!1)},E=V=>{h(u.filter(Q=>Q!==V)),a(V)};return e.jsxDEV("div",{className:L.filterSection,children:[e.jsxDEV("button",{className:L.sectionHeader,onClick:s,children:[e.jsxDEV("div",{className:L.sectionTitle,children:"Lo·∫°i h√¨nh kinh doanh"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:84,columnNumber:9},void 0),t?e.jsxDEV(zt,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:85,columnNumber:23},void 0):e.jsxDEV(Ft,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:85,columnNumber:45},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:83,columnNumber:7},void 0),e.jsxDEV("div",{className:`${L.filterList} ${t?L.filterListExpanded:L.filterListCollapsed}`,children:e.jsxDEV("div",{className:L.categoryAutocompleteWrapper,children:[e.jsxDEV("div",{className:L.categoryInputWrapper,children:[e.jsxDEV(xt,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:90,columnNumber:13},void 0),e.jsxDEV("input",{type:"text",value:m,onChange:V=>{i(V.target.value),d(V.target.value.trim().length>0)},onFocus:()=>{m.trim().length>0&&d(!0)},onBlur:()=>{setTimeout(()=>d(!1),200)},placeholder:"T√¨m ki·∫øm danh m·ª•c...",className:L.categorySearchInput},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:91,columnNumber:13},void 0),r&&b.length>0&&e.jsxDEV("div",{className:L.categoryAutocompleteDropdown,children:b.map(({key:V,label:Q})=>e.jsxDEV("button",{type:"button",className:L.categoryAutocompleteItem,onClick:()=>g(V),onMouseDown:C=>C.preventDefault(),children:e.jsxDEV("span",{children:Q},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:119,columnNumber:21},void 0)},V,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:112,columnNumber:19},void 0))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:110,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:89,columnNumber:11},void 0),f&&f.length>0?e.jsxDEV("div",{className:L.categoryTagsContainer,children:f.map(({key:V,label:Q,icon:C,color:w})=>e.jsxDEV("div",{className:L.categoryTag,style:{borderColor:w},children:[e.jsxDEV(C,{size:14,style:{color:w}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:131,columnNumber:19},void 0),e.jsxDEV("span",{children:Q},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:132,columnNumber:19},void 0),e.jsxDEV("button",{type:"button",className:L.categoryTagRemove,onClick:()=>E(V),onMouseDown:z=>z.preventDefault(),children:e.jsxDEV(ge,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:139,columnNumber:21},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:133,columnNumber:19},void 0)]},V,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:130,columnNumber:17},void 0))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:128,columnNumber:13},void 0):e.jsxDEV("div",{className:L.categoryTagsEmpty,children:e.jsxDEV("span",{children:"Ch∆∞a ch·ªçn danh m·ª•c n√†o"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:146,columnNumber:15},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:145,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:88,columnNumber:9},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:87,columnNumber:7},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/BusinessTypeFilterSection.tsx",lineNumber:82,columnNumber:5},void 0)},Gt=l.forwardRef(({isOpen:t,filters:s,businessTypeFilters:n,restaurants:o,pointStatuses:a,categories:m,departments:i,departmentFilters:r,selectedProvince:d,selectedDistrict:u,selectedWard:h,onFilterChange:v,onBusinessTypeFilterChange:H,onBusinessTypeToggleAll:b,onDepartmentFilterChange:f,onDepartmentToggleAll:g,onProvinceChange:E,onDistrictChange:V,onWardChange:Q,filteredCount:C,onClose:w,onApplyFilters:z,hasUnappliedChanges:U,onSaveFilters:J},fe)=>{const[ae,q]=l.useState({category:!0,location:!0,businessType:!1,department:!1});if(!t)return null;const X=se=>{q(pe=>({...pe,[se]:!pe[se]}))},re={certified:"#22c55e",hotspot:"#ef4444",scheduled:"#f59e0b",inspected:"#005cb6"},de={certified:Ga,hotspot:Wa,scheduled:nt,inspected:lt},ne=(a||[]).map(se=>({key:se.code,label:se.name,icon:de[se.code]||lt,color:re[se.code]||"#005cb6"}));return e.jsxDEV("div",{className:L.panel,ref:fe,children:[e.jsxDEV("div",{className:L.header,children:[e.jsxDEV("h3",{className:L.title,children:"B·ªô l·ªçc"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:109,columnNumber:11},void 0),e.jsxDEV("div",{className:L.resultCount,children:[C," ƒëi·ªÉm"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:110,columnNumber:11},void 0),e.jsxDEV("button",{className:L.closeButton,onClick:w,children:e.jsxDEV(ge,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:111,columnNumber:68},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:111,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:108,columnNumber:9},void 0),e.jsxDEV("div",{className:L.scrollableContent,children:[e.jsxDEV(cr,{isExpanded:ae.category,onToggle:()=>X("category"),filters:s,categoryData:ne,onFilterChange:v},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:115,columnNumber:11},void 0),e.jsxDEV(mr,{isExpanded:ae.location,onToggle:()=>X("location"),selectedProvince:d,selectedWard:h,onProvinceChange:E,onWardChange:Q},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:123,columnNumber:11},void 0),e.jsxDEV(pr,{isExpanded:ae.businessType,onToggle:()=>X("businessType"),businessTypeFilters:n,categories:m,onBusinessTypeFilterChange:H},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:132,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:114,columnNumber:9},void 0),U&&e.jsxDEV("div",{className:L.applyFiltersWrapper,children:e.jsxDEV("button",{className:L.applyFiltersButton,onClick:z,children:"√Åp d·ª•ng b·ªô l·ªçc"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:143,columnNumber:13},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:142,columnNumber:11},void 0),e.jsxDEV("div",{className:L.saveFiltersWrapper,children:e.jsxDEV("button",{className:L.saveFiltersButton,onClick:J,children:[e.jsxDEV(Ka,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:149,columnNumber:13},void 0),e.jsxDEV("span",{children:"L∆∞u b·ªô l·ªçc"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:150,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:148,columnNumber:11},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:147,columnNumber:9},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapFilterPanel.tsx",lineNumber:107,columnNumber:7},void 0)});Gt.displayName="MapFilterPanel";const dr="_card_zmwjp_5",ur="_fullscreen_zmwjp_20",fr="_header_zmwjp_36",hr="_title_zmwjp_45",Nr="_titleIcon_zmwjp_52",vr="_titleText_zmwjp_57",Vr="_closeIcon_zmwjp_64",br="_content_zmwjp_87",gr="_officerRow_zmwjp_95",xr="_businessTypesRow_zmwjp_105",Tr="_businessTypesList_zmwjp_136",Er="_businessTypeBadge_zmwjp_145",Hr="_ellipsis_zmwjp_159",Dr="_showMoreButton_zmwjp_170",_r="_icon_zmwjp_206",yr="_label_zmwjp_211",Lr="_value_zmwjp_217",wr="_statsGrid_zmwjp_225",jr="_statItem_zmwjp_231",Mr="_statIcon_zmwjp_241",Qr="_statContent_zmwjp_247",Cr="_statValue_zmwjp_252",Sr="_statLabel_zmwjp_259",Ir="_additionalStats_zmwjp_268",kr="_smallStat_zmwjp_276",Pr="_smallStatLabel_zmwjp_282",Ar="_smallStatValue_zmwjp_289",P={card:dr,fullscreen:ur,header:fr,title:hr,titleIcon:Nr,titleText:vr,closeIcon:Vr,content:br,officerRow:gr,businessTypesRow:xr,businessTypesList:Tr,businessTypeBadge:Er,ellipsis:Hr,showMoreButton:Dr,icon:_r,label:yr,value:Lr,statsGrid:wr,statItem:jr,statIcon:Mr,statContent:Qr,statValue:Cr,statLabel:Sr,additionalStats:Ir,smallStat:kr,smallStatLabel:Pr,smallStatValue:Ar},Kt=It.forwardRef(({selectedProvince:t,selectedDistrict:s,selectedWard:n,filteredRestaurants:o,businessTypeFilters:a,categories:m,divisionId:i,teamId:r,onClose:d,isVisible:u,onVisibilityChange:h,isFullscreen:v=!1},H)=>{var y,W,R;if(!u)return null;const[b,f]=It.useState(!1),g=2,[E,V]=l.useState([]),[Q,C]=l.useState([]),[w,z]=l.useState(null);l.useEffect(()=>{(async()=>{try{const N=await jn();V(N)}catch(N){console.error("Error loading provinces:",N)}})()},[]),l.useEffect(()=>{(async()=>{if(t)try{const N=await Mn(t);C(N)}catch(N){console.error("Error loading wards:",N),C([])}else C([])})()},[t]),l.useEffect(()=>{(async()=>{if(r||i)try{const N=await wa(r,i);z(N)}catch(N){console.error("Error loading department manager:",N),z(null)}else z(null)})()},[r,i]);const U=t&&t!=="undefined"?((y=E.find(c=>c._id===t))==null?void 0:y.name)||(t.length>20?null:t):null,J=n&&n!=="undefined"?((W=Q.find(c=>c._id===n))==null?void 0:W.name)||(n.length>20?null:n):null,fe=U&&U!=="undefined"?ms[U]:null,ae=s&&s!=="undefined"?(R=rs[U||""])==null?void 0:R.find(c=>c.name===s):null,X=(J&&J!=="undefined"&&s?(cs[s]||[]).find(c=>c.name===J):null)||ae||fe,re=J||(s&&s!=="undefined"?s:null)||U||"To√†n qu·ªëc",de=(w==null?void 0:w.full_name)||(X==null?void 0:X.officer)||"Ch∆∞a ph√¢n c√¥ng",ne=X==null?void 0:X.area,se=o.length,pe=o.filter(c=>c.category==="certified").length,xe=o.filter(c=>c.category==="hotspot").length,S=o.filter(c=>c.category==="scheduled").length,G=o.filter(c=>c.category==="inspected").length,Y=o.reduce((c,N)=>c+(N.nearbyPopulation||0),0),Te=se>0?Math.round(Y/se):0,A=Y>0?Math.round(Y/3.5):0,ie=c=>!c||isNaN(c)?"0":c.toLocaleString("vi-VN"),te=Object.entries(a).filter(([c,N])=>N).map(([c,N])=>c),Z=te.length>0,Ne=te.map(c=>{const N=m.find(x=>x._id===c||x.id===c);return(N==null?void 0:N.name)||null}).filter(c=>c!=null&&c!=="undefined"&&c.trim()!==""),j=()=>{h(!1),d()};return e.jsxDEV("div",{className:`${P.card} ${v?P.fullscreen:""}`,ref:H,children:[e.jsxDEV("div",{className:P.header,children:[e.jsxDEV("div",{className:P.title,children:[e.jsxDEV(Tn,{size:16,className:P.titleIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:182,columnNumber:13},void 0),e.jsxDEV("span",{className:P.titleText,children:re},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:183,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:181,columnNumber:11},void 0),e.jsxDEV("button",{className:P.closeIcon,onClick:j,"aria-label":"ƒê√≥ng",children:e.jsxDEV(ge,{size:16,strokeWidth:2},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:190,columnNumber:13},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:185,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:180,columnNumber:9},void 0),e.jsxDEV("div",{className:P.content,children:[Z&&Ne.length>0&&(()=>{const c=Ne.length>g,N=b?Ne:Ne.slice(0,g);return e.jsxDEV("div",{className:P.businessTypesRow,children:[e.jsxDEV(Pe,{size:14,className:P.icon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:207,columnNumber:17},void 0),e.jsxDEV("div",{className:P.businessTypesList,children:[N.filter(x=>x&&x!=="undefined").map(x=>e.jsxDEV("span",{className:P.businessTypeBadge,children:x},x,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:210,columnNumber:21},void 0)),c&&!b&&e.jsxDEV("span",{className:P.ellipsis,children:"..."},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:215,columnNumber:21},void 0),c&&e.jsxDEV("button",{className:P.showMoreButton,onClick:()=>f(!b),title:b?"Thu g·ªçn":`Xem th√™m ${Ne.length-g} ng√†nh ngh·ªÅ`,children:b?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Za,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:225,columnNumber:27},void 0),e.jsxDEV("span",{children:"Thu g·ªçn"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:226,columnNumber:27},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:224,columnNumber:25},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV("span",{children:"Xem th√™m"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:230,columnNumber:27},void 0),e.jsxDEV(ke,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:231,columnNumber:27},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:229,columnNumber:25},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:218,columnNumber:21},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:208,columnNumber:17},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:206,columnNumber:15},void 0)})(),e.jsxDEV("div",{className:P.officerRow,children:[e.jsxDEV(et,{size:14,className:P.icon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:243,columnNumber:13},void 0),e.jsxDEV("span",{className:P.label,children:"C√°n b·ªô qu·∫£n l√Ω:"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:244,columnNumber:13},void 0),e.jsxDEV("span",{className:P.value,children:de},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:245,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:242,columnNumber:11},void 0),e.jsxDEV("div",{className:P.statsGrid,children:[e.jsxDEV("div",{className:P.statItem,children:[e.jsxDEV(Pe,{size:14,className:P.statIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:251,columnNumber:15},void 0),e.jsxDEV("div",{className:P.statContent,children:[e.jsxDEV("div",{className:P.statValue,children:se},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:253,columnNumber:17},void 0),e.jsxDEV("div",{className:P.statLabel,children:"H·ªô kinh doanh"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:254,columnNumber:17},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:252,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:250,columnNumber:13},void 0),e.jsxDEV("div",{className:P.statItem,children:[e.jsxDEV(gt,{size:14,className:P.statIcon,style:{color:"#22c55e"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:259,columnNumber:15},void 0),e.jsxDEV("div",{className:P.statContent,children:[e.jsxDEV("div",{className:P.statValue,children:pe},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:261,columnNumber:17},void 0),e.jsxDEV("div",{className:P.statLabel,children:"ƒê·∫°t chu·∫©n"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:262,columnNumber:17},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:260,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:258,columnNumber:13},void 0),e.jsxDEV("div",{className:P.statItem,children:[e.jsxDEV(Cn,{size:14,className:P.statIcon,style:{color:"#ef4444"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:267,columnNumber:15},void 0),e.jsxDEV("div",{className:P.statContent,children:[e.jsxDEV("div",{className:P.statValue,children:xe},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:269,columnNumber:17},void 0),e.jsxDEV("div",{className:P.statLabel,children:"Vi ph·∫°m"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:270,columnNumber:17},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:268,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:266,columnNumber:13},void 0),ne&&e.jsxDEV("div",{className:P.statItem,children:[e.jsxDEV(Tn,{size:14,className:P.statIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:276,columnNumber:17},void 0),e.jsxDEV("div",{className:P.statContent,children:[e.jsxDEV("div",{className:P.statValue,children:ne.toFixed(2)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:278,columnNumber:19},void 0),e.jsxDEV("div",{className:P.statLabel,children:"km¬≤"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:279,columnNumber:19},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:277,columnNumber:17},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:275,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:249,columnNumber:11},void 0),e.jsxDEV("div",{className:P.additionalStats,children:[e.jsxDEV("div",{className:P.smallStat,children:[e.jsxDEV("span",{className:P.smallStatLabel,children:"S·∫Øp ki·ªÉm tra:"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:288,columnNumber:15},void 0),e.jsxDEV("span",{className:P.smallStatValue,children:S},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:289,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:287,columnNumber:13},void 0),e.jsxDEV("div",{className:P.smallStat,children:[e.jsxDEV("span",{className:P.smallStatLabel,children:"ƒê√£ ki·ªÉm tra:"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:292,columnNumber:15},void 0),e.jsxDEV("span",{className:P.smallStatValue,children:G},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:293,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:291,columnNumber:13},void 0),e.jsxDEV("div",{className:P.smallStat,children:[e.jsxDEV("span",{className:P.smallStatLabel,children:"T·ªïng d√¢n s·ªë:"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:296,columnNumber:15},void 0),e.jsxDEV("span",{className:P.smallStatValue,children:ie(Y)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:297,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:295,columnNumber:13},void 0),e.jsxDEV("div",{className:P.smallStat,children:[e.jsxDEV("span",{className:P.smallStatLabel,children:"TB d√¢n s·ªë/h·ªô:"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:300,columnNumber:15},void 0),e.jsxDEV("span",{className:P.smallStatValue,children:ie(Te)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:301,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:299,columnNumber:13},void 0),e.jsxDEV("div",{className:P.smallStat,children:[e.jsxDEV("span",{className:P.smallStatLabel,children:"∆Ø·ªõc l∆∞·ª£ng h·ªô d√¢n:"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:304,columnNumber:15},void 0),e.jsxDEV("span",{className:P.smallStatValue,children:ie(A)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:305,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:303,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:286,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:194,columnNumber:9},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/LocationStatsCard.tsx",lineNumber:179,columnNumber:7},void 0)});Kt.displayName="LocationStatsCard";const Br="_legend_1bkx5_5",Rr="_legendItems_1bkx5_22",Or="_legendItem_1bkx5_22",zr="_marker_1bkx5_37",Fr="_label_1bkx5_45",$r="_count_1bkx5_53",qr="_closeBtn_1bkx5_62",Fe={legend:Br,legendItems:Rr,legendItem:Or,marker:zr,label:Fr,count:$r,closeBtn:qr},Zt=It.forwardRef(({categoryData:t,onClose:s},n)=>e.jsxDEV("div",{className:Fe.legend,ref:n,children:[e.jsxDEV("div",{className:Fe.legendItems,children:t.map(({key:o,label:a,color:m,count:i})=>e.jsxDEV("div",{className:Fe.legendItem,children:[e.jsxDEV("div",{className:Fe.marker,style:{background:m}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapLegend.tsx",lineNumber:22,columnNumber:15},void 0),e.jsxDEV("span",{className:Fe.label,children:a},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapLegend.tsx",lineNumber:26,columnNumber:15},void 0),e.jsxDEV("span",{className:Fe.count,children:["(",i,")"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapLegend.tsx",lineNumber:27,columnNumber:15},void 0)]},o,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapLegend.tsx",lineNumber:21,columnNumber:13},void 0))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapLegend.tsx",lineNumber:19,columnNumber:9},void 0),e.jsxDEV("button",{className:Fe.closeBtn,onClick:s,"aria-label":"ƒê√≥ng ch√∫ gi·∫£i",title:"ƒê√≥ng ch√∫ gi·∫£i",children:e.jsxDEV(ge,{size:16,strokeWidth:2},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapLegend.tsx",lineNumber:37,columnNumber:11},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapLegend.tsx",lineNumber:31,columnNumber:9},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/MapLegend.tsx",lineNumber:18,columnNumber:7},void 0));Zt.displayName="MapLegend";function Ur({isOpen:t,onClose:s,filters:n,businessTypeFilters:o,searchQuery:a,selectedRestaurant:m,selectedProvince:i,selectedDistrict:r,selectedWard:d,restaurants:u,allRestaurants:h,pointStatuses:v,categories:H,merchantStats:b,divisionId:f,teamId:g,onPointClick:E,onFilterChange:V,onBusinessTypeFilterChange:Q,onBusinessTypeToggleAll:C,onProvinceChange:w,onDistrictChange:z,onWardChange:U}){const[J,fe]=l.useState(!1),[ae,q]=l.useState(!0),[X,re]=l.useState(!0),de=l.useRef(null),ne=l.useRef(null),se=l.useRef(null),pe=l.useRef(null),xe=l.useRef(null),S=u.length,G=l.useMemo(()=>!u||u.length===0?[]:u,[u]),Y=l.useMemo(()=>{const ie=h||u;return!ie||ie.length===0?[]:i||r||d?ie.filter(Z=>!(i&&Z.province!==i||r&&Z.district!==r||d&&Z.ward!==d)):ie},[h,u,i,r,d]);l.useEffect(()=>{const ie=te=>{te.key==="Escape"&&t&&s()};return document.addEventListener("keydown",ie),()=>document.removeEventListener("keydown",ie)},[t,s]),l.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),l.useEffect(()=>{const ie=te=>{var j,y,W,R,c;if(!J)return;const Z=te.target;if((j=de.current)!=null&&j.contains(Z)||(y=ne.current)!=null&&y.contains(Z)||(W=se.current)!=null&&W.contains(Z)||(R=pe.current)!=null&&R.contains(Z))return;const Ne=te.target;Ne.closest('[class*="marker"]')||Ne.closest('[class*="point"]')||Ne.closest(".leaflet-marker-icon")||Ne.closest(".leaflet-popup")||((c=xe.current)!=null&&c.contains(Z)||te.target.classList.contains(be.overlay)||te.target.classList.contains(be.mapWrapper))&&fe(!1)};return J&&document.addEventListener("mousedown",ie),()=>{document.removeEventListener("mousedown",ie)}},[J]),l.useEffect(()=>{(i||r||d)&&q(!0)},[i,r,d]),l.useEffect(()=>{Object.values(o).some(te=>te)&&q(!0)},[o]);const Te={certified:"#22c55e",hotspot:"#ef4444",scheduled:"#f59e0b",inspected:"#005cb6"},A=v.map(ie=>({key:ie.code,label:ie.name,color:Te[ie.code]||"#005cb6",count:G.filter(te=>te.category===ie.code).length}));return t?e.jsxDEV("div",{className:be.overlay,children:e.jsxDEV("div",{className:be.container,children:[X&&e.jsxDEV(Zt,{categoryData:A,onClose:()=>re(!1),ref:se},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:241,columnNumber:11},this),e.jsxDEV("button",{className:be.closeBtn,onClick:s,"aria-label":"ƒê√≥ng",children:e.jsxDEV(ge,{size:20},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:254,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:249,columnNumber:9},this),e.jsxDEV("div",{className:be.mapWrapper,ref:xe,children:[e.jsxDEV(Kt,{selectedProvince:i,selectedDistrict:r,selectedWard:d,filteredRestaurants:Y,businessTypeFilters:o,categories:H,merchantStats:b,divisionId:f,teamId:g,onClose:()=>{w(""),z(""),U("")},isVisible:ae,onVisibilityChange:q,isFullscreen:!0,ref:pe},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:260,columnNumber:11},this),e.jsxDEV(Wt,{filters:n,businessTypeFilters:o,searchQuery:a,selectedRestaurant:m,selectedProvince:i,selectedDistrict:r,selectedWard:d,restaurants:G,onPointClick:E},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:282,columnNumber:11},this),e.jsxDEV(Gt,{isOpen:J,filters:n,businessTypeFilters:o,restaurants:h||u,pointStatuses:v,categories:H,selectedProvince:i,selectedDistrict:r,selectedWard:d,onFilterChange:V,onBusinessTypeFilterChange:Q,onBusinessTypeToggleAll:C,onProvinceChange:w,onDistrictChange:z,onWardChange:U,filteredCount:S,onClose:()=>fe(!1),ref:de},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:295,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:258,columnNumber:9},this),e.jsxDEV("div",{className:be.filterPanelWrapper,children:[e.jsxDEV("button",{className:be.legendToggleBtn,onClick:()=>re(!X),"aria-label":"M·ªü/ƒê√≥ng ch√∫ gi·∫£i",title:"Ch√∫ gi·∫£i b·∫£n ƒë·ªì",children:e.jsxDEV(De,{size:20,strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:326,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:320,columnNumber:11},this),e.jsxDEV("button",{className:be.statsToggleBtn,onClick:()=>q(!ae),"aria-label":"M·ªü/ƒê√≥ng th·ªëng k√™",title:"Th·ªëng k√™ ƒë·ªãa b√†n",children:e.jsxDEV(at,{size:20,strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:336,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:330,columnNumber:11},this),e.jsxDEV("button",{className:be.filterToggleBtn,onClick:()=>fe(!J),"aria-label":"M·ªü/ƒê√≥ng b·ªô l·ªçc",ref:ne,children:e.jsxDEV($t,{size:20,strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:346,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:340,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:318,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:238,columnNumber:7},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenMapModal.tsx",lineNumber:237,columnNumber:5},this):null}const Wr="_searchContainer_8eyh5_11",Gr="_searchIcon_8eyh5_23",Kr="_searchInput_8eyh5_41",Zr="_loadingState_8eyh5_73",Yr="_teamsListContainer_8eyh5_91",Xr="_departmentItem_8eyh5_105",Jr="_departmentItemSelected_8eyh5_143",ec="_checkbox_8eyh5_165",tc="_checkboxSelected_8eyh5_189",nc="_icon_8eyh5_201",ac="_iconDefault_8eyh5_209",sc="_iconSelected_8eyh5_217",ic="_departmentContent_8eyh5_227",oc="_departmentTitle_8eyh5_237",lc="_departmentTitleSelected_8eyh5_251",rc="_departmentSubtitle_8eyh5_261",cc="_departmentName_8eyh5_271",mc="_departmentNameSelected_8eyh5_291",pc="_emptyState_8eyh5_303",dc="_teamsListScroll_8eyh5_321",le={searchContainer:Wr,searchIcon:Gr,searchInput:Kr,loadingState:Zr,teamsListContainer:Yr,departmentItem:Xr,departmentItemSelected:Jr,checkbox:ec,checkboxSelected:tc,icon:nc,iconDefault:ac,iconSelected:sc,departmentContent:ic,departmentTitle:oc,departmentTitleSelected:lc,departmentSubtitle:rc,departmentName:cc,departmentNameSelected:mc,emptyState:pc,teamsListScroll:dc};async function uc(t){try{if(!t||typeof t!="string"||t.trim()==="")return[];const s=`${We}/departments?select=_id,name&parent_id=eq.${t}`,o=(await Le.get(s,{headers:ye()})).data||[];return Array.isArray(o)?o:[]}catch(s){throw console.error("‚ùå OfficerFilterAPI: Failed to fetch departments:",s),s}}function fc(t){var d,u;const s=st(),n=Qe(h=>h.qlttScope),o=(d=n==null?void 0:n.scope)==null?void 0:d.divisionId,a=(u=n==null?void 0:n.scope)==null?void 0:u.teamId,m=Qe(h=>h.officerFilter),i=m.departments,r=m.isLoading;return l.useEffect(()=>{if(!t)return;const h=a||o;if(!h){s(ut([]));return}const v=typeof h=="string"&&h.trim()!==""?h:"";if(!v){s(ut([]));return}async function H(){s(xa(!0));try{const b=await uc(v);s(ut(b))}catch(b){console.error("‚ùå OfficerFilterPanel: Failed to fetch departments:",b);const f=b!=null&&b.message?String(b.message):"Failed to fetch departments";s(Ta(f)),s(ut([]))}}H()},[t,a,o,s]),{departments:i,isLoadingDepartments:r}}function hc(t,s){if(!s.trim())return t;const n=s.toLowerCase();return t.filter(o=>{var a;return(a=o.name)==null?void 0:a.toLowerCase().includes(n)})}function Nc({isSelected:t,departmentCount:s,onSelect:n}){return e.jsxDEV("div",{onClick:n,className:`${le.departmentItem} ${t?le.departmentItemSelected:""}`,children:[e.jsxDEV("div",{className:`${le.checkbox} ${t?le.checkboxSelected:""}`,children:t&&e.jsxDEV(lt,{size:12,color:"white",strokeWidth:3},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/AllDepartmentsOption.tsx",lineNumber:18,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/AllDepartmentsOption.tsx",lineNumber:16,columnNumber:7},this),e.jsxDEV(we,{size:18,className:`${le.icon} ${t?le.iconSelected:le.iconDefault}`},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/AllDepartmentsOption.tsx",lineNumber:21,columnNumber:7},this),e.jsxDEV("div",{className:le.departmentContent,children:[e.jsxDEV("div",{className:`${le.departmentTitle} ${t?le.departmentTitleSelected:""}`,children:"T·∫•t c·∫£ c√°c ph√≤ng ban"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/AllDepartmentsOption.tsx",lineNumber:26,columnNumber:9},this),e.jsxDEV("div",{className:le.departmentSubtitle,children:[s," ph√≤ng ban"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/AllDepartmentsOption.tsx",lineNumber:29,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/AllDepartmentsOption.tsx",lineNumber:25,columnNumber:7},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/AllDepartmentsOption.tsx",lineNumber:12,columnNumber:5},this)}function vc({department:t,isSelected:s,onSelect:n}){return e.jsxDEV("div",{onClick:()=>n(t._id),className:`${le.departmentItem} ${s?le.departmentItemSelected:""}`,children:[e.jsxDEV("div",{className:`${le.checkbox} ${s?le.checkboxSelected:""}`,children:s&&e.jsxDEV(lt,{size:12,color:"white",strokeWidth:3},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentItem.tsx",lineNumber:19,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentItem.tsx",lineNumber:17,columnNumber:7},this),e.jsxDEV(we,{size:18,className:`${le.icon} ${s?le.iconSelected:le.iconDefault}`},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentItem.tsx",lineNumber:22,columnNumber:7},this),e.jsxDEV("div",{className:le.departmentContent,children:e.jsxDEV("div",{className:`${le.departmentName} ${s?le.departmentNameSelected:""}`,children:t.name||"Kh√¥ng c√≥ t√™n"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentItem.tsx",lineNumber:27,columnNumber:9},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentItem.tsx",lineNumber:26,columnNumber:7},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentItem.tsx",lineNumber:13,columnNumber:5},this)}function Vc({value:t,onChange:s,placeholder:n="T√¨m ki·∫øm ph√≤ng ban..."}){return e.jsxDEV("div",{className:le.searchContainer,children:[e.jsxDEV(xt,{size:16,className:le.searchIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/SearchInput.tsx",lineNumber:13,columnNumber:7},this),e.jsxDEV("input",{type:"text",placeholder:n,value:t,onChange:o=>s(o.target.value),className:le.searchInput},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/SearchInput.tsx",lineNumber:17,columnNumber:7},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/SearchInput.tsx",lineNumber:12,columnNumber:5},this)}const Yt=l.forwardRef(({isOpen:t,selectedTeamId:s,onClose:n,onTeamChange:o},a)=>{const[m,i]=l.useState(""),r=st(),{departments:d,isLoadingDepartments:u}=fc(t),h=l.useMemo(()=>hc(d,m),[m,d]);if(!t)return null;const v=H=>{r(Ea(H)),o&&o(H)};return e.jsxDEV("div",{className:L.panel,ref:a,children:[e.jsxDEV("div",{className:L.header,children:[e.jsxDEV("h3",{className:L.title,children:"B·ªô l·ªçc c√°n b·ªô qu·∫£n l√Ω"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:49,columnNumber:11},void 0),e.jsxDEV("button",{className:L.closeButton,onClick:n,"aria-label":"ƒê√≥ng",children:e.jsxDEV(ge,{size:16,strokeWidth:2},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:51,columnNumber:13},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:50,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:48,columnNumber:9},void 0),e.jsxDEV("div",{className:L.scrollableContent,children:e.jsxDEV("div",{className:L.filterSection,children:[e.jsxDEV("div",{className:L.sectionHeader,children:e.jsxDEV("div",{className:L.sectionTitle,children:"Ch·ªçn ƒë·ªôi"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:59,columnNumber:15},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:58,columnNumber:13},void 0),e.jsxDEV(Vc,{value:m,onChange:i},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:63,columnNumber:13},void 0),u&&e.jsxDEV("div",{className:le.loadingState,children:"ƒêang t·∫£i danh s√°ch ph√≤ng ban..."},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:70,columnNumber:15},void 0),e.jsxDEV("div",{className:`${le.teamsListScroll} ${le.teamsListContainer}`,children:[e.jsxDEV(Nc,{isSelected:s==="",departmentCount:d.length,onSelect:()=>v("")},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:78,columnNumber:15},void 0),!u&&h.length>0?h.map(H=>e.jsxDEV(vc,{department:H,isSelected:s===H._id,onSelect:v},H._id,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:87,columnNumber:19},void 0)):u?null:e.jsxDEV("div",{className:le.emptyState,children:"Kh√¥ng t√¨m th·∫•y ph√≤ng ban n√†o"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:95,columnNumber:17},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:76,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:57,columnNumber:11},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:55,columnNumber:9},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerFilterPanel.tsx",lineNumber:47,columnNumber:7},void 0)});Yt.displayName="OfficerFilterPanel";function Ae(t,s){return Math.floor(Math.random()*(s-t+1))+t}function bc(){const t=["091","092","093","094","095","096","097","098","099"],s=t[Math.floor(Math.random()*t.length)],n=Math.floor(1e6+Math.random()*9e6);return`${s}${n}`}function gc(t,s){const n=t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").split(" ").filter(r=>r.length>0),o=n[n.length-1],a=n[0],m=n.length>2?n[1].charAt(0):"";return m?`${o}${a.charAt(0)}${m}${s}@qltt.hanoi.gov.vn`:`${o}${a.charAt(0)}${s}@qltt.hanoi.gov.vn`}function xc(){return{totalInspections:Ae(100,200),violationsCaught:Ae(20,60),finesIssued:Ae(15,50),totalFineAmount:Ae(1e8,5e8),complaintsResolved:Ae(10,30),educationSessions:Ae(5,15)}}function Tc(){const t=["An to√†n th·ª±c ph·∫©m","H√†ng gi·∫£ h√†ng nh√°i","H√†ng h√≥a k√©m ch·∫•t l∆∞·ª£ng","Nh√£n m√°c h√†ng h√≥a","S·ªü h·ªØu tr√≠ tu·ªá","H√†ng c·∫•m","B·∫£o v·ªá ng∆∞·ªùi ti√™u d√πng","H√†ng h√≥a nh·∫≠p l·∫≠u","Ki·ªÉm tra ch·ª£ truy·ªÅn th·ªëng","An to√†n v·ªá sinh th·ª±c ph·∫©m","Qu·∫£n l√Ω gi√°","Ho·∫°t ƒë·ªông kinh doanh c√≥ ƒëi·ªÅu ki·ªán","Trang s·ª©c v√†ng b·∫°c","H√†ng th·ªß c√¥ng m·ªπ ngh·ªá","Ngu·ªìn g·ªëc xu·∫•t x·ª©"],s=Ae(2,4);return[...t].sort(()=>.5-Math.random()).slice(0,s)}function Ec(t,s){const n=["Nguy·ªÖn","Tr·∫ßn","L√™","Ph·∫°m","Ho√†ng","V≈©","ƒê·ªó","B√πi","ƒê·∫∑ng","Ng√¥","Cao","Tr·ªãnh","ƒêinh","Phan","Mai"],o=["VƒÉn","Th·ªã","Minh","H·∫£i","Lan","Anh","Tu·∫•n","H∆∞∆°ng","ƒê·ª©c","Mai","Long","Hoa","Nam","Thu","Ph∆∞∆°ng"],a=["VƒÉn","Th·ªã","ƒê·ª©c","Minh","Quang","Th·ªã","VƒÉn","Th·ªã","ƒê·ª©c","Minh"],m=n[t%n.length],i=s?["ƒê·ª©c","Minh","Tu·∫•n","Anh","H·∫£i","Long","S∆°n","Th√†nh","H√πng","Ki√™n"][t%10]:o[t*3%o.length],r=a[t*2%a.length];return`${m} ${r} ${i}`}function Hc(){const t=[];return Object.keys(Hn).forEach(s=>{Hn[s].forEach(n=>{t.push({name:n.name,district:n.district,province:n.province})})}),t}function Dc(){const t=Hc(),s=t.length,n=Math.ceil(s/25),o=[];let a=1,m=0;for(let i=1;i<=25;i++){const r=`TEAM${i.toString().padStart(2,"0")}`,d=`ƒê·ªôi QLTT S·ªë ${i}`,u=Ae(3,5),h=[];for(let H=0;H<u;H++){const b=H===0,f=`OFF${a.toString().padStart(4,"0")}`,g=Ec(a-1,b);h.push({id:f,fullName:g,position:b?"ƒê·ªôi tr∆∞·ªüng":"C√°n b·ªô",phone:bc(),email:gc(g,i),teamId:r,teamName:d,isTeamLeader:b,criteria:xc(),yearsOfService:Ae(3,20),specialization:Tc()}),a++}const v=t.slice(m,Math.min(m+n,s));m+=n,o.push({id:r,name:d,officers:h,managedWards:v})}return{id:"DEPT001",name:"C·ª•c QLTT TP H√† N·ªôi",teams:o}}const Pn=Dc(),wn=Pn.teams.flatMap(t=>t.officers),Rt=Pn.teams,_c="_overlay_17w56_1",yc="_header_17w56_33",Lc="_title_17w56_53",wc="_closeButton_17w56_67",jc="_content_17w56_107",Mc="_quickStats_17w56_121",Qc="_statCard_17w56_135",Cc="_statIcon_17w56_155",Sc="_statContent_17w56_165",Ic="_statValue_17w56_175",kc="_statLabel_17w56_189",Pc="_teamLeaderCard_17w56_205",Ac="_teamLeaderHeader_17w56_221",Bc="_teamLeaderName_17w56_241",Rc="_teamLeaderContact_17w56_253",Oc="_metricsSection_17w56_265",zc="_metricRow_17w56_277",Fc="_metricIcon_17w56_297",$c="_metricLabel_17w56_307",qc="_metricValue_17w56_319",O={overlay:_c,header:yc,title:Lc,closeButton:wc,content:jc,quickStats:Mc,statCard:Qc,statIcon:Cc,statContent:Sc,statValue:Ic,statLabel:kc,teamLeaderCard:Pc,teamLeaderHeader:Ac,teamLeaderName:Bc,teamLeaderContact:Rc,metricsSection:Oc,metricRow:zc,metricIcon:Fc,metricLabel:$c,metricValue:qc};function An({selectedTeamId:t,isVisible:s=!0,onClose:n}){const o=Rt.find(m=>m.id===t),a=l.useMemo(()=>{const m=t&&o?[o]:Rt,i=m.flatMap(E=>E.officers),r=i.reduce((E,V)=>E+V.criteria.totalInspections,0),d=i.reduce((E,V)=>E+V.criteria.violationsCaught,0),u=i.reduce((E,V)=>E+V.criteria.finesIssued,0),h=i.reduce((E,V)=>E+V.criteria.totalFineAmount,0),v=i.reduce((E,V)=>E+V.criteria.complaintsResolved,0),H=i.reduce((E,V)=>E+V.criteria.educationSessions,0),b=new Set,f=new Set;m.forEach(E=>{E.managedWards.forEach(V=>{b.add(V.district),f.add(V.name)})});const g=o?o.officers.find(E=>E.isTeamLeader)||o.officers[0]:null;return{totalTeams:m.length,totalOfficers:i.length,teamLeader:g,totalWards:f.size,totalDistricts:b.size,totalInspections:r,totalViolations:d,totalFines:u,totalFineAmount:h,totalComplaints:v,totalEducationSessions:H,violationRate:r>0?(d/r*100).toFixed(1):"0",avgFineAmount:u>0?(h/u).toFixed(0):"0"}},[t,o]);return s?e.jsxDEV("div",{className:O.overlay,children:[e.jsxDEV("div",{className:O.header,children:[e.jsxDEV("h3",{className:O.title,children:t?"Th·ªëng k√™ ƒë·ªôi":"Th·ªëng k√™ t·ªïng quan"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:68,columnNumber:9},this),n&&e.jsxDEV("button",{className:O.closeButton,onClick:n,"aria-label":"ƒê√≥ng",children:e.jsxDEV(ge,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:73,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:72,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:67,columnNumber:7},this),e.jsxDEV("div",{className:O.content,children:[e.jsxDEV("div",{className:O.quickStats,children:[e.jsxDEV("div",{className:O.statCard,children:[e.jsxDEV(we,{size:14,className:O.statIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:82,columnNumber:13},this),e.jsxDEV("div",{className:O.statContent,children:[e.jsxDEV("div",{className:O.statValue,children:a.totalTeams},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:84,columnNumber:15},this),e.jsxDEV("div",{className:O.statLabel,children:"ƒê·ªôi"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:85,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:83,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:81,columnNumber:11},this),e.jsxDEV("div",{className:O.statCard,children:[e.jsxDEV(we,{size:14,className:O.statIcon,style:{color:"#28a745"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:90,columnNumber:13},this),e.jsxDEV("div",{className:O.statContent,children:[e.jsxDEV("div",{className:O.statValue,style:{color:"#28a745"},children:a.totalOfficers},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:92,columnNumber:15},this),e.jsxDEV("div",{className:O.statLabel,children:"C√°n b·ªô"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:95,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:91,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:89,columnNumber:11},this),e.jsxDEV("div",{className:O.statCard,children:[e.jsxDEV(De,{size:14,className:O.statIcon,style:{color:"#dc3545"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:100,columnNumber:13},this),e.jsxDEV("div",{className:O.statContent,children:[e.jsxDEV("div",{className:O.statValue,style:{color:"#dc3545"},children:a.totalWards},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:102,columnNumber:15},this),e.jsxDEV("div",{className:O.statLabel,children:"ƒê·ªãa b√†n"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:105,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:101,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:99,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:80,columnNumber:9},this),a.teamLeader&&e.jsxDEV("div",{className:O.teamLeaderCard,children:[e.jsxDEV("div",{className:O.teamLeaderHeader,children:[e.jsxDEV(rt,{size:14},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:114,columnNumber:15},this),e.jsxDEV("span",{children:"ƒê·ªôi tr∆∞·ªüng"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:115,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:113,columnNumber:13},this),e.jsxDEV("div",{className:O.teamLeaderName,children:a.teamLeader.fullName},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:117,columnNumber:13},this),e.jsxDEV("div",{className:O.teamLeaderContact,children:[a.teamLeader.phone," ‚Ä¢ ",a.teamLeader.yearsOfService," nƒÉm"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:118,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:112,columnNumber:11},this),e.jsxDEV("div",{className:O.metricsSection,children:[e.jsxDEV("div",{className:O.metricRow,children:[e.jsxDEV(Oe,{size:12,className:O.metricIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:127,columnNumber:13},this),e.jsxDEV("span",{className:O.metricLabel,children:"Ki·ªÉm tra"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:128,columnNumber:13},this),e.jsxDEV("span",{className:O.metricValue,children:a.totalInspections.toLocaleString("vi-VN")},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:129,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:126,columnNumber:11},this),e.jsxDEV("div",{className:O.metricRow,children:[e.jsxDEV(Cn,{size:12,className:O.metricIcon,style:{color:"#dc3545"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:133,columnNumber:13},this),e.jsxDEV("span",{className:O.metricLabel,children:"Vi ph·∫°m"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:134,columnNumber:13},this),e.jsxDEV("span",{className:O.metricValue,style:{color:"#dc3545"},children:a.totalViolations.toLocaleString("vi-VN")},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:135,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:132,columnNumber:11},this),e.jsxDEV("div",{className:O.metricRow,children:[e.jsxDEV(Ya,{size:12,className:O.metricIcon,style:{color:"#ffc107"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:141,columnNumber:13},this),e.jsxDEV("span",{className:O.metricLabel,children:"T·ª∑ l·ªá VP"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:142,columnNumber:13},this),e.jsxDEV("span",{className:O.metricValue,style:{color:"#ffc107"},children:[a.violationRate,"%"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:143,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:140,columnNumber:11},this),e.jsxDEV("div",{className:O.metricRow,children:[e.jsxDEV(qt,{size:12,className:O.metricIcon,style:{color:"#28a745"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:149,columnNumber:13},this),e.jsxDEV("span",{className:O.metricLabel,children:"Ti·ªÅn ph·∫°t"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:150,columnNumber:13},this),e.jsxDEV("span",{className:O.metricValue,style:{color:"#28a745"},children:[(a.totalFineAmount/1e6).toFixed(1),"M"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:151,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:148,columnNumber:11},this),e.jsxDEV("div",{className:O.metricRow,children:[e.jsxDEV(Xa,{size:12,className:O.metricIcon,style:{color:"#17a2b8"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:157,columnNumber:13},this),e.jsxDEV("span",{className:O.metricLabel,children:"Khi·∫øu n·∫°i"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:158,columnNumber:13},this),e.jsxDEV("span",{className:O.metricValue,style:{color:"#17a2b8"},children:a.totalComplaints.toLocaleString("vi-VN")},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:159,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:156,columnNumber:11},this),e.jsxDEV("div",{className:O.metricRow,children:[e.jsxDEV(Ut,{size:12,className:O.metricIcon,style:{color:"#6f42c1"}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:165,columnNumber:13},this),e.jsxDEV("span",{className:O.metricLabel,children:"T·∫≠p hu·∫•n"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:166,columnNumber:13},this),e.jsxDEV("span",{className:O.metricValue,style:{color:"#6f42c1"},children:a.totalEducationSessions.toLocaleString("vi-VN")},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:167,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:164,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:125,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:78,columnNumber:7},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerStatsOverlay.tsx",lineNumber:66,columnNumber:5},this):null}function Uc({isOpen:t,onClose:s,selectedTeamId:n,onTeamChange:o,onWardClick:a}){const[m,i]=l.useState(!1),[r,d]=l.useState(!0),u=l.useRef(null),h=l.useRef(null),v=l.useRef(null),H=l.useRef(null);return l.useEffect(()=>{const b=f=>{f.key==="Escape"&&t&&s()};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[t,s]),l.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),l.useEffect(()=>{const b=f=>{var V,Q,C,w;if(!m)return;const g=f.target;if((V=u.current)!=null&&V.contains(g)||(Q=h.current)!=null&&Q.contains(g)||(C=v.current)!=null&&C.contains(g))return;const E=f.target;E.closest('[class*="marker"]')||E.closest('[class*="point"]')||E.closest(".leaflet-marker-icon")||E.closest(".leaflet-popup")||((w=H.current)!=null&&w.contains(g)||f.target.classList.contains(be.overlay)||f.target.classList.contains(be.mapWrapper))&&i(!1)};return m&&document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[m]),t?e.jsxDEV("div",{className:be.overlay,children:e.jsxDEV("div",{className:be.container,children:[e.jsxDEV("button",{className:be.closeBtn,onClick:s,"aria-label":"ƒê√≥ng",children:e.jsxDEV(ge,{size:20},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:117,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:112,columnNumber:9},this),e.jsxDEV("div",{className:be.mapWrapper,ref:H,children:[e.jsxDEV("div",{ref:v,children:e.jsxDEV(An,{selectedTeamId:n,isVisible:r,onClose:()=>d(!1)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:124,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:123,columnNumber:11},this),e.jsxDEV(Wt,{filters:{certified:!1,hotspot:!1,scheduled:!1,inspected:!1},businessTypeFilters:{},searchQuery:"",restaurants:[],showWardBoundaries:!0,showMerchants:!1,selectedTeamId:n,onWardClick:a},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:131,columnNumber:11},this),e.jsxDEV(Yt,{isOpen:m,selectedTeamId:n,onClose:()=>i(!1),onTeamChange:b=>{o&&o(b)},ref:u},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:143,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:121,columnNumber:9},this),e.jsxDEV("div",{className:be.filterPanelWrapper,children:[e.jsxDEV("button",{className:be.statsToggleBtn,onClick:()=>d(!r),"aria-label":"M·ªü/ƒê√≥ng th·ªëng k√™ c√°n b·ªô",title:"Th·ªëng k√™ c√°n b·ªô qu·∫£n l√Ω",children:e.jsxDEV(at,{size:20,strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:165,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:159,columnNumber:11},this),e.jsxDEV("button",{className:be.filterToggleBtn,onClick:()=>i(!m),"aria-label":"M·ªü/ƒê√≥ng b·ªô l·ªçc c√°n b·ªô",ref:h,children:e.jsxDEV($t,{size:20,strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:175,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:169,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:157,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:110,columnNumber:7},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/FullscreenOfficerMapModal.tsx",lineNumber:109,columnNumber:5},this):null}function Wc({isOpen:t,onClose:s,officer:n,wardName:o}){if(!t||!n)return null;const a=n.criteria.totalInspections>0?(n.criteria.violationsCaught/n.criteria.totalInspections*100).toFixed(1):"0",m=n.criteria.finesIssued>0?(n.criteria.finesIssued/n.criteria.violationsCaught*100).toFixed(1):"0",i=u=>{u.stopPropagation(),s()},r=u=>{u.stopPropagation()},d=u=>{u.stopPropagation(),s()};return e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(4px)",zIndex:9998,animation:"fadeIn 0.2s ease-out"},onClick:i},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:44,columnNumber:7},this),e.jsxDEV("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"var(--card)",borderRadius:"var(--radius-xl)",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",width:"95%",maxWidth:"800px",maxHeight:"90vh",overflow:"hidden",zIndex:9999,animation:"slideUpFade 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",display:"flex",flexDirection:"column",fontFamily:"Inter, sans-serif"},onClick:r,children:[e.jsxDEV("div",{style:{background:"linear-gradient(135deg, var(--color-primary) 0%, #003d82 100%)",padding:"var(--spacing-5)",position:"relative"},children:[e.jsxDEV("button",{type:"button",onClick:d,style:{position:"absolute",top:"var(--spacing-3)",right:"var(--spacing-3)",background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"var(--radius-full)",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s",color:"white",zIndex:10},onMouseOver:u=>{u.currentTarget.style.background="rgba(255, 255, 255, 0.3)",u.currentTarget.style.transform="rotate(90deg) scale(1.1)"},onMouseOut:u=>{u.currentTarget.style.background="rgba(255, 255, 255, 0.2)",u.currentTarget.style.transform="rotate(0deg) scale(1)"},children:e.jsxDEV(ge,{size:18,strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:117,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:88,columnNumber:11},this),e.jsxDEV("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-4)"},children:[e.jsxDEV("div",{style:{width:"70px",height:"70px",borderRadius:"var(--radius-full)",background:"linear-gradient(135deg, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0.15) 100%)",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid rgba(255, 255, 255, 0.3)",flexShrink:0},children:e.jsxDEV(et,{size:35,color:"white",strokeWidth:1.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:133,columnNumber:15},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:122,columnNumber:13},this),e.jsxDEV("div",{style:{flex:1},children:[e.jsxDEV("h2",{style:{margin:0,fontSize:"var(--font-size-xl)",fontWeight:"var(--font-weight-bold)",color:"white",marginBottom:"var(--spacing-1)"},children:n.fullName},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:138,columnNumber:15},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-sm)",color:"rgba(255, 255, 255, 0.9)",marginBottom:"var(--spacing-1)"},children:n.position},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:148,columnNumber:15},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-xs)",color:"rgba(255, 255, 255, 0.8)",display:"flex",alignItems:"center",gap:"var(--spacing-1)"},children:[e.jsxDEV(De,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:163,columnNumber:17},this),o," ‚Ä¢ Qu·∫≠n ",n.district," ‚Ä¢ ",n.yearsOfService," nƒÉm kinh nghi·ªám"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:156,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:137,columnNumber:13},this),e.jsxDEV("div",{style:{display:"flex",gap:"var(--spacing-3)",flexShrink:0},children:[e.jsxDEV("div",{style:{background:"rgba(255,255,255,0.15)",borderRadius:"var(--radius-md)",padding:"var(--spacing-2) var(--spacing-3)",textAlign:"center"},children:[e.jsxDEV("div",{style:{fontSize:"var(--font-size-lg)",fontWeight:"var(--font-weight-bold)",color:"white"},children:[a,"%"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:180,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"10px",color:"rgba(255,255,255,0.8)"},children:"Ph√°t hi·ªán"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:183,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:174,columnNumber:15},this),e.jsxDEV("div",{style:{background:"rgba(255,255,255,0.15)",borderRadius:"var(--radius-md)",padding:"var(--spacing-2) var(--spacing-3)",textAlign:"center"},children:[e.jsxDEV("div",{style:{fontSize:"var(--font-size-lg)",fontWeight:"var(--font-weight-bold)",color:"white"},children:[m,"%"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:194,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"10px",color:"rgba(255,255,255,0.8)"},children:"X·ª≠ ph·∫°t"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:197,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:188,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:169,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:120,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:82,columnNumber:9},this),e.jsxDEV("div",{style:{flex:1,overflow:"auto",padding:"var(--spacing-5)"},children:[e.jsxDEV("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"var(--spacing-4)",marginBottom:"var(--spacing-5)"},children:[e.jsxDEV("div",{children:[e.jsxDEV("h3",{style:{margin:"0 0 var(--spacing-3) 0",fontSize:"var(--font-size-base)",fontWeight:"var(--font-weight-semibold)",color:"var(--color-text)",display:"flex",alignItems:"center",gap:"var(--spacing-2)"},children:[e.jsxDEV(tt,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:229,columnNumber:17},this),"Li√™n h·ªá"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:220,columnNumber:15},this),e.jsxDEV("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-2)"},children:[e.jsxDEV("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-2)",padding:"var(--spacing-2)",background:"var(--color-background-muted)",borderRadius:"var(--radius-md)",fontSize:"var(--font-size-sm)"},children:[e.jsxDEV(tt,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:243,columnNumber:19},this),e.jsxDEV("span",{style:{fontWeight:"var(--font-weight-medium)"},children:n.phone},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:244,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:234,columnNumber:17},this),e.jsxDEV("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-2)",padding:"var(--spacing-2)",background:"var(--color-background-muted)",borderRadius:"var(--radius-md)",fontSize:"var(--font-size-xs)"},children:[e.jsxDEV(bt,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:256,columnNumber:19},this),e.jsxDEV("span",{style:{fontWeight:"var(--font-weight-medium)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.email},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:257,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:247,columnNumber:17},this),e.jsxDEV("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-2)",padding:"var(--spacing-2)",background:"var(--color-background-muted)",borderRadius:"var(--radius-md)",fontSize:"var(--font-size-sm)"},children:[e.jsxDEV(nt,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:276,columnNumber:19},this),e.jsxDEV("span",{style:{fontWeight:"var(--font-weight-medium)"},children:["M√£: ",n.id]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:277,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:267,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:233,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:219,columnNumber:13},this),e.jsxDEV("div",{children:[e.jsxDEV("h3",{style:{margin:"0 0 var(--spacing-3) 0",fontSize:"var(--font-size-base)",fontWeight:"var(--font-weight-semibold)",color:"var(--color-text)",display:"flex",alignItems:"center",gap:"var(--spacing-2)"},children:[e.jsxDEV(Ja,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:293,columnNumber:17},this),"Chuy√™n m√¥n"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:284,columnNumber:15},this),e.jsxDEV("div",{style:{display:"flex",flexDirection:"column",gap:"var(--spacing-2)"},children:n.specialization.map((u,h)=>e.jsxDEV("div",{style:{display:"flex",alignItems:"center",gap:"var(--spacing-2)",padding:"var(--spacing-2)",background:"var(--color-background-muted)",borderRadius:"var(--radius-md)",fontSize:"var(--font-size-xs)",fontWeight:"var(--font-weight-medium)",color:"var(--color-text)"},children:[e.jsxDEV(rt,{size:14,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:314,columnNumber:21},this),u]},h,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:303,columnNumber:19},this))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:297,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:283,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:212,columnNumber:11},this),e.jsxDEV("div",{children:[e.jsxDEV("h3",{style:{margin:"0 0 var(--spacing-3) 0",fontSize:"var(--font-size-base)",fontWeight:"var(--font-weight-semibold)",color:"var(--color-text)",display:"flex",alignItems:"center",gap:"var(--spacing-2)"},children:[e.jsxDEV(at,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:333,columnNumber:15},this),"K·∫øt qu·∫£ c√¥ng t√°c nƒÉm 2024"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:324,columnNumber:13},this),e.jsxDEV("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"var(--spacing-3)"},children:[e.jsxDEV("div",{style:{padding:"var(--spacing-3)",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",borderRadius:"var(--radius-md)",border:"1px solid #93c5fd",textAlign:"center"},children:[e.jsxDEV("div",{style:{width:"32px",height:"32px",borderRadius:"var(--radius-md)",background:"#3b82f6",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto var(--spacing-2)"},children:e.jsxDEV(Oe,{size:16,color:"white",strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:360,columnNumber:19},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:350,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-2xl)",fontWeight:"var(--font-weight-bold)",color:"#1e3a8a",marginBottom:"var(--spacing-1)"},children:n.criteria.totalInspections},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:362,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-xs)",color:"#1e40af",fontWeight:"var(--font-weight-medium)"},children:"L·∫ßn ki·ªÉm tra"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:370,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:343,columnNumber:15},this),e.jsxDEV("div",{style:{padding:"var(--spacing-3)",background:"linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%)",borderRadius:"var(--radius-md)",border:"1px solid #fca5a5",textAlign:"center"},children:[e.jsxDEV("div",{style:{width:"32px",height:"32px",borderRadius:"var(--radius-md)",background:"#ef4444",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto var(--spacing-2)"},children:e.jsxDEV(Ue,{size:16,color:"white",strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:397,columnNumber:19},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:387,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-2xl)",fontWeight:"var(--font-weight-bold)",color:"#991b1b",marginBottom:"var(--spacing-1)"},children:n.criteria.violationsCaught},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:399,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-xs)",color:"#b91c1c",fontWeight:"var(--font-weight-medium)"},children:"Vi ph·∫°m"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:407,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:380,columnNumber:15},this),e.jsxDEV("div",{style:{padding:"var(--spacing-3)",background:"linear-gradient(135deg, #fefce8 0%, #fef08a 100%)",borderRadius:"var(--radius-md)",border:"1px solid #fde047",textAlign:"center"},children:[e.jsxDEV("div",{style:{width:"32px",height:"32px",borderRadius:"var(--radius-md)",background:"#eab308",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto var(--spacing-2)"},children:e.jsxDEV(Oe,{size:16,color:"white",strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:434,columnNumber:19},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:424,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-2xl)",fontWeight:"var(--font-weight-bold)",color:"#854d0e",marginBottom:"var(--spacing-1)"},children:n.criteria.finesIssued},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:436,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-xs)",color:"#a16207",fontWeight:"var(--font-weight-medium)"},children:"X·ª≠ ph·∫°t"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:444,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:417,columnNumber:15},this),e.jsxDEV("div",{style:{padding:"var(--spacing-3)",background:"linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)",borderRadius:"var(--radius-md)",border:"1px solid #86efac",textAlign:"center"},children:[e.jsxDEV("div",{style:{width:"32px",height:"32px",borderRadius:"var(--radius-md)",background:"#22c55e",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto var(--spacing-2)"},children:e.jsxDEV(qt,{size:16,color:"white",strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:471,columnNumber:19},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:461,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-lg)",fontWeight:"var(--font-weight-bold)",color:"#14532d",marginBottom:"var(--spacing-1)"},children:[(n.criteria.totalFineAmount/1e6).toFixed(0),"M"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:473,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-xs)",color:"#15803d",fontWeight:"var(--font-weight-medium)"},children:"Ti·ªÅn ph·∫°t (VNƒê)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:481,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:454,columnNumber:15},this),e.jsxDEV("div",{style:{padding:"var(--spacing-3)",background:"linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%)",borderRadius:"var(--radius-md)",border:"1px solid #d8b4fe",textAlign:"center"},children:[e.jsxDEV("div",{style:{width:"32px",height:"32px",borderRadius:"var(--radius-md)",background:"#a855f7",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto var(--spacing-2)"},children:e.jsxDEV(Ot,{size:16,color:"white",strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:508,columnNumber:19},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:498,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-2xl)",fontWeight:"var(--font-weight-bold)",color:"#581c87",marginBottom:"var(--spacing-1)"},children:n.criteria.complaintsResolved},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:510,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-xs)",color:"#7e22ce",fontWeight:"var(--font-weight-medium)"},children:"Khi·∫øu n·∫°i"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:518,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:491,columnNumber:15},this),e.jsxDEV("div",{style:{padding:"var(--spacing-3)",background:"linear-gradient(135deg, #fff7ed 0%, #fed7aa 100%)",borderRadius:"var(--radius-md)",border:"1px solid #fdba74",textAlign:"center"},children:[e.jsxDEV("div",{style:{width:"32px",height:"32px",borderRadius:"var(--radius-md)",background:"#f97316",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto var(--spacing-2)"},children:e.jsxDEV(Ut,{size:16,color:"white",strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:545,columnNumber:19},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:535,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-2xl)",fontWeight:"var(--font-weight-bold)",color:"#7c2d12",marginBottom:"var(--spacing-1)"},children:n.criteria.educationSessions},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:547,columnNumber:17},this),e.jsxDEV("div",{style:{fontSize:"var(--font-size-xs)",color:"#c2410c",fontWeight:"var(--font-weight-medium)"},children:"Tuy√™n truy·ªÅn"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:555,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:528,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:337,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:323,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:206,columnNumber:9},this),e.jsxDEV("style",{children:`
            @keyframes fadeIn {
              from { opacity: 0; }
              to { opacity: 1; }
            }
            @keyframes slideUpFade {
              from {
                opacity: 0;
                transform: translate(-50%, -45%);
              }
              to {
                opacity: 1;
                transform: translate(-50%, -50%);
              }
            }
          `},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:567,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:60,columnNumber:7},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/OfficerInfoModal.tsx",lineNumber:42,columnNumber:5},this)}async function Gc(t){try{let s=qe.from("departments").select("_id, name, code, level, path, parent_id").is("deleted_at",null);const n=t!=null&&t.teamId&&typeof t.teamId=="string"&&t.teamId.trim()!==""?{type:"teamId",value:t.teamId}:t!=null&&t.divisionId&&typeof t.divisionId=="string"&&t.divisionId.trim()!==""?{type:"divisionId",value:t.divisionId}:null,o=u=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(u);let a=null;if(n)if(o(n.value))a=n,console.log(`üîç Filtering departments by ${n.type} (UUID):`,n.value);else{console.log(`‚ö†Ô∏è ${n.type} is not a UUID, searching by name:`,n.value);const{data:u,error:h}=await qe.from("departments").select("_id").eq("name",n.value).is("deleted_at",null).single();if(h||!u)return console.error(`‚ùå Department not found by name "${n.value}":`,h),[];a={type:n.type,value:u._id},console.log("‚úÖ Found department UUID:",u._id)}let m=[],i=null;if(a){const u=qe.from("departments").select("_id, name, code, level, path, parent_id").is("deleted_at",null).eq("_id",a.value),h=qe.from("departments").select("_id, name, code, level, path, parent_id").is("deleted_at",null).eq("parent_id",a.value),[v,H]=await Promise.all([u.order("name",{ascending:!0}),h.order("name",{ascending:!0})]);if(v.error)i=v.error;else if(H.error)i=H.error;else{const b=[...v.data||[],...H.data||[]],f=new Map;b.forEach(g=>{f.set(g._id,g)}),m=Array.from(f.values())}}else{console.log("üìã No filter - fetching all departments");const u=await s.select("_id, name, code, level, path, parent_id").order("name",{ascending:!0});m=u.data||[],i=u.error}if(i)throw console.error("‚ùå Error fetching market management teams:",i),new Error(`Failed to fetch departments: ${i.message}`);const r=(m||[]).map(u=>({...u,id:u._id}));let d=r||[];return n&&r&&r.length>0&&(d=r.filter(u=>u.id===n.value||u.parent_id===n.value),console.log("üîç Client-side filter applied. Before:",r.length,"After:",d.length),d.length!==r.length&&console.log("‚ö†Ô∏è Supabase .or() filter may not have worked, using client-side filter")),d}catch(s){throw console.error("‚ùå Error fetching market management teams:",s),s}}async function Kc(t){try{const s=m=>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(m);let n=t;if(!s(t)){console.log("‚ö†Ô∏è fetchDepartmentById: departmentId is not a UUID, searching by name:",t);const{data:m,error:i}=await qe.from("departments").select("_id").eq("name",t).is("deleted_at",null).single();if(i||!m)return console.error(`‚ùå fetchDepartmentById: Department not found by name "${t}":`,i),null;n=m._id,console.log("‚úÖ fetchDepartmentById: Found department UUID:",n)}const{data:o,error:a}=await qe.from("departments").select("_id, name, code, level, path, parent_id, address, latitude, longitude, created_at, updated_at").eq("_id",n).is("deleted_at",null).single();if(a)throw console.error("‚ùå Error fetching department by ID:",a),new Error(`Failed to fetch department: ${a.message}`);return o?{...o,id:o._id,_id:o._id}:null}catch(s){throw console.error("‚ùå Error fetching department by ID:",s),s}}function Zc(t){const s=t.split("").reduce((b,f)=>b+f.charCodeAt(0),0),n=["Nguy·ªÖn","Tr·∫ßn","L√™","Ph·∫°m","Ho√†ng","V≈©","ƒê·ªó","B√πi","ƒê·∫∑ng","Ng√¥","Cao","Tr·ªãnh","ƒêinh","Phan","Mai"],o=["VƒÉn","Th·ªã","Minh","H·∫£i","Lan","Anh","Tu·∫•n","H∆∞∆°ng","ƒê·ª©c","Mai","Long","Hoa","Nam","Thu","Ph∆∞∆°ng"],a=["VƒÉn","Th·ªã","ƒê·ª©c","Minh","Quang","Th·ªã","VƒÉn","Th·ªã","ƒê·ª©c","Minh"],m=3+s%3,i=[];for(let b=0;b<m;b++){const f=(s+b*7)%1e3,g=n[f%n.length],E=o[f*3%o.length],V=a[f*2%a.length],Q=`${g} ${V} ${E}`,C=["091","092","093","094","095","096","097","098","099"],w=C[f*5%C.length],z=Math.floor(1e6+f*123%9e6),U=`${w}${z}`,J=Q.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").split(" ").filter(ne=>ne.length>0),fe=J[J.length-1],ae=J[0],q=`${fe}${ae.charAt(0)}${b+1}@qltt.hanoi.gov.vn`,X=100+f%100,re=.2+f%20/100,de=.7+f%20/100;i.push({id:`OFF${String(b+1).padStart(4,"0")}`,fullName:Q,position:b===0?"ƒê·ªôi tr∆∞·ªüng":"C√°n b·ªô",phone:U,email:q,isTeamLeader:b===0,criteria:{totalInspections:X,violationsCaught:Math.floor(X*re),finesIssued:Math.floor(X*re*de),totalFineAmount:Math.floor(1e8+f*1e6%4e8),complaintsResolved:Math.floor(10+f%20),educationSessions:Math.floor(5+f%10)},yearsOfService:3+f%17,specialization:["An to√†n th·ª±c ph·∫©m","H√†ng gi·∫£ h√†ng nh√°i","H√†ng h√≥a k√©m ch·∫•t l∆∞·ª£ng","Nh√£n m√°c h√†ng h√≥a"].slice(0,2+f%3)})}const r=i.reduce((b,f)=>b+f.criteria.totalInspections,0),d=i.reduce((b,f)=>b+f.criteria.violationsCaught,0),u=i.reduce((b,f)=>b+f.criteria.finesIssued,0),h=i.reduce((b,f)=>b+f.criteria.totalFineAmount,0),v=i.reduce((b,f)=>b+f.criteria.complaintsResolved,0),H=i.reduce((b,f)=>b+f.criteria.educationSessions,0);return{officers:i,statistics:{totalInspections:r,totalViolations:d,totalFines:u,totalFineAmount:h,totalComplaints:v,totalEducation:H,successRate:r>0?(d/r*100).toFixed(1):"0",resolutionRate:d>0?(u/d*100).toFixed(1):"0"},contact:{phone:`024${Math.floor(3e6+s%1e6)}`,email:`dept${s%100}@qltt.hanoi.gov.vn`,address:`S·ªë ${10+s%90}, Ph·ªë ${["H√†ng","L√Ω Th∆∞·ªùng Ki·ªát","Tr·∫ßn Ph√∫","Nguy·ªÖn Tr√£i","L√™ Du·∫©n"][s%5]}, Qu·∫≠n ${["Ho√†n Ki·∫øm","Ba ƒê√¨nh","ƒê·ªëng ƒêa","Hai B√† Tr∆∞ng","C·∫ßu Gi·∫•y"][s%5]}, H√† N·ªôi`}}}const Yc="_backdrop_swiqm_5",Xc="_fadeIn_swiqm_1",Jc="_modal_swiqm_29",em="_slideUpFade_swiqm_1",tm="_header_swiqm_67",nm="_closeButton_swiqm_79",am="_headerContent_swiqm_125",sm="_avatar_swiqm_137",im="_departmentInfo_swiqm_161",om="_departmentTitle_swiqm_169",lm="_departmentSubtitle_swiqm_185",rm="_departmentsByWardHeader_swiqm_197",cm="_departmentsByWardText_swiqm_221",mm="_departmentMeta_swiqm_233",pm="_quickStats_swiqm_249",dm="_statBadge_swiqm_261",um="_statValue_swiqm_275",fm="_statLabel_swiqm_287",hm="_content_swiqm_297",Nm="_loadingState_swiqm_309",vm="_errorState_swiqm_311",Vm="_infoGrid_swiqm_337",bm="_section_swiqm_351",gm="_sectionTitle_swiqm_359",xm="_infoList_swiqm_379",Tm="_infoItem_swiqm_391",Em="_infoItemSmall_swiqm_411",Hm="_infoItemText_swiqm_419",Dm="_infoItemTextEllipsis_swiqm_427",_m="_infoItemAddress_swiqm_441",ym="_infoItemAddressIcon_swiqm_461",Lm="_officersSection_swiqm_471",wm="_officersList_swiqm_479",jm="_wardDepartmentGroup_swiqm_497",Mm="_wardHeader_swiqm_513",Qm="_wardName_swiqm_531",Cm="_wardDeptCount_swiqm_543",Sm="_departmentsList_swiqm_555",Im="_departmentItem_swiqm_567",km="_departmentItemMain_swiqm_587",Pm="_departmentName_swiqm_599",Am="_departmentType_swiqm_611",Bm="_departmentUserCount_swiqm_623",Rm="_departmentUsersList_swiqm_635",Om="_departmentUserItem_swiqm_653",zm="_departmentUserName_swiqm_673",Fm="_departmentUserMore_swiqm_683",$m="_officerItem_swiqm_697",qm="_officerInfo_swiqm_719",Um="_officerDetails_swiqm_733",Wm="_officerName_swiqm_741",Gm="_officerMeta_swiqm_753",Km="_officerStats_swiqm_769",Zm="_officerStatItem_swiqm_783",Ym="_officerStatValue_swiqm_791",Xm="_officerStatValuePrimary_swiqm_799",Jm="_officerStatValueDanger_swiqm_807",ep="_metricsGrid_swiqm_815",tp="_metricCard_swiqm_827",np="_metricCardBlue_swiqm_839",ap="_metricCardRed_swiqm_849",sp="_metricCardPurple_swiqm_859",ip="_metricCardYellow_swiqm_869",op="_metricCardGreen_swiqm_879",lp="_metricCardOrange_swiqm_889",rp="_metricIcon_swiqm_899",cp="_metricIconBlue_swiqm_919",mp="_metricIconRed_swiqm_927",pp="_metricIconPurple_swiqm_935",dp="_metricIconYellow_swiqm_943",up="_metricIconGreen_swiqm_951",fp="_metricIconOrange_swiqm_959",hp="_metricValue_swiqm_967",Np="_metricValueBlue_swiqm_979",vp="_metricValueRed_swiqm_987",Vp="_metricValuePurple_swiqm_995",bp="_metricValueYellow_swiqm_1003",gp="_metricValueGreen_swiqm_1011",xp="_metricValueOrange_swiqm_1019",Tp="_metricValueLarge_swiqm_1027",Ep="_metricLabel_swiqm_1035",Hp="_metricLabelBlue_swiqm_1045",Dp="_metricLabelRed_swiqm_1053",_p="_metricLabelPurple_swiqm_1061",yp="_metricLabelYellow_swiqm_1069",Lp="_metricLabelGreen_swiqm_1077",wp="_metricLabelOrange_swiqm_1085",T={backdrop:Yc,fadeIn:Xc,modal:Jc,slideUpFade:em,header:tm,closeButton:nm,headerContent:am,avatar:sm,departmentInfo:im,departmentTitle:om,departmentSubtitle:lm,departmentsByWardHeader:rm,departmentsByWardText:cm,departmentMeta:mm,quickStats:pm,statBadge:dm,statValue:um,statLabel:fm,content:hm,loadingState:Nm,errorState:vm,infoGrid:Vm,section:bm,sectionTitle:gm,infoList:xm,infoItem:Tm,infoItemSmall:Em,infoItemText:Hm,infoItemTextEllipsis:Dm,infoItemAddress:_m,infoItemAddressIcon:ym,officersSection:Lm,officersList:wm,wardDepartmentGroup:jm,wardHeader:Mm,wardName:Qm,wardDeptCount:Cm,departmentsList:Sm,departmentItem:Im,departmentItemMain:km,departmentName:Pm,departmentType:Am,departmentUserCount:Bm,departmentUsersList:Rm,departmentUserItem:Om,departmentUserName:zm,departmentUserMore:Fm,officerItem:$m,officerInfo:qm,officerDetails:Um,officerName:Wm,officerMeta:Gm,officerStats:Km,officerStatItem:Zm,officerStatValue:Ym,officerStatValuePrimary:Xm,officerStatValueDanger:Jm,metricsGrid:ep,metricCard:tp,metricCardBlue:np,metricCardRed:ap,metricCardPurple:sp,metricCardYellow:ip,metricCardGreen:op,metricCardOrange:lp,metricIcon:rp,metricIconBlue:cp,metricIconRed:mp,metricIconPurple:pp,metricIconYellow:dp,metricIconGreen:up,metricIconOrange:fp,metricValue:hp,metricValueBlue:Np,metricValueRed:vp,metricValuePurple:Vp,metricValueYellow:bp,metricValueGreen:gp,metricValueOrange:xp,metricValueLarge:Tp,metricLabel:Ep,metricLabelBlue:Hp,metricLabelRed:Dp,metricLabelPurple:_p,metricLabelYellow:yp,metricLabelGreen:Lp,metricLabelOrange:wp};function Xe({icon:t,value:s,label:n,variant:o,valueSize:a="normal"}){const m=`${T.metricCard} ${T[`metricCard${o.charAt(0).toUpperCase()+o.slice(1)}`]}`,i=`${T.metricIcon} ${T[`metricIcon${o.charAt(0).toUpperCase()+o.slice(1)}`]}`,r=`${T.metricValue} ${T[`metricValue${o.charAt(0).toUpperCase()+o.slice(1)}`]} ${a==="large"?T.metricValueLarge:""}`,d=`${T.metricLabel} ${T[`metricLabel${o.charAt(0).toUpperCase()+o.slice(1)}`]}`;return e.jsxDEV("div",{className:m,children:[e.jsxDEV("div",{className:i,children:e.jsxDEV(t,{size:16,color:"white",strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentMetricCard.tsx",lineNumber:28,columnNumber:9},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentMetricCard.tsx",lineNumber:27,columnNumber:7},this),e.jsxDEV("div",{className:r,children:s},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentMetricCard.tsx",lineNumber:30,columnNumber:7},this),e.jsxDEV("div",{className:d,children:n},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentMetricCard.tsx",lineNumber:33,columnNumber:7},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentMetricCard.tsx",lineNumber:26,columnNumber:5},this)}function jp({name:t,details:s,email:n,phone:o}){const a=s&&typeof s=="object"&&"_id"in s&&!("position"in s),m=s&&typeof s=="object"&&"position"in s;return e.jsxDEV("div",{className:T.officerItem,children:[e.jsxDEV("div",{className:T.officerInfo,children:[e.jsxDEV(rt,{size:14,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:21,columnNumber:9},this),e.jsxDEV("div",{className:T.officerDetails,children:[e.jsxDEV("div",{className:T.officerName,children:t},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:23,columnNumber:11},this),a&&e.jsxDEV("div",{className:T.officerMeta,children:[n&&e.jsxDEV("span",{children:n},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:28,columnNumber:25},this),n&&o&&e.jsxDEV("span",{children:"‚Ä¢"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:29,columnNumber:34},this),o&&e.jsxDEV("span",{children:o},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:30,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:27,columnNumber:13},this),m&&e.jsxDEV("div",{className:T.officerMeta,children:[e.jsxDEV("span",{children:s.position},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:35,columnNumber:15},this),e.jsxDEV("span",{children:"‚Ä¢"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:36,columnNumber:15},this),e.jsxDEV("span",{children:s.phone},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:37,columnNumber:15},this),e.jsxDEV("span",{children:"‚Ä¢"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:38,columnNumber:15},this),e.jsxDEV("span",{children:[s.yearsOfService," nƒÉm kinh nghi·ªám"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:39,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:34,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:22,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:20,columnNumber:7},this),m&&s.criteria&&e.jsxDEV("div",{className:T.officerStats,children:[e.jsxDEV("div",{className:T.officerStatItem,children:[e.jsxDEV("div",{className:`${T.officerStatValue} ${T.officerStatValuePrimary}`,children:s.criteria.totalInspections},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:47,columnNumber:13},this),e.jsxDEV("div",{children:"Ki·ªÉm tra"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:50,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:46,columnNumber:11},this),e.jsxDEV("div",{className:T.officerStatItem,children:[e.jsxDEV("div",{className:`${T.officerStatValue} ${T.officerStatValueDanger}`,children:s.criteria.violationsCaught},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:53,columnNumber:13},this),e.jsxDEV("div",{children:"Vi ph·∫°m"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:56,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:52,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:45,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficerItem.tsx",lineNumber:19,columnNumber:5},this)}function Mp({displayOfficers:t,isLoadingUsers:s}){return t.length===0&&!s?null:e.jsxDEV("div",{className:T.officersSection,children:[e.jsxDEV("h3",{className:T.sectionTitle,children:[e.jsxDEV(we,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficersList.tsx",lineNumber:28,columnNumber:9},this),"Danh s√°ch c√°n b·ªô (",s?"...":t.length," ng∆∞·ªùi)"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficersList.tsx",lineNumber:27,columnNumber:7},this),s?e.jsxDEV("div",{className:T.loadingState,children:"ƒêang t·∫£i danh s√°ch c√°n b·ªô..."},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficersList.tsx",lineNumber:33,columnNumber:9},this):e.jsxDEV("div",{className:T.officersList,children:t.map((n,o)=>{var a;return e.jsxDEV(jp,{name:n.name,details:n.details,email:n.email,phone:n.phone},((a=n.details)==null?void 0:a._id)||o,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficersList.tsx",lineNumber:39,columnNumber:13},this)})},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficersList.tsx",lineNumber:37,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/components/DepartmentOfficersList.tsx",lineNumber:26,columnNumber:5},this)}function Qp({isOpen:t,onClose:s,departmentId:n,departmentData:o}){var te,Z,Ne;const[a,m]=l.useState(null),[i,r]=l.useState(null),[d,u]=l.useState([]),[h,v]=l.useState(new Map),[H,b]=l.useState(new Map),[f,g]=l.useState(0),[E,V]=l.useState(!0),[Q,C]=l.useState(!1),[w,z]=l.useState(!1),[U,J]=l.useState(!1),[fe,ae]=l.useState(null);l.useEffect(()=>{if(!t||!n)return;m(null),r(null),v(new Map),b(new Map),ae(null);async function j(){V(!0),ae(null);try{const y=await Kc(n);if(m(y),!o||!o.areas||o.areas.length===0){const W=await Ds(n);W&&W.areas&&W.areas.some(R=>R.ward_id)&&r(W)}}catch(y){console.error("‚ùå Error loading department data:",y),ae((y==null?void 0:y.message)||"Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu ph√≤ng ban")}finally{V(!1)}}j()},[t,n,o]),l.useEffect(()=>{if(!t||!n){u([]),C(!1);return}u([]),C(!0);async function j(){try{console.log("üîÑ DepartmentDetailModal: Fetching users for department:",n);const y=await Ln(n);console.log("‚úÖ DepartmentDetailModal: Loaded",y.length,"users for department",n),u(y)}catch(y){console.error("‚ùå Error loading department users:",y),u([])}finally{C(!1)}}j()},[t,n]);const q=l.useCallback(async j=>{J(!0);try{const y=new Map,W=j.map(N=>Ln(N).then(x=>({deptId:N,users:x})));(await Promise.allSettled(W)).forEach(N=>{if(N.status==="fulfilled"){const{deptId:x,users:_}=N.value;_&&_.length>0&&(y.set(x,_),console.log(`‚úÖ DepartmentDetailModal: Loaded ${_.length} users for department ${x}`))}else console.error("‚ùå Error loading users for department:",N.reason)}),console.log("üìä DepartmentDetailModal: Final usersByDepartment map:",{size:y.size,entries:Array.from(y.entries()).map(([N,x])=>({deptId:N,usersCount:x.length}))});const c=new Map(y);console.log("üîÑ DepartmentDetailModal: Updating usersByDepartment state",{oldSize:H.size,newSize:c.size,willTriggerRerender:!0}),b(c),g(N=>N+1)}catch(y){console.error("‚ùå Error loading users for departments:",y)}finally{J(!1)}},[]);l.useEffect(()=>{if(!t)return;if(!i||!i.areas||i.areas.length===0){console.log("‚ö†Ô∏è DepartmentDetailModal: No areas available for fetching departments");return}if(!i.areas.some(W=>W.ward_id&&typeof W.ward_id=="string"&&W.ward_id.trim()!=="")){console.warn("‚ö†Ô∏è DepartmentDetailModal: Areas do not have valid ward_ids, skipping department fetch");return}async function y(){var W,R;z(!0);try{console.log("üîç DepartmentDetailModal: Areas data:",{hasAreas:!!i,areasCount:((W=i==null?void 0:i.areas)==null?void 0:W.length)||0,areasSample:(R=i==null?void 0:i.areas)==null?void 0:R.slice(0,2)});const c=i.areas.map(k=>{const K=k.ward_id;return console.log("üîç DepartmentDetailModal: Area ward_id:",{wardId:K,type:typeof K,hasWardId:!!K}),K}),N=Array.from(new Set(c.filter(k=>k&&typeof k=="string"&&k.trim()!=="")));if(console.log("üîç DepartmentDetailModal: Extracted ward IDs:",{allWardIdsCount:c.length,uniqueWardIdsCount:N.length,uniqueWardIds:N}),N.length===0){console.warn("‚ö†Ô∏è DepartmentDetailModal: No valid ward IDs found in areas - skipping department fetch"),z(!1);return}console.log("üîÑ DepartmentDetailModal: Fetching departments for",N.length,"wards:",N);const x=N.map(k=>Hs(k).then(K=>({wardId:k,depts:K}))),_=await Promise.allSettled(x),D=new Map;if(_.forEach((k,K)=>{if(k.status==="fulfilled"){const{wardId:F,depts:$}=k.value;console.log(`üì¶ DepartmentDetailModal: Result for ward ${F}:`,{hasDepts:!!$,deptsType:Array.isArray($)?"array":typeof $,deptsLength:Array.isArray($)?$.length:"N/A",deptsSample:Array.isArray($)&&$.length>0?$[0]:null}),$&&Array.isArray($)&&$.length>0?(D.set(F,$),console.log(`‚úÖ DepartmentDetailModal: Loaded ${$.length} departments for ward ${F}`)):console.warn(`‚ö†Ô∏è DepartmentDetailModal: No departments found for ward ${F}`)}else console.error(`‚ùå Error loading departments for ward ${N[K]}:`,k.reason)}),console.log("üìä DepartmentDetailModal: Final departmentsMap:",{size:D.size,entries:Array.from(D.entries()).map(([k,K])=>({wardId:k,deptsCount:K.length,depts:K.map(F=>({id:F._id,name:F.name,code:F.code}))}))}),D.size>0){v(D);const k=new Set;D.forEach(K=>{K.forEach(F=>{const $=F.department_id||F._id;$&&typeof $=="string"&&$.trim()!==""&&k.add($)})}),k.size>0&&(console.log("üîÑ DepartmentDetailModal: Fetching users for",k.size,"departments"),q(Array.from(k)))}else console.warn("‚ö†Ô∏è DepartmentDetailModal: No departments found for any ward")}catch(c){console.error("‚ùå Error loading departments by ward:",c)}finally{z(!1)}}y()},[t,i,q]),l.useEffect(()=>{if(o&&o.areas&&o.areas.length>0){console.log("üîç DepartmentDetailModal: Using departmentData from map:",{areasCount:o.areas.length,sample:o.areas[0]}),a||m({name:o.departmentId,_id:n});const j={areas:o.areas.map(y=>{var W,R;return{province_id:y.provinceId||"",ward_id:y.wardId||null,wards_with_coordinates:y.coordinates?{center_lat:((W=y.coordinates.center)==null?void 0:W[0])||null,center_lng:((R=y.coordinates.center)==null?void 0:R[1])||null,bounds:y.coordinates.bounds||null,area:y.coordinates.area||null,officer:y.coordinates.officer||null}:null}}).filter(y=>y.ward_id!==null&&y.ward_id!==void 0)};console.log("‚úÖ DepartmentDetailModal: Transformed areas from departmentData:",{originalCount:o.areas.length,transformedCount:j.areas.length,sample:j.areas[0]}),j.areas.length>0&&r(j)}},[o,n]);const X=l.useMemo(()=>Zc(n),[n]);l.useMemo(()=>{const j=[];return h.forEach((y,W)=>{y&&y.length>0&&j.push({wardId:W,departments:y})}),j},[h]);const re=l.useMemo(()=>{const j=[];return h.forEach(y=>{y.forEach(W=>{const R=W.department_name||W.name||W.code||"";R&&typeof R=="string"&&R.trim()!==""&&!j.includes(R)&&j.push(R)})}),console.log("üîç DepartmentDetailModal: Department names for header:",j),j},[h]);if(!t)return null;const de=((te=i==null?void 0:i.areas)==null?void 0:te.length)||0,ne=((Z=i==null?void 0:i.areas)==null?void 0:Z.filter(j=>{var y,W;return((y=j.wards_with_coordinates)==null?void 0:y.center_lat)&&((W=j.wards_with_coordinates)==null?void 0:W.center_lng)}).length)||0,se=((Ne=i==null?void 0:i.areas)==null?void 0:Ne.map(j=>{var y;return(y=j.wards_with_coordinates)==null?void 0:y.officer}).filter(j=>j!=null&&j!==""))||[],pe=Array.from(new Set(se)),xe=d.length>0?d.map(j=>({name:j.full_name||j.email||"C√°n b·ªô",isReal:!0,details:j,email:j.email,phone:j.phone})):pe.length>0?pe.map(j=>({name:j,isReal:!0})):X.officers.map(j=>({name:j.fullName,isReal:!1,details:j})),S=xe.length,G=de>0||pe.length>0,Y=G?null:X.statistics,Te=j=>{j.stopPropagation(),s()},A=j=>{j.stopPropagation()},ie=j=>{j.stopPropagation(),s()};return e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:T.backdrop,onClick:Te},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:403,columnNumber:7},this),e.jsxDEV("div",{className:T.modal,onClick:A,children:[e.jsxDEV("div",{className:T.header,children:[e.jsxDEV("button",{type:"button",onClick:ie,className:T.closeButton,children:e.jsxDEV(ge,{size:18,strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:415,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:410,columnNumber:11},this),e.jsxDEV("div",{className:T.headerContent,children:[e.jsxDEV("div",{className:T.avatar,children:e.jsxDEV(Pe,{size:35,color:"white",strokeWidth:1.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:421,columnNumber:15},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:420,columnNumber:13},this),e.jsxDEV("div",{className:T.departmentInfo,children:[e.jsxDEV("h2",{className:T.departmentTitle,children:E?"ƒêang t·∫£i...":(a==null?void 0:a.name)||"Ph√≤ng ban"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:426,columnNumber:15},this),e.jsxDEV("div",{className:T.departmentSubtitle,children:a!=null&&a.parent_id?"Ph√≤ng ban tr·ª±c thu·ªôc":"Ph√≤ng ban ch√≠nh"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:430,columnNumber:15},this),re.length>0&&e.jsxDEV("div",{className:T.departmentsByWardHeader,children:[e.jsxDEV(Pe,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:437,columnNumber:19},this),e.jsxDEV("span",{className:T.departmentsByWardText,children:re.length===1?re[0]:`${re.length} ph√≤ng ban: ${re.slice(0,2).join(", ")}${re.length>2?"...":""}`},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:438,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:436,columnNumber:17},this),e.jsxDEV("div",{className:T.departmentMeta,children:[e.jsxDEV(De,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:448,columnNumber:17},this),de," khu v·ª±c ph·ª• tr√°ch ‚Ä¢ ",S," c√°n b·ªô"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:447,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:425,columnNumber:13},this),e.jsxDEV("div",{className:T.quickStats,children:[e.jsxDEV("div",{className:T.statBadge,children:[e.jsxDEV("div",{className:T.statValue,children:de},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:456,columnNumber:17},this),e.jsxDEV("div",{className:T.statLabel,children:"Khu v·ª±c"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:459,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:455,columnNumber:15},this),e.jsxDEV("div",{className:T.statBadge,children:[e.jsxDEV("div",{className:T.statValue,children:S},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:465,columnNumber:17},this),e.jsxDEV("div",{className:T.statLabel,children:"C√°n b·ªô"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:468,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:464,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:454,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:418,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:408,columnNumber:9},this),e.jsxDEV("div",{className:T.content,children:E?e.jsxDEV("div",{className:T.loadingState,children:"ƒêang t·∫£i d·ªØ li·ªáu..."},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:479,columnNumber:13},this):fe?e.jsxDEV("div",{className:T.errorState,children:fe},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:483,columnNumber:13},this):e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:T.infoGrid,children:[e.jsxDEV("div",{className:T.section,children:[e.jsxDEV("h3",{className:T.sectionTitle,children:[e.jsxDEV(Pe,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:493,columnNumber:21},this),"Th√¥ng tin"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:492,columnNumber:19},this),e.jsxDEV("div",{className:T.infoList,children:[e.jsxDEV("div",{className:T.infoItem,children:[e.jsxDEV(Oe,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:499,columnNumber:23},this),e.jsxDEV("span",{className:T.infoItemText,children:["ID: ",n?n.substring(0,8):"N/A","..."]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:500,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:498,columnNumber:21},this),(a==null?void 0:a.name)&&e.jsxDEV("div",{className:T.infoItem,children:[e.jsxDEV(Pe,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:505,columnNumber:25},this),e.jsxDEV("span",{className:T.infoItemText,children:a.name},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:506,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:504,columnNumber:23},this),e.jsxDEV("div",{className:T.infoItem,children:[e.jsxDEV(tt,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:512,columnNumber:23},this),e.jsxDEV("span",{className:T.infoItemText,children:X.contact.phone},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:513,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:511,columnNumber:21},this),e.jsxDEV("div",{className:`${T.infoItem} ${T.infoItemSmall}`,children:[e.jsxDEV(bt,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:517,columnNumber:23},this),e.jsxDEV("span",{className:T.infoItemTextEllipsis,children:X.contact.email},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:518,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:516,columnNumber:21},this),e.jsxDEV("div",{className:T.infoItemAddress,children:[e.jsxDEV(De,{size:16,color:"var(--color-primary)",className:T.infoItemAddressIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:524,columnNumber:23},this),e.jsxDEV("span",{className:T.infoItemText,children:X.contact.address},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:525,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:523,columnNumber:21},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:497,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:491,columnNumber:17},this),e.jsxDEV("div",{className:T.section,children:[e.jsxDEV("h3",{className:T.sectionTitle,children:[e.jsxDEV(De,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:533,columnNumber:21},this),"ƒê·ªãa b√†n"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:532,columnNumber:19},this),e.jsxDEV("div",{className:T.infoList,children:[e.jsxDEV("div",{className:`${T.infoItem} ${T.infoItemSmall}`,children:[e.jsxDEV(De,{size:14,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:539,columnNumber:23},this),e.jsxDEV("span",{className:T.infoItemText,children:[de," khu v·ª±c ph·ª• tr√°ch"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:540,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:538,columnNumber:21},this),e.jsxDEV("div",{className:`${T.infoItem} ${T.infoItemSmall}`,children:[e.jsxDEV(we,{size:14,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:543,columnNumber:23},this),e.jsxDEV("span",{className:T.infoItemText,children:[S," c√°n b·ªô ph·ª• tr√°ch"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:544,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:542,columnNumber:21},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:537,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:531,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:489,columnNumber:15},this),e.jsxDEV(Mp,{displayOfficers:xe,isLoadingUsers:Q},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:551,columnNumber:15},this),(console.log("üîç DepartmentDetailModal: Rendering departments section",{departmentsByWardSize:h.size,isLoadingDepartments:w,shouldShow:h.size>0||w,entries:Array.from(h.entries()).map(([j,y])=>({wardId:j,deptsCount:(y==null?void 0:y.length)||0}))}),h.size>0||w?e.jsxDEV("div",{className:T.officersSection,children:[e.jsxDEV("h3",{className:T.sectionTitle,children:[e.jsxDEV(Pe,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:571,columnNumber:23},this),"Ph√≤ng ban qu·∫£n l√Ω theo ƒë·ªãa b√†n (",w?"...":h.size," khu v·ª±c)",U&&e.jsxDEV("span",{style:{fontSize:"12px",marginLeft:"8px",opacity:.7},children:"(ƒêang t·∫£i c√°n b·ªô...)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:574,columnNumber:25},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:570,columnNumber:21},this),w?e.jsxDEV("div",{className:T.loadingState,children:"ƒêang t·∫£i th√¥ng tin ph√≤ng ban..."},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:581,columnNumber:23},this):h.size===0?e.jsxDEV("div",{className:T.loadingState,children:"Kh√¥ng c√≥ ph√≤ng ban n√†o qu·∫£n l√Ω c√°c khu v·ª±c n√†y"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:585,columnNumber:23},this):e.jsxDEV("div",{className:T.officersList,children:Array.from(h.entries()).map(([j,y])=>{var c;console.log("üîç DepartmentDetailModal: Rendering ward",j,"with",(y==null?void 0:y.length)||0,"departments");const W=(c=i==null?void 0:i.areas)==null?void 0:c.find(N=>N.ward_id===j),R=(W==null?void 0:W.ward_id)||(j?`Ward ${j.substring(0,8)}...`:"Unknown Ward");return e.jsxDEV("div",{className:T.wardDepartmentGroup,children:[e.jsxDEV("div",{className:T.wardHeader,children:[e.jsxDEV(De,{size:14,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:599,columnNumber:31},this),e.jsxDEV("span",{className:T.wardName,children:R},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:600,columnNumber:31},this),e.jsxDEV("span",{className:T.wardDeptCount,children:["(",(y==null?void 0:y.length)||0," ph√≤ng ban)"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:601,columnNumber:31},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:598,columnNumber:29},this),e.jsxDEV("div",{className:T.departmentsList,children:(y||[]).map(N=>{const x=N.department_id||(N==null?void 0:N._id)||"unknown",_=N.department_name||(N==null?void 0:N.name)||N.department_code||(N==null?void 0:N.code)||(typeof x=="string"?x.substring(0,8):"N/A"),D=H.get(x)||[];return e.jsxDEV("div",{className:T.departmentItem,children:[e.jsxDEV("div",{className:T.departmentItemMain,children:[e.jsxDEV(Pe,{size:12,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:616,columnNumber:39},this),e.jsxDEV("span",{className:T.departmentName,children:_},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:617,columnNumber:39},this),(N==null?void 0:N.type)&&e.jsxDEV("span",{className:T.departmentType,children:["(",N.type,")"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:621,columnNumber:41},this),D.length>0&&e.jsxDEV("span",{className:T.departmentUserCount,children:["‚Ä¢ ",D.length," c√°n b·ªô"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:626,columnNumber:41},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:615,columnNumber:37},this),D.length>0&&e.jsxDEV("div",{className:T.departmentUsersList,children:[D.slice(0,3).map((k,K)=>e.jsxDEV("div",{className:T.departmentUserItem,children:[e.jsxDEV(we,{size:10,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:636,columnNumber:45},this),e.jsxDEV("span",{className:T.departmentUserName,children:k.full_name||k.email||"C√°n b·ªô"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:637,columnNumber:45},this)]},k._id||K,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:635,columnNumber:43},this)),D.length>3&&e.jsxDEV("div",{className:T.departmentUserMore,children:["+",D.length-3," c√°n b·ªô kh√°c"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:643,columnNumber:43},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:633,columnNumber:39},this)]},x,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:614,columnNumber:35},this)})},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:603,columnNumber:29},this)]},j||"unknown",!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:597,columnNumber:27},this)})},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:589,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:569,columnNumber:19},this):null),e.jsxDEV("div",{children:[e.jsxDEV("h3",{className:T.sectionTitle,children:[e.jsxDEV(at,{size:16,color:"var(--color-primary)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:666,columnNumber:19},this),G?"Th·ªëng k√™ ƒë·ªãa b√†n":"K·∫øt qu·∫£ c√¥ng t√°c nƒÉm 2024"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:665,columnNumber:17},this),e.jsxDEV("div",{className:T.metricsGrid,children:[e.jsxDEV(Xe,{icon:G?De:Oe,value:G?de:(Y==null?void 0:Y.totalInspections)||0,label:G?"T·ªïng khu v·ª±c":"L·∫ßn ki·ªÉm tra",variant:"blue"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:672,columnNumber:19},this),e.jsxDEV(Xe,{icon:G?De:Ue,value:G?ne:(Y==null?void 0:Y.totalViolations)||0,label:G?"C√≥ t·ªça ƒë·ªô":"Vi ph·∫°m",variant:"red"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:680,columnNumber:19},this),e.jsxDEV(Xe,{icon:G?we:Oe,value:G?S:(Y==null?void 0:Y.totalFines)||0,label:G?"C√°n b·ªô":"X·ª≠ ph·∫°t",variant:G?"purple":"yellow"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:688,columnNumber:19},this),!G&&Y&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Xe,{icon:qt,value:`${(Y.totalFineAmount/1e6).toFixed(0)}M`,label:"Ti·ªÅn ph·∫°t (VNƒê)",variant:"green",valueSize:"large"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:699,columnNumber:23},this),e.jsxDEV(Xe,{icon:Ot,value:Y.totalComplaints,label:"Khi·∫øu n·∫°i",variant:"purple"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:708,columnNumber:23},this),e.jsxDEV(Xe,{icon:Ut,value:Y.totalEducation,label:"Tuy√™n truy·ªÅn",variant:"orange"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:716,columnNumber:23},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:697,columnNumber:21},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:670,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:664,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:487,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:477,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:406,columnNumber:7},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DepartmentDetailModal.tsx",lineNumber:401,columnNumber:5},this)}const Cp="_container_1n2jn_5",Sp="_triggerButton_1n2jn_11",Ip="_calendarIcon_1n2jn_41",kp="_displayText_1n2jn_46",Pp="_clearIcon_1n2jn_55",Ap="_dropdown_1n2jn_69",Bp="_dropdownHeader_1n2jn_95",Rp="_dateInputs_1n2jn_108",Op="_inputGroup_1n2jn_115",zp="_label_1n2jn_121",Fp="_dateInput_1n2jn_108",$p="_quickOptions_1n2jn_166",qp="_quickButton_1n2jn_174",Up="_dropdownFooter_1n2jn_200",Wp="_cancelButton_1n2jn_208",Gp="_applyButton_1n2jn_226",Ve={container:Cp,triggerButton:Sp,calendarIcon:Ip,displayText:kp,clearIcon:Pp,dropdown:Ap,dropdownHeader:Bp,dateInputs:Rp,inputGroup:Op,label:zp,dateInput:Fp,quickOptions:$p,quickButton:qp,dropdownFooter:Up,cancelButton:Wp,applyButton:Gp},Kp=({startDate:t,endDate:s,onStartDateChange:n,onEndDateChange:o,onClear:a,onApply:m})=>{const[i,r]=l.useState(!1),d=l.useRef(null),u=l.useRef(null);l.useEffect(()=>{const b=f=>{d.current&&!d.current.contains(f.target)&&u.current&&!u.current.contains(f.target)&&r(!1)};return i&&document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[i]);const h=b=>{if(!b)return"";const f=new Date(b),g=String(f.getDate()).padStart(2,"0"),E=String(f.getMonth()+1).padStart(2,"0"),V=f.getFullYear();return`${g}/${E}/${V}`},v=()=>t&&s?`${h(t)} - ${h(s)}`:t?`T·ª´ ${h(t)}`:s?`ƒê·∫øn ${h(s)}`:"Ch·ªçn kho·∫£ng th·ªùi gian",H=t||s;return e.jsxDEV("div",{className:Ve.container,children:[e.jsxDEV("button",{ref:u,className:Ve.triggerButton,onClick:()=>r(!i),type:"button",children:[e.jsxDEV(nt,{size:16,className:Ve.calendarIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:80,columnNumber:9},void 0),e.jsxDEV("span",{className:Ve.displayText,children:v()},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:81,columnNumber:9},void 0),H&&e.jsxDEV(ge,{size:16,className:Ve.clearIcon,onClick:b=>{b.stopPropagation(),a()}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:83,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:74,columnNumber:7},void 0),i&&e.jsxDEV("div",{ref:d,className:Ve.dropdown,children:[e.jsxDEV("div",{className:Ve.dropdownHeader,children:[e.jsxDEV(nt,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:97,columnNumber:13},void 0),e.jsxDEV("span",{children:"Ch·ªçn kho·∫£ng th·ªùi gian"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:98,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:96,columnNumber:11},void 0),e.jsxDEV("div",{className:Ve.dateInputs,children:[e.jsxDEV("div",{className:Ve.inputGroup,children:[e.jsxDEV("label",{className:Ve.label,children:"T·ª´ ng√†y"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:103,columnNumber:15},void 0),e.jsxDEV("input",{type:"date",value:t,onChange:b=>n(b.target.value),max:s||void 0,className:Ve.dateInput},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:104,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:102,columnNumber:13},void 0),e.jsxDEV("div",{className:Ve.inputGroup,children:[e.jsxDEV("label",{className:Ve.label,children:"ƒê·∫øn ng√†y"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:114,columnNumber:15},void 0),e.jsxDEV("input",{type:"date",value:s,onChange:b=>o(b.target.value),min:t||void 0,className:Ve.dateInput},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:115,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:113,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:101,columnNumber:11},void 0),e.jsxDEV("div",{className:Ve.quickOptions,children:[e.jsxDEV("button",{type:"button",className:Ve.quickButton,onClick:()=>{const b=new Date().toISOString().split("T")[0];n(b),o(b),r(!1),m&&setTimeout(()=>m(),100)},children:"H√¥m nay"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:126,columnNumber:13},void 0),e.jsxDEV("button",{type:"button",className:Ve.quickButton,onClick:()=>{const b=new Date,f=new Date(b);f.setDate(b.getDate()-7),n(f.toISOString().split("T")[0]),o(b.toISOString().split("T")[0]),r(!1),m&&setTimeout(()=>m(),100)},children:"7 ng√†y qua"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:142,columnNumber:13},void 0),e.jsxDEV("button",{type:"button",className:Ve.quickButton,onClick:()=>{const b=new Date,f=new Date(b);f.setMonth(b.getMonth()-1),n(f.toISOString().split("T")[0]),o(b.toISOString().split("T")[0]),r(!1),m&&setTimeout(()=>m(),100)},children:"30 ng√†y qua"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:160,columnNumber:13},void 0),e.jsxDEV("button",{type:"button",className:Ve.quickButton,onClick:()=>{const b=new Date,f=new Date(b.getFullYear(),b.getMonth(),1);n(f.toISOString().split("T")[0]),o(b.toISOString().split("T")[0]),r(!1),m&&setTimeout(()=>m(),100)},children:"Th√°ng n√†y"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:178,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:125,columnNumber:11},void 0),e.jsxDEV("div",{className:Ve.dropdownFooter,children:[e.jsxDEV("button",{type:"button",className:Ve.cancelButton,onClick:()=>r(!1),children:"H·ªßy"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:198,columnNumber:13},void 0),e.jsxDEV("button",{type:"button",className:Ve.applyButton,onClick:()=>{m&&m(),r(!1)},children:"√Åp d·ª•ng"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:205,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:95,columnNumber:9},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/DateRangePicker.tsx",lineNumber:73,columnNumber:5},void 0)},Zp="_overlay_im2vy_3",Yp="_modal_im2vy_45",Xp="_header_im2vy_91",Jp="_title_im2vy_107",ed="_closeButton_im2vy_123",td="_content_im2vy_165",nd="_description_im2vy_173",ad="_uploadArea_im2vy_191",sd="_dragActive_im2vy_221",id="_uploadIcon_im2vy_231",od="_uploadText_im2vy_245",ld="_highlight_im2vy_259",rd="_uploadHint_im2vy_269",cd="_fileInput_im2vy_285",md="_selectedFile_im2vy_295",pd="_fileIcon_im2vy_317",dd="_fileInfo_im2vy_327",ud="_fileName_im2vy_337",fd="_fileSize_im2vy_359",hd="_removeButton_im2vy_373",Nd="_footer_im2vy_417",vd="_cancelButton_im2vy_433",Vd="_uploadButton_im2vy_435",ve={overlay:Zp,modal:Yp,header:Xp,title:Jp,closeButton:ed,content:td,description:nd,uploadArea:ad,dragActive:sd,uploadIcon:id,uploadText:od,highlight:ld,uploadHint:rd,fileInput:cd,selectedFile:md,fileIcon:pd,fileInfo:dd,fileName:ud,fileSize:fd,removeButton:hd,footer:Nd,cancelButton:vd,uploadButton:Vd},bd=({isOpen:t,onClose:s})=>{const[n,o]=l.useState(null),[a,m]=l.useState(!1),i=l.useRef(null);if(!t)return null;const r=V=>{if(!(["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv"].includes(V.type)||V.name.endsWith(".xls")||V.name.endsWith(".xlsx")||V.name.endsWith(".csv"))){$e.error("Vui l√≤ng ch·ªçn file Excel (.xls, .xlsx) ho·∫∑c CSV");return}o(V)},d=V=>{V.preventDefault(),V.stopPropagation(),m(!1);const Q=V.dataTransfer.files;Q&&Q.length>0&&r(Q[0])},u=V=>{V.preventDefault(),V.stopPropagation(),m(!0)},h=V=>{V.preventDefault(),V.stopPropagation(),m(!1)},v=V=>{const Q=V.target.files;Q&&Q.length>0&&r(Q[0])},H=()=>{var V;(V=i.current)==null||V.click()},b=()=>{o(null),i.current&&(i.current.value="")},f=()=>{if(!n){$e.error("Vui l√≤ng ch·ªçn file ƒë·ªÉ upload");return}$e.success(`ƒê√£ th√™m ƒëi·ªÉm th√†nh c√¥ng t·ª´ file ${n.name}`),o(null),i.current&&(i.current.value=""),s()},g=V=>{if(V===0)return"0 Bytes";const Q=1024,C=["Bytes","KB","MB","GB"],w=Math.floor(Math.log(V)/Math.log(Q));return Math.round(V/Math.pow(Q,w)*100)/100+" "+C[w]},E=V=>{V.target===V.currentTarget&&s()};return e.jsxDEV("div",{className:ve.overlay,onClick:E,children:e.jsxDEV("div",{className:ve.modal,children:[e.jsxDEV("div",{className:ve.header,children:[e.jsxDEV("h2",{className:ve.title,children:"Th√™m ƒëi·ªÉm t·ª´ file Excel"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:117,columnNumber:11},void 0),e.jsxDEV("button",{className:ve.closeButton,onClick:s,"aria-label":"ƒê√≥ng",children:e.jsxDEV(ge,{size:20},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:119,columnNumber:13},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:118,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:116,columnNumber:9},void 0),e.jsxDEV("div",{className:ve.content,children:[e.jsxDEV("p",{className:ve.description,children:"T·∫£i l√™n file Excel (.xls, .xlsx) ho·∫∑c CSV ch·ª©a d·ªØ li·ªáu ƒëi·ªÉm ƒë·ªÉ th√™m v√†o b·∫£n ƒë·ªì."},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:125,columnNumber:11},void 0),e.jsxDEV("div",{className:`${ve.uploadArea} ${a?ve.dragActive:""}`,onDrop:d,onDragOver:u,onDragLeave:h,onClick:H,children:[e.jsxDEV(En,{className:ve.uploadIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:137,columnNumber:13},void 0),e.jsxDEV("p",{className:ve.uploadText,children:[e.jsxDEV("span",{className:ve.highlight,children:"Nh·∫•p ƒë·ªÉ ch·ªçn file"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:139,columnNumber:15},void 0)," ho·∫∑c k√©o th·∫£ file v√†o ƒë√¢y"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:138,columnNumber:13},void 0),e.jsxDEV("p",{className:ve.uploadHint,children:"H·ªó tr·ª£: .xls, .xlsx, .csv"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:141,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:130,columnNumber:11},void 0),e.jsxDEV("input",{ref:i,type:"file",className:ve.fileInput,accept:".xls,.xlsx,.csv,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,text/csv",onChange:v},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:147,columnNumber:11},void 0),n&&e.jsxDEV("div",{className:ve.selectedFile,children:[e.jsxDEV(es,{className:ve.fileIcon,size:24},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:158,columnNumber:15},void 0),e.jsxDEV("div",{className:ve.fileInfo,children:[e.jsxDEV("p",{className:ve.fileName,children:n.name},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:160,columnNumber:17},void 0),e.jsxDEV("p",{className:ve.fileSize,children:g(n.size)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:161,columnNumber:17},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:159,columnNumber:15},void 0),e.jsxDEV("button",{className:ve.removeButton,onClick:V=>{V.stopPropagation(),b()},"aria-label":"X√≥a file",children:e.jsxDEV(ts,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:171,columnNumber:17},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:163,columnNumber:15},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:157,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:124,columnNumber:9},void 0),e.jsxDEV("div",{className:ve.footer,children:[e.jsxDEV("button",{className:ve.cancelButton,onClick:s,children:"H·ªßy"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:179,columnNumber:11},void 0),e.jsxDEV("button",{className:ve.uploadButton,onClick:f,disabled:!n,children:[e.jsxDEV(En,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:187,columnNumber:13},void 0),"Upload"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:182,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:178,columnNumber:9},void 0)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:114,columnNumber:7},void 0)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/app/components/map/UploadExcelModal.tsx",lineNumber:113,columnNumber:5},void 0)},gd="_mapContainer_4m7xg_281",xd="_pageContainer_4m7xg_891",Td="_headerTitleContainer_4m7xg_901",Ed="_headerClockContainer_4m7xg_913",Hd="_headerClockTime_4m7xg_937",Dd="_headerClockTimeValue_4m7xg_951",_d="_headerClockDateValue_4m7xg_965",yd="_headerClockDot_4m7xg_977",Ld="_mapLayerSelectWrapper_4m7xg_1021",wd="_mapLayerSelect_4m7xg_1021",jd="_errorContainer_4m7xg_1083",Md="_errorContent_4m7xg_1101",Qd="_errorIcon_4m7xg_1121",Cd="_errorTitle_4m7xg_1131",Sd="_errorMessage_4m7xg_1145",Id="_mapContentContainer_4m7xg_1161",kd="_mapWrapper_4m7xg_1173",Pd="_loadingOverlay_4m7xg_1187",Ad="_loadingContent_4m7xg_1215",Bd="_loadingSpinner_4m7xg_1223",Rd="_loadingText_4m7xg_1243",Od="_mapControls_4m7xg_1257",zd="_mapControlButton_4m7xg_1277",Fd="_mapControlButtonActive_4m7xg_1313",oe={mapContainer:gd,pageContainer:xd,headerTitleContainer:Td,headerClockContainer:Ed,headerClockTime:Hd,headerClockTimeValue:Dd,headerClockDateValue:_d,headerClockDot:yd,mapLayerSelectWrapper:Ld,mapLayerSelect:wd,errorContainer:jd,errorContent:Md,errorIcon:Qd,errorTitle:Cd,errorMessage:Sd,mapContentContainer:Id,mapWrapper:kd,loadingOverlay:Pd,loadingContent:Ad,loadingSpinner:Bd,loadingText:Rd,mapControls:Od,mapControlButton:zd,mapControlButtonActive:Fd};function $d(t){const s=t.getHours().toString().padStart(2,"0"),n=t.getMinutes().toString().padStart(2,"0"),o=t.getSeconds().toString().padStart(2,"0");return`${s}:${n}:${o}`}function qd(t){const n=["Ch·ªß nh·∫≠t","Th·ª© hai","Th·ª© ba","Th·ª© t∆∞","Th·ª© nƒÉm","Th·ª© s√°u","Th·ª© b·∫£y"][t.getDay()],o=t.getDate().toString().padStart(2,"0"),a=(t.getMonth()+1).toString().padStart(2,"0"),m=t.getFullYear();return`${n}, ${o}/${a}/${m}`}function Ud(t){return t.map(s=>{switch(s){case"certified":return"active";case"scheduled":return"pending";case"hotspot":return"suspended";case"inspected":return"rejected";default:return s}})}function Wd(t,s){return t.map(n=>{const o=s.find(a=>a.id===n);return o==null?void 0:o.name}).filter(n=>n!==void 0)}function Gd(t,s){const n=s.length;if(t.length===n&&n>0)return;const a=Wd(t,s);return a.length>0?a:void 0}function Kd(t,s,n,o){const a=Object.keys(t).filter(i=>t[i]===!0),m=Object.keys(t).length;if(m>0)return a.length===m?s.map(i=>i.id):a.length>0?a:[];if(n)return[n];if(o)return s.filter(r=>r.parent_id===o||r.id===o).map(r=>r.id)}function Zd(t,s){const n=s.length,o=Object.keys(t).filter(i=>{const r=t[i]===!0,d=i&&i!=="undefined"&&i!=="null"&&i.trim()!=="";return r&&d});if(o.length===n&&n>0)return null;const m=o.filter(i=>i&&i!=="undefined"&&i!=="null"&&i.trim()!==""?s.some(u=>u.id===i||u._id===i):!1);return m.length>0?m:null}function Yd(t,s){if(!t||t.length===0)return[];if(s.trim()==="")return t;const n=s.toLowerCase();return t.filter(o=>{const a=o.name.toLowerCase(),m=o.address.toLowerCase(),i=o.type.toLowerCase();return a.includes(n)||m.includes(n)||i.includes(n)})}const Xd=[{id:"1",code:"certified",name:"Ch·ª©ng nh·∫≠n ATTP",description:"ƒê·∫°t ch·ª©ng nh·∫≠n an to√†n th·ª±c ph·∫©m",order:1,isActive:!0},{id:"2",code:"hotspot",name:"ƒêi·ªÉm n√≥ng",description:"C√≥ ph·∫£n √°nh t·ª´ ng∆∞·ªùi d√¢n",order:2,isActive:!0},{id:"3",code:"scheduled",name:"L√™n l·ªãch ki·ªÉm tra",description:"ƒê√£ l√™n l·ªãch ki·ªÉm tra",order:3,isActive:!0},{id:"4",code:"inspected",name:"ƒê√£ ki·ªÉm tra",description:"ƒê√£ ki·ªÉm tra c∆° b·∫£n",order:4,isActive:!0}];async function Jd(){return Xd}function Bn(t){const s={},n=t.findIndex(a=>a.code==="hotspot"),o=n>=0?n:0;return t.forEach((a,m)=>{s[a.code]=m===o}),s}const eu=({filters:t,businessTypeFilters:s,departmentFilters:n,pendingFilters:o,pendingBusinessTypeFilters:a,pendingDepartmentFilters:m,pointStatuses:i,categories:r,setCustomStartDate:d,setCustomEndDate:u,setSearchQuery:h})=>{const v=st(),H=l.useCallback(w=>{const z={...t,[w]:!t[w]};v(kt(z)),v(Pt(z))},[t,v]),b=l.useCallback(w=>{const z={...s,[w]:!s[w]};v(Nt(z)),v(vt(z))},[s,v]),f=l.useCallback(w=>{const z={};Object.keys(s).forEach(U=>{z[U]=w}),v(Nt(z)),v(vt(z))},[s,v]),g=l.useCallback(w=>{const z={...n,[w]:!n[w]};v(At(z)),v(Bt(z))},[n,v]),E=l.useCallback(w=>{const z={};Object.keys(n).forEach(U=>{z[U]=w}),v(At(z)),v(Bt(z))},[n,v]),V=l.useCallback(()=>{v(Ha())},[v]),Q=l.useCallback(()=>{},[]),C=l.useCallback(()=>{const w=Bn(i);v(kt(w)),v(Pt(w));const z={};r.forEach(U=>{z[U.id]=!0}),v(Nt(z)),v(vt(z)),v(Vt("")),v(Je("")),v(Re("")),d(""),u(""),h(""),v(Da())},[i,r,v,d,u,h]);return{handleFilterChange:H,handleBusinessTypeFilterChange:b,handleBusinessTypeToggleAll:f,handleDepartmentFilterChange:g,handleDepartmentToggleAll:E,handleApplyFilters:V,handleSaveFilters:Q,handleResetAllFilters:C}};async function tu(){try{const t=`${We}/categories?limit=10000`,s=await fetch(t,{method:"GET",headers:ye()});if(!s.ok){const o=await s.text();throw console.error("‚ùå fetchCategories: HTTP error:",s.status,o),new Error(`HTTP error! status: ${s.status}`)}return await s.json()}catch(t){throw console.error("‚ùå fetchCategories: Error:",t),t}}function Hu(){var Vn,bn;Qe(M=>M.auth);const t=Qe(M=>M.qlttScope),s=Qe(M=>M.mapFilters),n=st(),o=(Vn=t==null?void 0:t.scope)==null?void 0:Vn.divisionId,a=(bn=t==null?void 0:t.scope)==null?void 0:bn.teamId,m=(t==null?void 0:t.isLoading)||!1,i=(t==null?void 0:t.hasInitialized)||!1,r=s.filters,d=s.businessTypeFilters,u=s.departmentFilters,h=s.pendingFilters,v=s.pendingBusinessTypeFilters,H=s.pendingDepartmentFilters,b=s.selectedProvince,f=s.selectedDistrict,g=s.selectedWard,E=s.isFilterPanelOpen,V=s.limit,[Q,C]=l.useState([]),[w,z]=l.useState(!0),[U,J]=l.useState([]),[fe,ae]=l.useState(!0),[q,X]=l.useState([]),[re,de]=l.useState(!0),[ne,se]=l.useState([]),[pe,xe]=l.useState(!0),[S,G]=l.useState(null),[Y,Te]=l.useState(!1),[A,ie]=l.useState(!1),te=l.useRef(!1),[Z,Ne]=l.useState(""),[j,y]=l.useState(!1),[W,R]=l.useState(null),[c,N]=l.useState("all"),[x,_]=l.useState(null),[D,k]=l.useState(null),[K,F]=l.useState(!1),[$,ce]=l.useState(new Date);l.useEffect(()=>{const M=setInterval(()=>{ce(new Date)},1e3);return()=>clearInterval(M)},[]);const[Ee,je]=l.useState(null),[Ce,Tt]=l.useState(!1),[Rn,On]=l.useState(null),[zn,Xt]=l.useState(!1),[Fn,Jt]=l.useState(!1),[$n,en]=l.useState(!1),[qn,tn]=l.useState(null),[Un,nn]=l.useState(""),[Wn,Et]=l.useState(!1),[Gn,Kn]=l.useState(!1),[an,Ht]=l.useState(!1),[sn,it]=l.useState(!0),[Dt,_t]=l.useState(!0),[Me,yt]=l.useState(!1),[ue,Lt]=l.useState(!0),[he,ct]=l.useState(!1),[mt,wt]=l.useState(""),[on,Zn]=l.useState(null),[Yn,Xn]=l.useState(!1),jt=l.useRef(null),ln=l.useRef(null),rn=l.useRef(null),cn=l.useRef(null),mn=l.useRef(null);l.useEffect(()=>{async function M(){try{const I=await Jd();C(I);const B=Bn(I);n(kt(B)),n(Pt(B)),z(!1)}catch(I){console.error("‚ùå MapPage: Failed to load point statuses:",I),z(!1)}}M()},[]),l.useEffect(()=>{async function M(){try{const I=await tu();if(J(I),I.length>0){te.current=!0;const B={};I.forEach(me=>{B[me.id]=!0}),n(Nt(B)),n(vt(B)),setTimeout(()=>{te.current=!1},0)}ae(!1)}catch(I){console.error("‚ùå MapPage: Failed to load categories:",I),ae(!1)}}M()},[]),l.useEffect(()=>{if(m||!i)return;async function M(){try{de(!0);const I=a&&typeof a=="string"&&a.trim()!==""?a:void 0,B=o&&typeof o=="string"&&o.trim()!==""?o:void 0,me={};I!==void 0?me.teamId=I:B!==void 0&&(me.divisionId=B);const He=await Gc(Object.keys(me).length>0?me:void 0);if(X(He),He.length>0){te.current=!0;const Se={};He.forEach(Ie=>{Se[Ie.id]=!0}),n(At(Se)),n(Bt(Se)),setTimeout(()=>{te.current=!1},0)}de(!1),He.length>0&&(I||B)&&(ot.current="",ze.current||(ze.current=!1))}catch(I){console.error("‚ùå MapPage: Failed to load departments:",I),de(!1)}}M()},[a,o,m,i]),l.useEffect(()=>{const I=new URLSearchParams(window.location.search).get("limit");if(I){const B=parseInt(I,10);!isNaN(B)&&B>0&&n(_a(B))}},[n]),l.useEffect(()=>{ie(!0)},[]);const ze=l.useRef(!1);l.useEffect(()=>{q.length>0&&!m&&i&&(ot.current="",ze.current=!1)},[q,m,i]);const Mt=l.useMemo(()=>{const M=JSON.stringify(r),I=JSON.stringify(d),B=JSON.stringify(u);return JSON.stringify({filters:M,businessTypeFilters:I,departmentFilters:B,categoriesLength:U.length,showMerchants:ue,showMapPoints:Me,showOfficers:he,departmentsIds:JSON.stringify(q.map(me=>me.id).sort()),divisionId:o||"",teamId:a||"",selectedProvince:b||"",selectedWard:g||""})},[r,d,u,U.length,ue,Me,he,q,o,a,b,g]);l.useEffect(()=>{(o||a)&&!he&&!ue&&!Me&&ct(!0)},[o,a,he,ue,Me]);const ot=l.useRef("");l.useEffect(()=>{ot.current="",ze.current=!1},[o,a]),l.useEffect(()=>{if(!ue&&!Me||m||!i||Q.length===0||U.length===0||Object.keys(u).length===0&&q.length===0&&(a||o)||ot.current===Mt&&ze.current)return;async function M(){ze.current||xe(!0),G(null);try{const I=Object.keys(r).filter(Be=>r[Be]===!0),B=Ud(I),me=Object.keys(d).filter(Be=>d[Be]===!0),He=Gd(me,U),Se=Kd(u,q,a,o),Ie=Zd(d,U),pt=await ja(B.length>0?B:void 0,He,Se,a,o||"",q.map(Be=>Be.id),Ie,{statusCodes:B.length>0?B:void 0,businessTypes:He,departmentIds:Se,categoryIds:Ie&&Ie.length>0?Ie:void 0,province:b||void 0,ward:g||void 0,limit:V});se(pt),xe(!1),ze.current=!0,Te(!0),ot.current=Mt}catch(I){console.error("‚ùå MapPage: Failed to load merchants:",I),G(I.message||"Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu merchants"),xe(!1)}}M()},[Mt,Q.length,ue,Me,q.length,m,i,o,a,r,d,u,U.length,b,g]),l.useEffect(()=>{he&&!ue&&!Me&&(se([]),xe(!1))},[he,ue,Me]);const pn=l.useRef(!1),dn=l.useRef(!0);l.useEffect(()=>{const M=pn.current!==he,I=dn.current!==ue;(M||I)&&(he&&!ue?(Ht(!1),it(!1),n(Ye(!1))):ue&&!he&&(_t(!1),n(Ye(!1))),pn.current=he,dn.current=ue)},[he,ue,n]),l.useEffect(()=>(window.openPointDetail=(M,I)=>{I&&(I.stopPropagation(),I.preventDefault());const B=ne.find(me=>me.id===M);B&&setTimeout(()=>{je(B),Tt(!0)},50)},window.openPointReview=M=>{const I=ne.find(B=>B.id===M);I&&(On(I),Xt(!0))},window.openDepartmentDetail=(M,I)=>{_(M),k(I),F(!0)},()=>{delete window.openPointDetail,delete window.openPointReview,delete window.openDepartmentDetail}),[ne]);const[nu,Jn]=l.useState(!1),[au,ea]=l.useState(!1),[su,ta]=l.useState(!1);l.useEffect(()=>{async function M(){try{const I=await Ma(b||void 0,f||void 0,g||void 0);Zn(I),Yn||Xn(!0)}catch(I){console.error("‚ùå MapPage: Failed to load stats (background, non-blocking):",I)}}M()},[b,f,g]);const[iu,ou]=l.useState("all"),[na,Qt]=l.useState(""),[aa,Ct]=l.useState("");ps(),l.useEffect(()=>{const M=I=>{const B=I.target;B.closest('[data-scope-selector="true"]')||B.closest('[data-scope-dropdown="true"]')||B.closest("[data-dropdown-trigger]")||(Jn(!1),ea(!1),ta(!1),y(!1))};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[]),l.useEffect(()=>{const M=I=>{var He,Se,Ie,pt,Be;if(!E)return;const B=I.target,me=I.target;(He=jt.current)!=null&&He.contains(B)||(Se=ln.current)!=null&&Se.contains(B)||(Ie=rn.current)!=null&&Ie.contains(B)||(pt=cn.current)!=null&&pt.contains(B)||me.closest('[data-scope-selector="true"]')||me.closest('[data-scope-dropdown="true"]')||me.closest('button[aria-label="Ch·ªçn ph·∫°m vi gi√°m s√°t"]')||me.closest('[class*="marker"]')||me.closest('[class*="point"]')||me.closest(".leaflet-marker-icon")||me.closest(".leaflet-popup")||(Be=mn.current)!=null&&Be.contains(B)&&me.closest(".leaflet-container")!==null&&n(Ye(!1))};return E&&document.addEventListener("mousedown",M),()=>{document.removeEventListener("mousedown",M)}},[E]);const un=l.useCallback(M=>{je(M),Tt(!0)},[]);l.useEffect(()=>{(b||f||g)&&it(!0)},[b,f,g]),l.useEffect(()=>{Object.values(d).some(I=>I)&&it(!0)},[d]);const fn=(M,I)=>{const B=Rt.find(me=>me.managedWards.some(He=>He.name===M&&He.district===I));if(B){const me=B.officers.find(He=>He.isTeamLeader)||B.officers[0];tn(me),nn(M),Et(!0)}else wn.length>0&&(tn(wn[0]),nn(M),Et(!0))},{handleFilterChange:hn,handleBusinessTypeFilterChange:Nn,handleBusinessTypeToggleAll:vn,handleDepartmentFilterChange:sa,handleDepartmentToggleAll:ia,handleApplyFilters:oa,handleSaveFilters:la,handleResetAllFilters:ra}=eu({filters:r,businessTypeFilters:d,departmentFilters:u,pendingFilters:h,pendingBusinessTypeFilters:v,pendingDepartmentFilters:H,pointStatuses:Q,categories:U,setCustomStartDate:Qt,setCustomEndDate:Ct,setSearchQuery:Ne}),ca=l.useMemo(()=>ne,[ne]),Ge=l.useMemo(()=>Yd(ne,Z),[ne,Z]);l.useEffect(()=>{Z.trim()},[Z,Ge,Me,ue]);const ma=l.useMemo(()=>{const M=Object.keys(r).some(B=>r[B]!==h[B]),I=Object.keys(d).some(B=>d[B]!==v[B]);return M||I},[r,h,d,v]);return Z.trim()&&Ge.slice(0,8),e.jsxDEV("div",{className:`flex flex-col ${oe.pageContainer}`,children:[e.jsxDEV(fa,{breadcrumbs:[{label:"Trang ch·ªß",href:"/"},{label:"B·∫£n ƒë·ªì ƒëi·ªÅu h√†nh"}],title:e.jsxDEV("div",{className:oe.headerTitleContainer,children:[e.jsxDEV("span",{children:"B·∫£n ƒë·ªì ƒëi·ªÅu h√†nh"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:863,columnNumber:13},this),e.jsxDEV("div",{className:oe.headerClockContainer,children:[e.jsxDEV("div",{className:oe.headerClockTime,children:[e.jsxDEV("div",{className:oe.headerClockTimeValue,children:$d($)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:866,columnNumber:17},this),e.jsxDEV("div",{className:oe.headerClockDateValue,children:qd($)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:869,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:865,columnNumber:15},this),e.jsxDEV("div",{className:oe.headerClockDot},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:873,columnNumber:15},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:864,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:862,columnNumber:11},this),actions:e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(Kp,{startDate:na,endDate:aa,onStartDateChange:Qt,onEndDateChange:Ct,onClear:()=>{Qt(""),Ct("")},onApply:()=>{}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:880,columnNumber:13},this),e.jsxDEV("div",{className:oe.mapLayerSelectWrapper,children:e.jsxDEV("select",{className:oe.mapLayerSelect,value:Me?"mappoint":ue?"merchant":he?"officers":"mappoint",onChange:M=>{const I=M.target.value;I==="mappoint"?(yt(!0),Lt(!1),ct(!1)):I==="merchant"?(yt(!1),Lt(!0),ct(!1)):I==="officers"&&(yt(!1),Lt(!1),ct(!0),wt(""))},children:[e.jsxDEV("option",{value:"merchant",children:"üìç Ch·ªß h·ªô kinh doanh"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:922,columnNumber:17},this),e.jsxDEV("option",{value:"officers",children:"üëÆ C√°n b·ªô qu·∫£n l√Ω"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:923,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:895,columnNumber:15},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:894,columnNumber:13},this),e.jsxDEV(gn,{variant:"outline",onClick:ra,children:"üîÑ T·∫£i L·∫°i"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:926,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:878,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:859,columnNumber:7},this),S&&!pe&&e.jsxDEV("div",{className:oe.errorContainer,children:e.jsxDEV("div",{className:oe.errorContent,children:[e.jsxDEV("div",{className:oe.errorIcon,children:"‚ö†Ô∏è"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:937,columnNumber:13},this),e.jsxDEV("h3",{className:oe.errorTitle,children:"Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:938,columnNumber:13},this),e.jsxDEV("p",{className:oe.errorMessage,children:S},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:941,columnNumber:13},this),e.jsxDEV(gn,{onClick:()=>window.location.reload(),children:"Th·ª≠ l·∫°i"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:944,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:936,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:935,columnNumber:9},this),(Y||!pe)&&!S&&e.jsxDEV("div",{className:oe.mapContentContainer,children:e.jsxDEV("div",{className:`${oe.mapContainer} ${oe.mapWrapper}`,ref:mn,children:[pe&&e.jsxDEV("div",{className:oe.loadingOverlay,children:e.jsxDEV("div",{className:oe.loadingContent,children:[e.jsxDEV("div",{className:oe.loadingSpinner},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:960,columnNumber:19},this),e.jsxDEV("div",{className:oe.loadingText,children:"ƒêang t·∫£i d·ªØ li·ªáu b·∫£n ƒë·ªì..."},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:961,columnNumber:19},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:959,columnNumber:17},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:958,columnNumber:15},this),ue&&!he&&an&&(()=>{const M={certified:"#22c55e",hotspot:"#ef4444",scheduled:"#f59e0b",inspected:"#005cb6"},I=Q.map(B=>{const me=M[B.code]||"#005cb6";return{key:B.code,label:B.name,color:me,count:Ge.filter(He=>He.category===B.code).length}});return e.jsxDEV(Zt,{categoryData:I,onClose:()=>Ht(!1),ref:rn},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:990,columnNumber:17},this)})(),ue&&!he&&e.jsxDEV(Kt,{selectedProvince:b,selectedDistrict:f,selectedWard:g,filteredRestaurants:ca,businessTypeFilters:d,categories:U,merchantStats:on,divisionId:o,teamId:a,onClose:()=>{n(Vt("")),n(Je("")),n(Re(""))},isVisible:sn,onVisibilityChange:it,ref:cn},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1e3,columnNumber:15},this),e.jsxDEV(Wt,{filters:r,businessTypeFilters:d,searchQuery:Z,selectedRestaurant:W,selectedProvince:b,selectedDistrict:f,selectedWard:g,restaurants:Ge,showWardBoundaries:he,showMerchants:ue,selectedTeamId:mt,onPointClick:un,onWardClick:fn,onFullscreenClick:()=>{he?en(!0):Jt(!0)}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1021,columnNumber:13},this),he&&!ue&&e.jsxDEV(An,{selectedTeamId:mt,isVisible:Dt,onClose:()=>_t(!1)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1046,columnNumber:15},this),e.jsxDEV("div",{className:oe.mapControls,children:[ue&&!he&&e.jsxDEV("button",{className:oe.mapControlButton,onClick:()=>Ht(!an),"aria-label":"M·ªü/ƒê√≥ng ch√∫ gi·∫£i",title:"Ch√∫ gi·∫£i b·∫£n ƒë·ªì",children:e.jsxDEV(De,{size:18,strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1063,columnNumber:19},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1057,columnNumber:17},this),ue&&!he&&e.jsxDEV("button",{className:oe.mapControlButton,onClick:()=>it(!sn),"aria-label":"M·ªü/ƒê√≥ng th·ªëng k√™",title:"Th·ªëng k√™ ƒë·ªãa b√†n",children:e.jsxDEV(at,{size:18,strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1075,columnNumber:19},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1069,columnNumber:17},this),(ue||he)&&e.jsxDEV("button",{ref:ln,className:`${oe.mapControlButton} ${E?oe.mapControlButtonActive:""}`,onClick:()=>n(Ye(!E)),"aria-label":"M·ªü/ƒê√≥ng b·ªô l·ªçc",title:he?"B·ªô l·ªçc c√°n b·ªô":"B·ªô l·ªçc n√¢ng cao",children:e.jsxDEV($t,{size:18,strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1088,columnNumber:19},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1081,columnNumber:17},this),he&&!ue&&e.jsxDEV("button",{className:`${oe.mapControlButton} ${Dt?oe.mapControlButtonActive:""}`,onClick:()=>_t(!Dt),"aria-label":"M·ªü/ƒê√≥ng th·ªëng k√™ c√°n b·ªô",title:"Th·ªëng k√™ c√°n b·ªô qu·∫£n l√Ω",children:e.jsxDEV(at,{size:18,strokeWidth:2.5},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1100,columnNumber:19},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1094,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1054,columnNumber:13},this),he&&!ue?e.jsxDEV(Yt,{isOpen:E,selectedTeamId:mt,onClose:()=>n(Ye(!1)),onTeamChange:M=>{wt(M)},ref:jt},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1107,columnNumber:15},this):ue&&!he?e.jsxDEV(Gt,{isOpen:E,filters:h,businessTypeFilters:v,departmentFilters:H,restaurants:ne,pointStatuses:Q,categories:U,departments:q,selectedProvince:b,selectedDistrict:f,selectedWard:g,filteredCount:Ge.length,onFilterChange:hn,onBusinessTypeFilterChange:Nn,onBusinessTypeToggleAll:vn,onDepartmentFilterChange:sa,onDepartmentToggleAll:ia,onProvinceChange:M=>{n(Vt(M)),n(Je("")),n(Re(""))},onDistrictChange:M=>{Je(M),n(Re(""))},onWardChange:M=>{n(Re(M))},onClose:()=>n(Ye(!1)),onApplyFilters:oa,onSaveFilters:la,hasUnappliedChanges:ma,ref:jt},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1117,columnNumber:15},this):null]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:955,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:953,columnNumber:9},this),e.jsxDEV(Po,{point:Ee,isOpen:Ce,onClose:()=>Tt(!1)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1159,columnNumber:7},this),e.jsxDEV(El,{point:Rn,isOpen:zn,onClose:()=>Xt(!1)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1166,columnNumber:7},this),e.jsxDEV(Wc,{isOpen:Wn,onClose:()=>Et(!1),officer:qn,wardName:Un},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1173,columnNumber:7},this),e.jsxDEV(Qp,{isOpen:K,onClose:()=>F(!1),departmentId:x||"",departmentData:D},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1181,columnNumber:7},this),e.jsxDEV(Ur,{isOpen:Fn,onClose:()=>Jt(!1),filters:r,businessTypeFilters:d,searchQuery:Z,selectedRestaurant:W,selectedProvince:b,selectedDistrict:f,selectedWard:g,restaurants:Ge,allRestaurants:ne,pointStatuses:Q,categories:U,merchantStats:on,divisionId:o,teamId:a,onPointClick:un,onFilterChange:hn,onBusinessTypeFilterChange:Nn,onBusinessTypeToggleAll:vn,onProvinceChange:M=>{n(Vt(M)),n(Je("")),n(Re(""))},onDistrictChange:M=>{Je(M),n(Re(""))},onWardChange:M=>{n(Re(M))}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1189,columnNumber:7},this),e.jsxDEV(Uc,{isOpen:$n,onClose:()=>en(!1),selectedTeamId:mt,onTeamChange:M=>{wt(M)},onWardClick:fn},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1225,columnNumber:7},this),e.jsxDEV(bd,{isOpen:Gn,onClose:()=>Kn(!1)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1237,columnNumber:7},this),e.jsxDEV(da,{position:"top-right",richColors:!0},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:1243,columnNumber:7},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/MapPage.tsx",lineNumber:858,columnNumber:5},this)}export{Hu as default};
