import{e as B,f as S,r as d,j as e,aB as v}from"./vendor-Cja35lIC.js";import{P as z,B as n,k as $,l as A}from"./system-admin-ex6_k_qZ.js";import{D as F,T as M}from"./evidence-DaHuJ-yO.js";import{A as U,T as w,a9 as X,aw as j,J as K,ag as _}from"./icons-BAlVBlw-.js";import"./leaflet-fbicKXUd.js";const O="_pageContainer_lx0js_5",J="_summaryCards_lx0js_25",q="_summaryCard_lx0js_25",G="_success_lx0js_71",W="_danger_lx0js_95",Y="_summaryLabel_lx0js_107",Z="_summaryValue_lx0js_125",ee="_errorSection_lx0js_143",se="_errorHeader_lx0js_159",re="_errorIcon_lx0js_177",ie="_errorTitle_lx0js_187",te="_errorList_lx0js_201",ae="_errorItem_lx0js_257",le="_errorRow_lx0js_295",oe="_errorActions_lx0js_307",me="_loadMoreButton_lx0js_327",ne="_tableContainer_lx0js_347",ce="_tableHeader_lx0js_363",ge="_tableTitle_lx0js_381",ue="_actionButtons_lx0js_403",pe="_validRow_lx0js_423",de="_invalidRow_lx0js_441",ve="_statusBadge_lx0js_461",Ne="_valid_lx0js_423",he="_invalid_lx0js_441",ye="_rowNumber_lx0js_511",xe="_storeName_lx0js_523",Ve="_normalText_lx0js_547",be="_monospaceText_lx0js_571",Te="_emptyState_lx0js_599",Re="_emptyIcon_lx0js_617",fe="_emptyTitle_lx0js_627",Ee="_emptyDescription_lx0js_641",s={pageContainer:O,summaryCards:J,summaryCard:q,success:G,danger:W,summaryLabel:Y,summaryValue:Z,errorSection:ee,errorHeader:se,errorIcon:re,errorTitle:ie,errorList:te,errorItem:ae,errorRow:le,errorActions:oe,loadMoreButton:me,tableContainer:ne,tableHeader:ce,tableTitle:ge,actionButtons:ue,validRow:pe,invalidRow:de,statusBadge:ve,valid:Ne,invalid:he,rowNumber:ye,storeName:xe,normalText:Ve,monospaceText:be,emptyState:Te,emptyIcon:Re,emptyTitle:fe,emptyDescription:Ee};function Le(){var E;const c=B(),I=S(),[N,x]=d.useState(!1),[V,b]=d.useState(1),[g,L]=d.useState(20),[h,T]=d.useState(!1),R=((E=I.state)==null?void 0:E.importResult)||null;if(!R)return c("/registry/stores"),null;const{data:u,errors:i,summary:t}=R,f=(V-1)*g,D=u.slice(f,f+g),P=Math.ceil(u.length/g),Q=async()=>{if(t.valid===0){v.error("Không có dữ liệu hợp lệ để import");return}x(!0);try{await new Promise(r=>setTimeout(r,2e3)),v.success(`Import thành công ${t.valid} cửa hàng`,{description:'Tất cả cửa hàng đã được tạo ở trạng thái "Chờ duyệt"',duration:5e3}),c("/registry/stores")}catch(r){console.error("Import failed:",r),v.error("Có lỗi xảy ra khi import dữ liệu")}finally{x(!1)}},C=()=>{if(i.length===0)return;const r=new Map;i.forEach(m=>{const p=r.get(m.row)||[];p.push(`${m.field}: ${m.message}`),r.set(m.row,p)});const a=["Dòng,Lỗi"];r.forEach((m,p)=>{a.push(`${p},"${m.join("; ")}"`)});const o="\uFEFF"+a.join(`
`),y=new Blob([o],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),H=URL.createObjectURL(y);l.setAttribute("href",H),l.setAttribute("download",`danh-sach-loi-import-${Date.now()}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(H),v.success("Đã tải file lỗi")},k=[{key:"rowIndex",label:"Dòng",sortable:!1,width:"80px",render:r=>e.jsxDEV("span",{className:s.rowNumber,children:r.rowIndex},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:120,columnNumber:9},this)},{key:"name",label:"Tên cửa hàng",sortable:!1,width:"250px",render:r=>e.jsxDEV("span",{className:s.storeName,children:r.name},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:129,columnNumber:9},this)},{key:"ownerName",label:"Chủ hộ",sortable:!1,width:"200px",render:r=>e.jsxDEV("span",{className:s.normalText,children:r.ownerName},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:138,columnNumber:9},this)},{key:"taxCode",label:"Mã số thuế",sortable:!1,width:"140px",render:r=>e.jsxDEV("span",{className:s.monospaceText,children:r.taxCode},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:147,columnNumber:9},this)},{key:"phone",label:"Số điện thoại",sortable:!1,width:"140px",render:r=>e.jsxDEV("span",{className:s.monospaceText,children:r.phone},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:156,columnNumber:9},this)},{key:"ward",label:"Phường/Xã",sortable:!1,width:"180px",render:r=>e.jsxDEV("span",{className:s.normalText,children:r.ward},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:165,columnNumber:9},this)},{key:"industryName",label:"Ngành hàng",sortable:!1,width:"180px",render:r=>e.jsxDEV("span",{className:s.normalText,children:r.industryName},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:174,columnNumber:9},this)},{key:"status",label:"Trạng thái",sortable:!1,width:"120px",render:r=>{const a=i.some(o=>o.row===r.rowIndex);return e.jsxDEV("span",{className:`${s.statusBadge} ${a?s.invalid:s.valid}`,children:a?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(w,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:188,columnNumber:17},this),"Có lỗi"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:187,columnNumber:15},this):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(_,{size:12},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:193,columnNumber:17},this),"Hợp lệ"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:192,columnNumber:15},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:185,columnNumber:11},this)}}];return e.jsxDEV("div",{className:s.pageContainer,children:[e.jsxDEV(z,{breadcrumbs:[{label:"Trang chủ",href:"/"},{label:"Cơ sở & Địa bàn",href:"/registry/stores"},{label:"Xem trước Import"}],title:"Xem trước dữ liệu Import",actions:e.jsxDEV(n,{variant:"outline",size:"sm",onClick:()=>c("/registry/stores"),children:[e.jsxDEV(U,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:214,columnNumber:13},this),"Quay lại"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:213,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:205,columnNumber:7},this),e.jsxDEV("div",{className:s.summaryCards,children:[e.jsxDEV("div",{className:s.summaryCard,children:[e.jsxDEV("p",{className:s.summaryLabel,children:"Tổng số dòng"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:223,columnNumber:11},this),e.jsxDEV("p",{className:s.summaryValue,children:t.total},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:224,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:222,columnNumber:9},this),e.jsxDEV("div",{className:`${s.summaryCard} ${s.success}`,children:[e.jsxDEV("p",{className:s.summaryLabel,children:"Dòng hợp lệ"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:227,columnNumber:11},this),e.jsxDEV("p",{className:s.summaryValue,children:t.valid},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:228,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:226,columnNumber:9},this),e.jsxDEV("div",{className:`${s.summaryCard} ${s.danger}`,children:[e.jsxDEV("p",{className:s.summaryLabel,children:"Dòng có lỗi"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:231,columnNumber:11},this),e.jsxDEV("p",{className:s.summaryValue,children:t.invalid},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:232,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:230,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:221,columnNumber:7},this),i.length>0&&e.jsxDEV("div",{className:s.errorSection,children:[e.jsxDEV("div",{className:s.errorHeader,children:[e.jsxDEV(w,{size:24,className:s.errorIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:240,columnNumber:13},this),e.jsxDEV("h2",{className:s.errorTitle,children:["Phát hiện ",i.length," lỗi trong file import"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:241,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:239,columnNumber:11},this),e.jsxDEV("div",{className:s.errorList,children:i.slice(0,h?i.length:10).map((r,a)=>{const o=`Dòng ${r.row}`,y=r.field,l=r.message;return e.jsxDEV("div",{className:s.errorItem,children:[e.jsxDEV("span",{className:s.errorRow,children:[o,":"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:255,columnNumber:19},this),e.jsxDEV("strong",{children:y},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:256,columnNumber:19},this)," - ",l]},a,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:254,columnNumber:17},this)})},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:246,columnNumber:11},this),e.jsxDEV("div",{className:s.errorActions,children:[i.length>10&&!h&&e.jsxDEV(n,{variant:"ghost",onClick:()=>T(!0),className:s.loadMoreButton,children:["Tải thêm ",i.length-10," lỗi"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:264,columnNumber:15},this),h&&i.length>10&&e.jsxDEV(n,{variant:"ghost",onClick:()=>T(!1),className:s.loadMoreButton,children:"Thu gọn"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:273,columnNumber:15},this),e.jsxDEV(n,{variant:"outline",onClick:C,children:[e.jsxDEV(X,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:282,columnNumber:15},this),"Tải file lỗi chi tiết (",i.length," lỗi)"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:281,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:262,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:238,columnNumber:9},this),e.jsxDEV("div",{className:s.tableContainer,children:[e.jsxDEV("div",{className:s.tableHeader,children:e.jsxDEV("div",{className:s.tableTitle,children:[e.jsxDEV(j,{size:20},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:293,columnNumber:13},this),e.jsxDEV("span",{children:["Danh sách cửa hàng sẽ được import (",t.valid,"/",t.total,")"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:294,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:292,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:291,columnNumber:9},this),e.jsxDEV($,{children:e.jsxDEV(A,{style:{padding:0},children:u.length>0?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(F,{columns:k,data:D,selectable:!1,getRowId:r=>r.rowIndex,getRowClassName:r=>i.some(o=>o.row===r.rowIndex)?s.invalidRow:s.validRow},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:302,columnNumber:17},this),e.jsxDEV(M,{currentPage:V,totalPages:P,totalRecords:u.length,pageSize:g,onPageChange:b,onPageSizeChange:r=>{L(r),b(1)}},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:313,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:301,columnNumber:15},this):e.jsxDEV("div",{className:s.emptyState,children:[e.jsxDEV(j,{size:48,className:s.emptyIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:327,columnNumber:17},this),e.jsxDEV("h3",{className:s.emptyTitle,children:"Không có dữ liệu"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:328,columnNumber:17},this),e.jsxDEV("p",{className:s.emptyDescription,children:"File import không chứa dữ liệu hợp lệ nào"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:329,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:326,columnNumber:15},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:299,columnNumber:11},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:298,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:290,columnNumber:7},this),e.jsxDEV("div",{className:s.actionButtons,children:[e.jsxDEV(n,{variant:"outline",onClick:()=>c("/registry/stores"),disabled:N,children:"Hủy"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:340,columnNumber:9},this),e.jsxDEV(n,{onClick:Q,disabled:t.valid===0||N,children:N?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(K,{size:16,className:"animate-spin"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:346,columnNumber:15},this),"Đang import..."]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:345,columnNumber:13},this):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(_,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:351,columnNumber:15},this),"Xác nhận import ",t.valid," cửa hàng"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:350,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:343,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:339,columnNumber:7},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/pages/registry/RegistryImportReviewPage.tsx",lineNumber:204,columnNumber:5},this)}export{Le as default};
