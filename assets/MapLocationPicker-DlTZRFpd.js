import{r as u,j as e,bM as F,bN as w,bO as U,bP as z,bQ as R}from"./vendor-Cja35lIC.js";import{L as P}from"./leaflet-fbicKXUd.js";import{I as k,B as W,L as E}from"./system-admin-ex6_k_qZ.js";import{o as $,c3 as B,ag as G,Q as H}from"./icons-BAlVBlw-.js";const O="_container_1tdom_11",q="_searchSection_1tdom_25",K="_searchWrapper_1tdom_37",J="_currentLocationButton_1tdom_49",X="_searchInputWrapper_1tdom_85",Y="_searchInput_1tdom_85",Z="_suggestions_1tdom_157",ee="_suggestionItem_1tdom_185",ie="_suggestionIcon_1tdom_229",te="_suggestionText_1tdom_239",se="_suggestionAddress_1tdom_249",oe="_suggestionCoords_1tdom_265",ae="_mapSection_1tdom_281",re="_mapContainer_1tdom_293",ne="_statusIndicator_1tdom_547",ce="_statusConfirmed_1tdom_563",le="_statusPending_1tdom_609",ue="_validationError_1tdom_657",me="_helpText_1tdom_695",de="_coordsDisplay_1tdom_715",pe="_coordField_1tdom_727",o={container:O,searchSection:q,searchWrapper:K,currentLocationButton:J,searchInputWrapper:X,searchInput:Y,suggestions:Z,suggestionItem:ee,suggestionIcon:ie,suggestionText:te,suggestionAddress:se,suggestionCoords:oe,mapSection:ae,mapContainer:re,statusIndicator:ne,statusConfirmed:ce,statusPending:le,validationError:ue,helpText:me,coordsDisplay:de,coordField:pe};delete P.Icon.Default.prototype._getIconUrl;P.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});function he({onMapClick:r}){return R({click:n=>{r(n.latlng.lat,n.latlng.lng)}}),null}async function _(r,n){var m;try{const c=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${r}&lon=${n}&zoom=18&addressdetails=1&accept-language=vi`,{headers:{"User-Agent":"MAPPA-StoreLocator/1.0"}});if(c.ok){const a=await c.json();return(m=a.address)!=null&&m.road?`${a.address.road}${a.address.house_number?" "+a.address.house_number:""}, ${a.address.ward||a.address.village||""}, ${a.address.city||a.address.town||"TP.HCM"}`:a.address_line1||null}}catch(c){console.error("Reverse geocoding error:",c)}return null}function fe({address:r,latitude:n,longitude:m,onLocationChange:c,disabled:a=!1}){const[l,N]=u.useState({lat:n||10.8231,lng:m||106.6297}),[g,v]=u.useState(r||""),[T,M]=u.useState([]),[j,f]=u.useState(!1),[D,V]=u.useState(!!n&&!!m),[L,h]=u.useState(""),[b,x]=u.useState(!1),Q=u.useRef(null),y=i=>{if(v(i),i.length>=3){const t=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(i+", Vietnam")}&viewbox=102,8,110,24&bounded=1&limit=5&accept-language=vi`;fetch(t,{headers:{"User-Agent":"MAPPA-StoreLocator/1.0"}}).then(s=>s.json()).then(s=>{const d=s.map(p=>({address:p.display_name||p.name,latitude:parseFloat(p.lat),longitude:parseFloat(p.lon),type:p.type==="street"||p.type==="house"?"street":"district"}));M(d),f(d.length>0)}).catch(s=>{console.error("Search error:",s),f(!1)})}else f(!1)},S=i=>{v(i.address),N({lat:i.latitude,lng:i.longitude}),f(!1),V(!0),h(""),c({latitude:i.latitude,longitude:i.longitude,address:i.address})},C=async(i,t)=>{if(a)return;N({lat:i,lng:t}),V(!0),h(""),x(!0);const s=await _(i,t);x(!1),c({latitude:i,longitude:t,address:s||void 0}),s&&v(s)},I=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(async i=>{const t=i.coords.latitude,s=i.coords.longitude;N({lat:t,lng:s}),V(!0),h(""),x(!0);const d=await _(t,s);x(!1),c({latitude:t,longitude:s,address:d||void 0}),d&&v(d)},i=>{h("Kh√¥ng th·ªÉ x√°c ƒë·ªãnh v·ªã tr√≠ hi·ªán t·∫°i")}):h("Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ ƒë·ªãnh v·ªã GPS")},A=(i,t)=>i===void 0||t===void 0?!1:i>=8&&i<=24&&t>=102&&t<=110;return u.useEffect(()=>{n!==void 0&&m!==void 0&&(A(n,m)?(N({lat:n,lng:m}),V(!0),h("")):h("T·ªça ƒë·ªô n·∫±m ngo√†i ph·∫°m vi Vi·ªát Nam"))},[n,m]),u.useEffect(()=>{if(r&&r.length>=3&&r!==g){console.log("üîç Auto-searching address:",r),v(r);const i=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(r+", Vietnam")}&viewbox=102,8,110,24&bounded=1&limit=5&accept-language=vi`;fetch(i,{headers:{"User-Agent":"MAPPA-StoreLocator/1.0"}}).then(t=>t.json()).then(t=>{if(t&&t.length>0){const s=t[0],d=parseFloat(s.lat),p=parseFloat(s.lon);console.log("‚úÖ Auto-found address:",s.display_name),N({lat:d,lng:p}),V(!0),h(""),c({latitude:d,longitude:p,address:s.display_name||r})}}).catch(t=>{console.error("Auto-search error:",t)})}},[r]),e.jsxDEV("div",{className:o.container,children:[e.jsxDEV("div",{className:o.searchSection,children:[e.jsxDEV("div",{className:o.searchWrapper,children:[e.jsxDEV("div",{className:o.searchInputWrapper,children:e.jsxDEV(k,{id:"map-search",type:"text",placeholder:"Nh·∫≠p ƒë·ªãa ch·ªâ ƒë·ªÉ t√¨m ki·∫øm...",value:g,onChange:i=>y(i.target.value),disabled:a,className:o.searchInput},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:261,columnNumber:13},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:260,columnNumber:11},this),j&&T.length>0&&e.jsxDEV("div",{className:o.suggestions,children:T.map((i,t)=>e.jsxDEV("button",{className:o.suggestionItem,onClick:()=>S(i),type:"button",children:[e.jsxDEV($,{size:16,className:o.suggestionIcon},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:282,columnNumber:19},this),e.jsxDEV("div",{className:o.suggestionText,children:[e.jsxDEV("div",{className:o.suggestionAddress,children:i.address},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:284,columnNumber:21},this),e.jsxDEV("div",{className:o.suggestionCoords,children:[i.latitude.toFixed(6),", ",i.longitude.toFixed(6)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:285,columnNumber:21},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:283,columnNumber:19},this)]},t,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:276,columnNumber:17},this))},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:274,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:259,columnNumber:9},this),e.jsxDEV(W,{variant:"outline",size:"sm",onClick:I,disabled:a||b,type:"button",className:o.currentLocationButton,children:[e.jsxDEV(B,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:304,columnNumber:11},this),b?"ƒêang x√°c ƒë·ªãnh...":"V·ªã tr√≠ hi·ªán t·∫°i"]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:296,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:258,columnNumber:7},this),e.jsxDEV("div",{className:o.mapSection,children:[e.jsxDEV("div",{className:o.mapContainer,children:[e.jsxDEV(F,{center:[l.lat,l.lng],zoom:15,style:{height:"100%",width:"100%",borderRadius:"0.5rem"},ref:Q,children:[e.jsxDEV(w,{attribution:'¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:319,columnNumber:13},this),e.jsxDEV(U,{position:[l.lat,l.lng],children:e.jsxDEV(z,{children:[l.lat.toFixed(6),", ",l.lng.toFixed(6),g&&e.jsxDEV("br",{},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:326,columnNumber:33},this),g]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:324,columnNumber:15},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:323,columnNumber:13},this),e.jsxDEV(he,{onMapClick:C},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:330,columnNumber:13},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:313,columnNumber:11},this),e.jsxDEV("div",{className:o.statusIndicator,children:D?e.jsxDEV("div",{className:o.statusConfirmed,children:[e.jsxDEV(G,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:337,columnNumber:17},this),e.jsxDEV("span",{children:"V·ªã tr√≠ ƒë√£ x√°c nh·∫≠n"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:338,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:336,columnNumber:15},this):e.jsxDEV("div",{className:o.statusPending,children:[e.jsxDEV(H,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:342,columnNumber:17},this),e.jsxDEV("span",{children:"Click v√†o b·∫£n ƒë·ªì ƒë·ªÉ ch·ªçn v·ªã tr√≠"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:343,columnNumber:17},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:341,columnNumber:15},this)},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:334,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:311,columnNumber:9},this),L&&e.jsxDEV("div",{className:o.validationError,children:[e.jsxDEV(H,{size:16},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:352,columnNumber:13},this),L]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:351,columnNumber:11},this),e.jsxDEV("p",{className:o.helpText,children:["B·∫°n c√≥ th·ªÉ t√¨m ki·∫øm ƒë·ªãa ch·ªâ, nh·∫≠p t·ªça ƒë·ªô, ho·∫∑c click tr·ª±c ti·∫øp tr√™n b·∫£n ƒë·ªì ƒë·ªÉ ch·ªçn v·ªã tr√≠.",b&&" ƒêang l·∫•y ƒë·ªãa ch·ªâ..."]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:358,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:310,columnNumber:7},this),e.jsxDEV("div",{className:o.coordsDisplay,children:[e.jsxDEV("div",{className:o.coordField,children:[e.jsxDEV(E,{htmlFor:"map-lat",children:"Vƒ© ƒë·ªô (Latitude)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:367,columnNumber:11},this),e.jsxDEV(k,{id:"map-lat",type:"number",step:"0.000001",value:l.lat.toFixed(6),onChange:i=>{const t=parseFloat(i.target.value);isNaN(t)||(N(s=>({...s,lat:t})),c({latitude:t,longitude:l.lng}))},disabled:a},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:368,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:366,columnNumber:9},this),e.jsxDEV("div",{className:o.coordField,children:[e.jsxDEV(E,{htmlFor:"map-lng",children:"Kinh ƒë·ªô (Longitude)"},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:388,columnNumber:11},this),e.jsxDEV(k,{id:"map-lng",type:"number",step:"0.000001",value:l.lng.toFixed(6),onChange:i=>{const t=parseFloat(i.target.value);isNaN(t)||(N(s=>({...s,lng:t})),c({latitude:l.lat,longitude:t}))},disabled:a},void 0,!1,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:389,columnNumber:11},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:387,columnNumber:9},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:365,columnNumber:7},this)]},void 0,!0,{fileName:"E:/Hieplv/VHV-QLTT/src/ui-kit/MapLocationPicker.tsx",lineNumber:256,columnNumber:5},this)}export{fe as M};
